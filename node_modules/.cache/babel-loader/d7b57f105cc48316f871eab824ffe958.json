{"ast":null,"code":"import _objectSpread from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _taggedTemplateLiteral from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _excluded=[\"proposal\"];var _templateObject,_templateObject2;import React,{useState}from'react';import styled from'styled-components';import{Button,Card,CardBody,CardHeader,Heading,Radio,Text,useModal}from'@pancakeswap/uikit';import{useWeb3React}from'@web3-react/core';import{useAppDispatch}from'state';import{fetchVotes}from'state/voting';import useToast from'hooks/useToast';import{useTranslation}from'contexts/Localization';import ConnectWalletButton from'components/ConnectWalletButton';import CastVoteModal from'../components/CastVoteModal';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Choice=styled.label(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  align-items: center;\\n  border: 1px solid \",\";\\n  border-radius: 16px;\\n  cursor: \",\";\\n  display: flex;\\n  margin-bottom: 16px;\\n  padding: 16px;\\n\"])),function(_ref){var theme=_ref.theme,isChecked=_ref.isChecked;return theme.colors[isChecked?'success':'cardBorder'];},function(_ref2){var isDisabled=_ref2.isDisabled;return isDisabled?'not-allowed':'pointer';});var ChoiceText=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  flex: 1;\\n  padding-left: 16px;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  white-space: nowrap;\\n  width: 0;\\n\"])));var Vote=function Vote(_ref3){var proposal=_ref3.proposal,props=_objectWithoutProperties(_ref3,_excluded);var _useState=useState(null),_useState2=_slicedToArray(_useState,2),vote=_useState2[0],setVote=_useState2[1];var _useTranslation=useTranslation(),t=_useTranslation.t;var _useToast=useToast(),toastSuccess=_useToast.toastSuccess;var dispatch=useAppDispatch();var _useWeb3React=useWeb3React(),account=_useWeb3React.account;var handleSuccess=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:toastSuccess(t('Vote cast!'));dispatch(fetchVotes({proposalId:proposal.id,block:Number(proposal.snapshot)}));case 2:case\"end\":return _context.stop();}}},_callee);}));return function handleSuccess(){return _ref4.apply(this,arguments);};}();var _useModal=useModal(/*#__PURE__*/_jsx(CastVoteModal,{onSuccess:handleSuccess,proposalId:proposal.id,vote:vote,block:Number(proposal.snapshot)})),_useModal2=_slicedToArray(_useModal,1),presentCastVoteModal=_useModal2[0];return/*#__PURE__*/_jsxs(Card,_objectSpread(_objectSpread({},props),{},{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsx(Heading,{as:\"h3\",scale:\"md\",children:t('Cast your vote')})}),/*#__PURE__*/_jsxs(CardBody,{children:[proposal.choices.map(function(choice,index){var isChecked=index+1===(vote===null||vote===void 0?void 0:vote.value);var handleChange=function handleChange(){setVote({label:choice,value:index+1});};return/*#__PURE__*/_jsxs(Choice,{isChecked:isChecked,isDisabled:!account,children:[/*#__PURE__*/_jsx(\"div\",{style:{flexShrink:0},children:/*#__PURE__*/_jsx(Radio,{scale:\"sm\",value:choice,checked:isChecked,onChange:handleChange,disabled:!account})}),/*#__PURE__*/_jsx(ChoiceText,{children:/*#__PURE__*/_jsx(Text,{as:\"span\",title:choice,children:choice})})]},choice);}),account?/*#__PURE__*/_jsx(Button,{onClick:presentCastVoteModal,disabled:vote===null,children:t('Cast Vote')}):/*#__PURE__*/_jsx(ConnectWalletButton,{})]})]}));};export default Vote;","map":{"version":3,"sources":["/Volumes/evo970/lou/madDex-master/src/views/Voting/Proposal/Vote.tsx"],"names":["React","useState","styled","Button","Card","CardBody","CardHeader","Heading","Radio","Text","useModal","useWeb3React","useAppDispatch","fetchVotes","useToast","useTranslation","ConnectWalletButton","CastVoteModal","Choice","label","theme","isChecked","colors","isDisabled","ChoiceText","div","Vote","proposal","props","vote","setVote","t","toastSuccess","dispatch","account","handleSuccess","proposalId","id","block","Number","snapshot","presentCastVoteModal","choices","map","choice","index","value","handleChange","flexShrink"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport styled from 'styled-components'\nimport { Button, Card, CardBody, CardHeader, CardProps, Heading, Radio, Text, useModal } from '@pancakeswap/uikit'\nimport { useWeb3React } from '@web3-react/core'\nimport { useAppDispatch } from 'state'\nimport { Proposal } from 'state/types'\nimport { fetchVotes } from 'state/voting'\nimport useToast from 'hooks/useToast'\nimport { useTranslation } from 'contexts/Localization'\nimport ConnectWalletButton from 'components/ConnectWalletButton'\nimport CastVoteModal from '../components/CastVoteModal'\n\ninterface VoteProps extends CardProps {\n  proposal: Proposal\n}\n\ninterface State {\n  label: string\n  value: number\n}\n\nconst Choice = styled.label<{ isChecked: boolean; isDisabled: boolean }>`\n  align-items: center;\n  border: 1px solid ${({ theme, isChecked }) => theme.colors[isChecked ? 'success' : 'cardBorder']};\n  border-radius: 16px;\n  cursor: ${({ isDisabled }) => (isDisabled ? 'not-allowed' : 'pointer')};\n  display: flex;\n  margin-bottom: 16px;\n  padding: 16px;\n`\n\nconst ChoiceText = styled.div`\n  flex: 1;\n  padding-left: 16px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  width: 0;\n`\n\nconst Vote: React.FC<VoteProps> = ({ proposal, ...props }) => {\n  const [vote, setVote] = useState<State>(null)\n  const { t } = useTranslation()\n  const { toastSuccess } = useToast()\n  const dispatch = useAppDispatch()\n  const { account } = useWeb3React()\n\n  const handleSuccess = async () => {\n    toastSuccess(t('Vote cast!'))\n    dispatch(fetchVotes({ proposalId: proposal.id, block: Number(proposal.snapshot) }))\n  }\n\n  const [presentCastVoteModal] = useModal(\n    <CastVoteModal onSuccess={handleSuccess} proposalId={proposal.id} vote={vote} block={Number(proposal.snapshot)} />,\n  )\n\n  return (\n    <Card {...props}>\n      <CardHeader>\n        <Heading as=\"h3\" scale=\"md\">\n          {t('Cast your vote')}\n        </Heading>\n      </CardHeader>\n      <CardBody>\n        {proposal.choices.map((choice, index) => {\n          const isChecked = index + 1 === vote?.value\n\n          const handleChange = () => {\n            setVote({\n              label: choice,\n              value: index + 1,\n            })\n          }\n\n          return (\n            <Choice key={choice} isChecked={isChecked} isDisabled={!account}>\n              <div style={{ flexShrink: 0 }}>\n                <Radio scale=\"sm\" value={choice} checked={isChecked} onChange={handleChange} disabled={!account} />\n              </div>\n              <ChoiceText>\n                <Text as=\"span\" title={choice}>\n                  {choice}\n                </Text>\n              </ChoiceText>\n            </Choice>\n          )\n        })}\n        {account ? (\n          <Button onClick={presentCastVoteModal} disabled={vote === null}>\n            {t('Cast Vote')}\n          </Button>\n        ) : (\n          <ConnectWalletButton />\n        )}\n      </CardBody>\n    </Card>\n  )\n}\n\nexport default Vote\n"]},"metadata":{},"sourceType":"module"}