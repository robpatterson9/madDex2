{"ast":null,"code":"import _regeneratorRuntime from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{createContext,useCallback,useEffect,useState}from'react';import{EN,languages}from'config/localization/languages';import translations from'config/localization/translations.json';import{LS_KEY,fetchLocale,getLanguageCodeFromLS}from'./helpers';import{jsx as _jsx}from\"react/jsx-runtime\";var initialState={isFetching:true,currentLanguage:EN};// Export the translations directly\nexport var languageMap=new Map();languageMap.set(EN.locale,translations);export var LanguageContext=/*#__PURE__*/createContext(undefined);export var LanguageProvider=function LanguageProvider(_ref){var children=_ref.children;var _useState=useState(function(){var codeFromStorage=getLanguageCodeFromLS();return _objectSpread(_objectSpread({},initialState),{},{currentLanguage:languages[codeFromStorage]});}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var currentLanguage=state.currentLanguage;useEffect(function(){var fetchInitialLocales=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var codeFromStorage,enLocale,currentLocale;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:codeFromStorage=getLanguageCodeFromLS();if(!(codeFromStorage!==EN.locale)){_context.next=7;break;}enLocale=languageMap.get(EN.locale);_context.next=5;return fetchLocale(codeFromStorage);case 5:currentLocale=_context.sent;languageMap.set(codeFromStorage,_objectSpread(_objectSpread({},enLocale),currentLocale));case 7:setState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isFetching:false});});case 8:case\"end\":return _context.stop();}}},_callee);}));return function fetchInitialLocales(){return _ref2.apply(this,arguments);};}();fetchInitialLocales();},[setState]);var setLanguage=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(language){var locale,enLocale;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(languageMap.has(language.locale)){_context2.next=11;break;}setState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isFetching:true});});_context2.next=4;return fetchLocale(language.locale);case 4:locale=_context2.sent;enLocale=languageMap.get(EN.locale);// Merge the EN locale to ensure that any locale fetched has all the keys\nlanguageMap.set(language.locale,_objectSpread(_objectSpread({},enLocale),locale));localStorage.setItem(LS_KEY,language.locale);setState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isFetching:false,currentLanguage:language});});_context2.next=13;break;case 11:localStorage.setItem(LS_KEY,language.locale);setState(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isFetching:false,currentLanguage:language});});case 13:case\"end\":return _context2.stop();}}},_callee2);}));return function setLanguage(_x){return _ref3.apply(this,arguments);};}();var translate=useCallback(function(key,data){var translationSet=languageMap.has(currentLanguage.locale)?languageMap.get(currentLanguage.locale):languageMap.get(EN.locale);var translatedText=translationSet[key]||key;// Check the existence of at least one combination of %%, separated by 1 or more non space characters\nvar includesVariable=translatedText.match(/%\\S+?%/gm);if(includesVariable&&data){var interpolatedText=translatedText;Object.keys(data).forEach(function(dataKey){var templateKey=new RegExp(\"%\".concat(dataKey,\"%\"),'g');interpolatedText=interpolatedText.replace(templateKey,data[dataKey].toString());});return interpolatedText;}return translatedText;},[currentLanguage]);return/*#__PURE__*/_jsx(LanguageContext.Provider,{value:_objectSpread(_objectSpread({},state),{},{setLanguage:setLanguage,t:translate}),children:children});};","map":{"version":3,"sources":["/Volumes/evo970/lou/madDex-master/src/contexts/Localization/Provider.tsx"],"names":["React","createContext","useCallback","useEffect","useState","EN","languages","translations","LS_KEY","fetchLocale","getLanguageCodeFromLS","initialState","isFetching","currentLanguage","languageMap","Map","set","locale","LanguageContext","undefined","LanguageProvider","children","codeFromStorage","state","setState","fetchInitialLocales","enLocale","get","currentLocale","prevState","setLanguage","language","has","localStorage","setItem","translate","key","data","translationSet","translatedText","includesVariable","match","interpolatedText","Object","keys","forEach","dataKey","templateKey","RegExp","replace","toString","t"],"mappings":"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","sourcesContent":["import React, { createContext, useCallback, useEffect, useState } from 'react'\nimport { Language } from '@pancakeswap/uikit'\nimport { EN, languages } from 'config/localization/languages'\nimport translations from 'config/localization/translations.json'\nimport { ContextApi, ContextData, ProviderState } from './types'\nimport { LS_KEY, fetchLocale, getLanguageCodeFromLS } from './helpers'\n\nconst initialState: ProviderState = {\n  isFetching: true,\n  currentLanguage: EN,\n}\n\n// Export the translations directly\nexport const languageMap = new Map<Language['locale'], Record<string, string>>()\nlanguageMap.set(EN.locale, translations)\n\nexport const LanguageContext = createContext<ContextApi>(undefined)\n\nexport const LanguageProvider: React.FC = ({ children }) => {\n  const [state, setState] = useState<ProviderState>(() => {\n    const codeFromStorage = getLanguageCodeFromLS()\n\n    return {\n      ...initialState,\n      currentLanguage: languages[codeFromStorage],\n    }\n  })\n  const { currentLanguage } = state\n\n  useEffect(() => {\n    const fetchInitialLocales = async () => {\n      const codeFromStorage = getLanguageCodeFromLS()\n\n      if (codeFromStorage !== EN.locale) {\n        const enLocale = languageMap.get(EN.locale)\n        const currentLocale = await fetchLocale(codeFromStorage)\n        languageMap.set(codeFromStorage, { ...enLocale, ...currentLocale })\n      }\n\n      setState((prevState) => ({\n        ...prevState,\n        isFetching: false,\n      }))\n    }\n\n    fetchInitialLocales()\n  }, [setState])\n\n  const setLanguage = async (language: Language) => {\n    if (!languageMap.has(language.locale)) {\n      setState((prevState) => ({\n        ...prevState,\n        isFetching: true,\n      }))\n\n      const locale = await fetchLocale(language.locale)\n      const enLocale = languageMap.get(EN.locale)\n\n      // Merge the EN locale to ensure that any locale fetched has all the keys\n      languageMap.set(language.locale, { ...enLocale, ...locale })\n      localStorage.setItem(LS_KEY, language.locale)\n\n      setState((prevState) => ({\n        ...prevState,\n        isFetching: false,\n        currentLanguage: language,\n      }))\n    } else {\n      localStorage.setItem(LS_KEY, language.locale)\n      setState((prevState) => ({\n        ...prevState,\n        isFetching: false,\n        currentLanguage: language,\n      }))\n    }\n  }\n\n  const translate = useCallback(\n    (key: string, data?: ContextData) => {\n      const translationSet = languageMap.has(currentLanguage.locale)\n        ? languageMap.get(currentLanguage.locale)\n        : languageMap.get(EN.locale)\n      const translatedText = translationSet[key] || key\n\n      // Check the existence of at least one combination of %%, separated by 1 or more non space characters\n      const includesVariable = translatedText.match(/%\\S+?%/gm)\n\n      if (includesVariable && data) {\n        let interpolatedText = translatedText\n        Object.keys(data).forEach((dataKey) => {\n          const templateKey = new RegExp(`%${dataKey}%`, 'g')\n          interpolatedText = interpolatedText.replace(templateKey, data[dataKey].toString())\n        })\n\n        return interpolatedText\n      }\n\n      return translatedText\n    },\n    [currentLanguage],\n  )\n\n  return <LanguageContext.Provider value={{ ...state, setLanguage, t: translate }}>{children}</LanguageContext.Provider>\n}\n"]},"metadata":{},"sourceType":"module"}