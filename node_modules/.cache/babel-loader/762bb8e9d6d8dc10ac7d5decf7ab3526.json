{"ast":null,"code":"import _regeneratorRuntime from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject;import React from'react';import styled from'styled-components';import{Text,Heading,Card,CardHeader,CardBody,Flex}from'@pancakeswap/uikit';import{useTranslation}from'contexts/Localization';import useApproveConfirmTransaction from'hooks/useApproveConfirmTransaction';import{useCake,useFarmAuctionContract}from'hooks/useContract';import{ethersToBigNumber}from'utils/bigNumber';import{useWeb3React}from'@web3-react/core';import ConnectWalletButton from'components/ConnectWalletButton';import useToast from'hooks/useToast';import{useCallWithGasPrice}from'hooks/useCallWithGasPrice';import{getBalanceNumber}from'utils/formatBalance';import{ethers}from'ethers';import ApproveConfirmButtons,{ButtonArrangement}from'components/ApproveConfirmButtons';import{ToastDescriptionWithTx}from'components/Toast';import useReclaimAuctionBid from'../hooks/useReclaimAuctionBid';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var StyledReclaimBidCard=styled(Card)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  margin-top: 16px;\\n  flex: 1;\\n\"])));var ReclaimBidCard=function ReclaimBidCard(){var _useTranslation=useTranslation(),t=_useTranslation.t;var _useWeb3React=useWeb3React(),account=_useWeb3React.account;var _useCallWithGasPrice=useCallWithGasPrice(),callWithGasPrice=_useCallWithGasPrice.callWithGasPrice;var _useReclaimAuctionBid=useReclaimAuctionBid(),_useReclaimAuctionBid2=_slicedToArray(_useReclaimAuctionBid,2),reclaimableAuction=_useReclaimAuctionBid2[0],checkForNextReclaimableAuction=_useReclaimAuctionBid2[1];var cakeContract=useCake();var farmAuctionContract=useFarmAuctionContract();var _useToast=useToast(),toastSuccess=_useToast.toastSuccess;var _useApproveConfirmTra=useApproveConfirmTransaction({onRequiresApproval:function(){var _onRequiresApproval=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,currentAllowance;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return cakeContract.allowance(account,farmAuctionContract.address);case 3:response=_context.sent;currentAllowance=ethersToBigNumber(response);return _context.abrupt(\"return\",currentAllowance.gt(0));case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);return _context.abrupt(\"return\",false);case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,8]]);}));function onRequiresApproval(){return _onRequiresApproval.apply(this,arguments);}return onRequiresApproval;}(),onApprove:function onApprove(){return callWithGasPrice(cakeContract,'approve',[farmAuctionContract.address,ethers.constants.MaxUint256]);},onApproveSuccess:function(){var _onApproveSuccess=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref){var receipt;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:receipt=_ref.receipt;toastSuccess(t('Contract approved - you can now reclaim your bid!'),/*#__PURE__*/_jsx(ToastDescriptionWithTx,{txHash:receipt.transactionHash}));case 2:case\"end\":return _context2.stop();}}},_callee2);}));function onApproveSuccess(_x){return _onApproveSuccess.apply(this,arguments);}return onApproveSuccess;}(),onConfirm:function onConfirm(){return callWithGasPrice(farmAuctionContract,'claimAuction',[reclaimableAuction.id]);},onSuccess:function(){var _onSuccess=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref2){var receipt;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:receipt=_ref2.receipt;checkForNextReclaimableAuction();toastSuccess(t('Bid reclaimed!'),/*#__PURE__*/_jsx(ToastDescriptionWithTx,{txHash:receipt.transactionHash}));case 3:case\"end\":return _context3.stop();}}},_callee3);}));function onSuccess(_x2){return _onSuccess.apply(this,arguments);}return onSuccess;}()}),isApproving=_useApproveConfirmTra.isApproving,isApproved=_useApproveConfirmTra.isApproved,isConfirming=_useApproveConfirmTra.isConfirming,handleApprove=_useApproveConfirmTra.handleApprove,handleConfirm=_useApproveConfirmTra.handleConfirm;if(!reclaimableAuction){return null;}var position=reclaimableAuction.position,amount=reclaimableAuction.amount;return/*#__PURE__*/_jsxs(StyledReclaimBidCard,{mb:['24px',null,null,'0'],children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsx(Heading,{children:t('Reclaim Bid')})}),/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsx(Text,{mb:\"16px\",children:t('Your bid in Auction #%auctionId% was unsuccessful.',{auctionId:reclaimableAuction.id})}),/*#__PURE__*/_jsx(Text,{bold:true,mb:\"16px\",children:t('Reclaim your CAKE now.')}),/*#__PURE__*/_jsxs(Flex,{justifyContent:\"space-between\",mb:\"8px\",children:[/*#__PURE__*/_jsx(Text,{color:\"textSubtle\",children:t('Your total bid')}),/*#__PURE__*/_jsx(Text,{children:t('%num% CAKE',{num:getBalanceNumber(amount).toLocaleString()})})]}),/*#__PURE__*/_jsxs(Flex,{justifyContent:\"space-between\",mb:\"24px\",children:[/*#__PURE__*/_jsx(Text,{color:\"textSubtle\",children:t('Your position')}),/*#__PURE__*/_jsxs(Text,{children:[\"#\",position]})]}),account?/*#__PURE__*/_jsx(ApproveConfirmButtons,{isApproveDisabled:isApproved,isApproving:isApproving,isConfirmDisabled:false,isConfirming:isConfirming,onApprove:handleApprove,onConfirm:handleConfirm,buttonArrangement:ButtonArrangement.SEQUENTIAL,confirmLabel:t('Reclaim')}):/*#__PURE__*/_jsx(ConnectWalletButton,{})]})]});};export default ReclaimBidCard;","map":{"version":3,"sources":["/Volumes/evo970/lou/madDex-master/src/views/FarmAuction/components/ReclaimBidCard.tsx"],"names":["React","styled","Text","Heading","Card","CardHeader","CardBody","Flex","useTranslation","useApproveConfirmTransaction","useCake","useFarmAuctionContract","ethersToBigNumber","useWeb3React","ConnectWalletButton","useToast","useCallWithGasPrice","getBalanceNumber","ethers","ApproveConfirmButtons","ButtonArrangement","ToastDescriptionWithTx","useReclaimAuctionBid","StyledReclaimBidCard","ReclaimBidCard","t","account","callWithGasPrice","reclaimableAuction","checkForNextReclaimableAuction","cakeContract","farmAuctionContract","toastSuccess","onRequiresApproval","allowance","address","response","currentAllowance","gt","onApprove","constants","MaxUint256","onApproveSuccess","receipt","transactionHash","onConfirm","id","onSuccess","isApproving","isApproved","isConfirming","handleApprove","handleConfirm","position","amount","auctionId","num","toLocaleString","SEQUENTIAL"],"mappings":"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","sourcesContent":["import React from 'react'\nimport styled from 'styled-components'\nimport { Text, Heading, Card, CardHeader, CardBody, Flex } from '@pancakeswap/uikit'\nimport { useTranslation } from 'contexts/Localization'\nimport useApproveConfirmTransaction from 'hooks/useApproveConfirmTransaction'\nimport { useCake, useFarmAuctionContract } from 'hooks/useContract'\nimport { ethersToBigNumber } from 'utils/bigNumber'\nimport { useWeb3React } from '@web3-react/core'\nimport ConnectWalletButton from 'components/ConnectWalletButton'\nimport useToast from 'hooks/useToast'\nimport { useCallWithGasPrice } from 'hooks/useCallWithGasPrice'\nimport { getBalanceNumber } from 'utils/formatBalance'\nimport { ethers } from 'ethers'\nimport ApproveConfirmButtons, { ButtonArrangement } from 'components/ApproveConfirmButtons'\nimport { ToastDescriptionWithTx } from 'components/Toast'\nimport useReclaimAuctionBid from '../hooks/useReclaimAuctionBid'\n\nconst StyledReclaimBidCard = styled(Card)`\n  margin-top: 16px;\n  flex: 1;\n`\n\nconst ReclaimBidCard: React.FC = () => {\n  const { t } = useTranslation()\n  const { account } = useWeb3React()\n  const { callWithGasPrice } = useCallWithGasPrice()\n\n  const [reclaimableAuction, checkForNextReclaimableAuction] = useReclaimAuctionBid()\n\n  const cakeContract = useCake()\n  const farmAuctionContract = useFarmAuctionContract()\n\n  const { toastSuccess } = useToast()\n\n  const { isApproving, isApproved, isConfirming, handleApprove, handleConfirm } = useApproveConfirmTransaction({\n    onRequiresApproval: async () => {\n      try {\n        const response = await cakeContract.allowance(account, farmAuctionContract.address)\n        const currentAllowance = ethersToBigNumber(response)\n        return currentAllowance.gt(0)\n      } catch (error) {\n        return false\n      }\n    },\n    onApprove: () => {\n      return callWithGasPrice(cakeContract, 'approve', [farmAuctionContract.address, ethers.constants.MaxUint256])\n    },\n    onApproveSuccess: async ({ receipt }) => {\n      toastSuccess(\n        t('Contract approved - you can now reclaim your bid!'),\n        <ToastDescriptionWithTx txHash={receipt.transactionHash} />,\n      )\n    },\n    onConfirm: () => {\n      return callWithGasPrice(farmAuctionContract, 'claimAuction', [reclaimableAuction.id])\n    },\n    onSuccess: async ({ receipt }) => {\n      checkForNextReclaimableAuction()\n      toastSuccess(t('Bid reclaimed!'), <ToastDescriptionWithTx txHash={receipt.transactionHash} />)\n    },\n  })\n\n  if (!reclaimableAuction) {\n    return null\n  }\n\n  const { position, amount } = reclaimableAuction\n\n  return (\n    <StyledReclaimBidCard mb={['24px', null, null, '0']}>\n      <CardHeader>\n        <Heading>{t('Reclaim Bid')}</Heading>\n      </CardHeader>\n      <CardBody>\n        <Text mb=\"16px\">\n          {t('Your bid in Auction #%auctionId% was unsuccessful.', { auctionId: reclaimableAuction.id })}\n        </Text>\n        <Text bold mb=\"16px\">\n          {t('Reclaim your CAKE now.')}\n        </Text>\n        <Flex justifyContent=\"space-between\" mb=\"8px\">\n          <Text color=\"textSubtle\">{t('Your total bid')}</Text>\n          <Text>{t('%num% CAKE', { num: getBalanceNumber(amount).toLocaleString() })}</Text>\n        </Flex>\n        <Flex justifyContent=\"space-between\" mb=\"24px\">\n          <Text color=\"textSubtle\">{t('Your position')}</Text>\n          <Text>#{position}</Text>\n        </Flex>\n        {account ? (\n          <ApproveConfirmButtons\n            isApproveDisabled={isApproved}\n            isApproving={isApproving}\n            isConfirmDisabled={false}\n            isConfirming={isConfirming}\n            onApprove={handleApprove}\n            onConfirm={handleConfirm}\n            buttonArrangement={ButtonArrangement.SEQUENTIAL}\n            confirmLabel={t('Reclaim')}\n          />\n        ) : (\n          <ConnectWalletButton />\n        )}\n      </CardBody>\n    </StyledReclaimBidCard>\n  )\n}\n\nexport default ReclaimBidCard\n"]},"metadata":{},"sourceType":"module"}