{"ast":null,"code":"import{BigNumber,ethers}from'ethers';import{BetPosition}from'state/types';import{formatBigNumberToFixed}from'utils/formatBalance';import getTimePeriods from'utils/getTimePeriods';var MIN_PRICE_USD_DISPLAYED=BigNumber.from(100000);var MIN_PRICE_BNB_DISPLAYED=BigNumber.from('1000000000000000');var DISPLAYED_DECIMALS=3;var formatPriceDifference=function formatPriceDifference(_ref){var _ref$price=_ref.price,price=_ref$price===void 0?BigNumber.from(0):_ref$price,minPriceDisplayed=_ref.minPriceDisplayed,unitPrefix=_ref.unitPrefix,decimals=_ref.decimals;var sign=price.isNegative()?BigNumber.from(-1):BigNumber.from(1);if(price.abs().lt(minPriceDisplayed)){var signedPriceToFormat=minPriceDisplayed.mul(sign);return\"<\".concat(unitPrefix).concat(formatBigNumberToFixed(signedPriceToFormat,DISPLAYED_DECIMALS,decimals));}return\"\".concat(unitPrefix).concat(formatBigNumberToFixed(price,DISPLAYED_DECIMALS,decimals));};export var formatUsdv2=function formatUsdv2(usd){return formatPriceDifference({price:usd,minPriceDisplayed:MIN_PRICE_USD_DISPLAYED,unitPrefix:'$',decimals:8});};export var formatBnbv2=function formatBnbv2(bnb){return formatPriceDifference({price:bnb,minPriceDisplayed:MIN_PRICE_BNB_DISPLAYED,unitPrefix:'',decimals:18});};export var padTime=function padTime(num){return num.toString().padStart(2,'0');};export var formatRoundTime=function formatRoundTime(secondsBetweenBlocks){var _getTimePeriods=getTimePeriods(secondsBetweenBlocks),hours=_getTimePeriods.hours,minutes=_getTimePeriods.minutes,seconds=_getTimePeriods.seconds;var minutesSeconds=\"\".concat(padTime(minutes),\":\").concat(padTime(seconds));if(hours>0){return\"\".concat(padTime(hours),\":\").concat(minutesSeconds);}return minutesSeconds;};export var getHasRoundFailed=function getHasRoundFailed(round,buffer){var closeTimestampMs=(round.closeTimestamp+buffer)*1000;var now=Date.now();if(closeTimestampMs!==null&&now>closeTimestampMs&&!round.oracleCalled){return true;}return false;};export var getMultiplierV2=function getMultiplierV2(total,amount){if(!total){return ethers.FixedNumber.from(0);}if(total.eq(0)||amount.eq(0)){return ethers.FixedNumber.from(0);}var rewardAmountFixed=ethers.FixedNumber.from(total);var multiplierAmountFixed=ethers.FixedNumber.from(amount);return rewardAmountFixed.divUnsafe(multiplierAmountFixed);};export var getPriceDifference=function getPriceDifference(price,lockPrice){if(!price||!lockPrice){return ethers.BigNumber.from(0);}return price.sub(lockPrice);};export var getRoundPosition=function getRoundPosition(lockPrice,closePrice){if(!closePrice){return null;}if(closePrice.eq(lockPrice)){return BetPosition.HOUSE;}return closePrice.gt(lockPrice)?BetPosition.BULL:BetPosition.BEAR;};","map":{"version":3,"sources":["/Volumes/evo970/lou/madDex-master/src/views/Predictions/helpers.ts"],"names":["BigNumber","ethers","BetPosition","formatBigNumberToFixed","getTimePeriods","MIN_PRICE_USD_DISPLAYED","from","MIN_PRICE_BNB_DISPLAYED","DISPLAYED_DECIMALS","formatPriceDifference","price","minPriceDisplayed","unitPrefix","decimals","sign","isNegative","abs","lt","signedPriceToFormat","mul","formatUsdv2","usd","formatBnbv2","bnb","padTime","num","toString","padStart","formatRoundTime","secondsBetweenBlocks","hours","minutes","seconds","minutesSeconds","getHasRoundFailed","round","buffer","closeTimestampMs","closeTimestamp","now","Date","oracleCalled","getMultiplierV2","total","amount","FixedNumber","eq","rewardAmountFixed","multiplierAmountFixed","divUnsafe","getPriceDifference","lockPrice","sub","getRoundPosition","closePrice","HOUSE","gt","BULL","BEAR"],"mappings":"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","sourcesContent":["import { BigNumber, ethers } from 'ethers'\nimport { BetPosition, NodeRound } from 'state/types'\nimport { formatBigNumberToFixed } from 'utils/formatBalance'\nimport getTimePeriods from 'utils/getTimePeriods'\n\nconst MIN_PRICE_USD_DISPLAYED = BigNumber.from(100000)\nconst MIN_PRICE_BNB_DISPLAYED = BigNumber.from('1000000000000000')\nconst DISPLAYED_DECIMALS = 3\n\ntype formatPriceDifferenceProps = {\n  price?: BigNumber\n  minPriceDisplayed: BigNumber\n  unitPrefix: string\n  decimals: number\n}\n\nconst formatPriceDifference = ({\n  price = BigNumber.from(0),\n  minPriceDisplayed,\n  unitPrefix,\n  decimals,\n}: formatPriceDifferenceProps) => {\n  const sign = price.isNegative() ? BigNumber.from(-1) : BigNumber.from(1)\n\n  if (price.abs().lt(minPriceDisplayed)) {\n    const signedPriceToFormat = minPriceDisplayed.mul(sign)\n    return `<${unitPrefix}${formatBigNumberToFixed(signedPriceToFormat, DISPLAYED_DECIMALS, decimals)}`\n  }\n\n  return `${unitPrefix}${formatBigNumberToFixed(price, DISPLAYED_DECIMALS, decimals)}`\n}\n\nexport const formatUsdv2 = (usd: BigNumber) => {\n  return formatPriceDifference({ price: usd, minPriceDisplayed: MIN_PRICE_USD_DISPLAYED, unitPrefix: '$', decimals: 8 })\n}\n\nexport const formatBnbv2 = (bnb: BigNumber) => {\n  return formatPriceDifference({ price: bnb, minPriceDisplayed: MIN_PRICE_BNB_DISPLAYED, unitPrefix: '', decimals: 18 })\n}\n\nexport const padTime = (num: number) => num.toString().padStart(2, '0')\n\nexport const formatRoundTime = (secondsBetweenBlocks: number) => {\n  const { hours, minutes, seconds } = getTimePeriods(secondsBetweenBlocks)\n  const minutesSeconds = `${padTime(minutes)}:${padTime(seconds)}`\n\n  if (hours > 0) {\n    return `${padTime(hours)}:${minutesSeconds}`\n  }\n\n  return minutesSeconds\n}\n\nexport const getHasRoundFailed = (round: NodeRound, buffer: number) => {\n  const closeTimestampMs = (round.closeTimestamp + buffer) * 1000\n  const now = Date.now()\n\n  if (closeTimestampMs !== null && now > closeTimestampMs && !round.oracleCalled) {\n    return true\n  }\n\n  return false\n}\n\nexport const getMultiplierV2 = (total: ethers.BigNumber, amount: ethers.BigNumber) => {\n  if (!total) {\n    return ethers.FixedNumber.from(0)\n  }\n\n  if (total.eq(0) || amount.eq(0)) {\n    return ethers.FixedNumber.from(0)\n  }\n\n  const rewardAmountFixed = ethers.FixedNumber.from(total)\n  const multiplierAmountFixed = ethers.FixedNumber.from(amount)\n\n  return rewardAmountFixed.divUnsafe(multiplierAmountFixed)\n}\n\nexport const getPriceDifference = (price: ethers.BigNumber, lockPrice: ethers.BigNumber) => {\n  if (!price || !lockPrice) {\n    return ethers.BigNumber.from(0)\n  }\n\n  return price.sub(lockPrice)\n}\n\nexport const getRoundPosition = (lockPrice: ethers.BigNumber, closePrice: ethers.BigNumber) => {\n  if (!closePrice) {\n    return null\n  }\n\n  if (closePrice.eq(lockPrice)) {\n    return BetPosition.HOUSE\n  }\n\n  return closePrice.gt(lockPrice) ? BetPosition.BULL : BetPosition.BEAR\n}\n"]},"metadata":{},"sourceType":"module"}