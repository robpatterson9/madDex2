{"ast":null,"code":"import _regeneratorRuntime from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{useCallback}from'react';import{useWeb3React}from'@web3-react/core';import{useAppDispatch}from'state';import{updateUserBalance,updateUserPendingReward}from'state/actions';import{harvestFarm}from'utils/calls';import{BIG_ZERO}from'utils/bigNumber';import getGasPrice from'utils/getGasPrice';import{useMasterchef,useSousChef}from'hooks/useContract';import{DEFAULT_GAS_LIMIT}from'config';var options={gasLimit:DEFAULT_GAS_LIMIT};var harvestPool=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(sousChefContract){var gasPrice,tx,receipt;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:gasPrice=getGasPrice();_context.next=3;return sousChefContract.deposit('0',_objectSpread(_objectSpread({},options),{},{gasPrice:gasPrice}));case 3:tx=_context.sent;_context.next=6;return tx.wait();case 6:receipt=_context.sent;return _context.abrupt(\"return\",receipt.status);case 8:case\"end\":return _context.stop();}}},_callee);}));return function harvestPool(_x){return _ref.apply(this,arguments);};}();var harvestPoolBnb=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(sousChefContract){var gasPrice,tx,receipt;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:gasPrice=getGasPrice();_context2.next=3;return sousChefContract.deposit(_objectSpread(_objectSpread({},options),{},{value:BIG_ZERO,gasPrice:gasPrice}));case 3:tx=_context2.sent;_context2.next=6;return tx.wait();case 6:receipt=_context2.sent;return _context2.abrupt(\"return\",receipt.status);case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function harvestPoolBnb(_x2){return _ref2.apply(this,arguments);};}();var useHarvestPool=function useHarvestPool(sousId){var isUsingBnb=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var dispatch=useAppDispatch();var _useWeb3React=useWeb3React(),account=_useWeb3React.account;var sousChefContract=useSousChef(sousId);var masterChefContract=useMasterchef();var handleHarvest=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(sousId===0)){_context3.next=5;break;}_context3.next=3;return harvestFarm(masterChefContract,0);case 3:_context3.next=12;break;case 5:if(!isUsingBnb){_context3.next=10;break;}_context3.next=8;return harvestPoolBnb(sousChefContract);case 8:_context3.next=12;break;case 10:_context3.next=12;return harvestPool(sousChefContract);case 12:dispatch(updateUserPendingReward(sousId,account));dispatch(updateUserBalance(sousId,account));case 14:case\"end\":return _context3.stop();}}},_callee3);})),[account,dispatch,isUsingBnb,masterChefContract,sousChefContract,sousId]);return{onReward:handleHarvest};};export default useHarvestPool;","map":{"version":3,"sources":["/Volumes/evo970/lou/madDex-master/src/views/Pools/hooks/useHarvestPool.ts"],"names":["useCallback","useWeb3React","useAppDispatch","updateUserBalance","updateUserPendingReward","harvestFarm","BIG_ZERO","getGasPrice","useMasterchef","useSousChef","DEFAULT_GAS_LIMIT","options","gasLimit","harvestPool","sousChefContract","gasPrice","deposit","tx","wait","receipt","status","harvestPoolBnb","value","useHarvestPool","sousId","isUsingBnb","dispatch","account","masterChefContract","handleHarvest","onReward"],"mappings":"ocAAA,OAASA,WAAT,KAA4B,OAA5B,CACA,OAASC,YAAT,KAA6B,kBAA7B,CACA,OAASC,cAAT,KAA+B,OAA/B,CACA,OAASC,iBAAT,CAA4BC,uBAA5B,KAA2D,eAA3D,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,OAASC,QAAT,KAAyB,iBAAzB,CACA,MAAOC,CAAAA,WAAP,KAAwB,mBAAxB,CACA,OAASC,aAAT,CAAwBC,WAAxB,KAA2C,mBAA3C,CACA,OAASC,iBAAT,KAAkC,QAAlC,CAEA,GAAMC,CAAAA,OAAO,CAAG,CACdC,QAAQ,CAAEF,iBADI,CAAhB,CAIA,GAAMG,CAAAA,WAAW,0FAAG,iBAAOC,gBAAP,0IACZC,QADY,CACDR,WAAW,EADV,uBAEDO,CAAAA,gBAAgB,CAACE,OAAjB,CAAyB,GAAzB,gCAAmCL,OAAnC,MAA4CI,QAAQ,CAARA,QAA5C,GAFC,QAEZE,EAFY,qCAGIA,CAAAA,EAAE,CAACC,IAAH,EAHJ,QAGZC,OAHY,+CAIXA,OAAO,CAACC,MAJG,wDAAH,kBAAXP,CAAAA,WAAW,4CAAjB,CAOA,GAAMQ,CAAAA,cAAc,2FAAG,kBAAOP,gBAAP,8IACfC,QADe,CACJR,WAAW,EADP,wBAEJO,CAAAA,gBAAgB,CAACE,OAAjB,gCAA8BL,OAA9B,MAAuCW,KAAK,CAAEhB,QAA9C,CAAwDS,QAAQ,CAARA,QAAxD,GAFI,QAEfE,EAFe,uCAGCA,CAAAA,EAAE,CAACC,IAAH,EAHD,QAGfC,OAHe,iDAIdA,OAAO,CAACC,MAJM,0DAAH,kBAAdC,CAAAA,cAAc,8CAApB,CAOA,GAAME,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACC,MAAD,CAAgC,IAAvBC,CAAAA,UAAuB,2DAAV,KAAU,CACrD,GAAMC,CAAAA,QAAQ,CAAGxB,cAAc,EAA/B,CACA,kBAAoBD,YAAY,EAAhC,CAAQ0B,OAAR,eAAQA,OAAR,CACA,GAAMb,CAAAA,gBAAgB,CAAGL,WAAW,CAACe,MAAD,CAApC,CACA,GAAMI,CAAAA,kBAAkB,CAAGpB,aAAa,EAAxC,CAEA,GAAMqB,CAAAA,aAAa,CAAG7B,WAAW,sEAAC,6IAC5BwB,MAAM,GAAK,CADiB,kDAExBnB,CAAAA,WAAW,CAACuB,kBAAD,CAAqB,CAArB,CAFa,2CAGrBH,UAHqB,kDAIxBJ,CAAAA,cAAc,CAACP,gBAAD,CAJU,gEAMxBD,CAAAA,WAAW,CAACC,gBAAD,CANa,SAQhCY,QAAQ,CAACtB,uBAAuB,CAACoB,MAAD,CAASG,OAAT,CAAxB,CAAR,CACAD,QAAQ,CAACvB,iBAAiB,CAACqB,MAAD,CAASG,OAAT,CAAlB,CAAR,CATgC,yDAAD,GAU9B,CAACA,OAAD,CAAUD,QAAV,CAAoBD,UAApB,CAAgCG,kBAAhC,CAAoDd,gBAApD,CAAsEU,MAAtE,CAV8B,CAAjC,CAYA,MAAO,CAAEM,QAAQ,CAAED,aAAZ,CAAP,CACD,CAnBD,CAqBA,cAAeN,CAAAA,cAAf","sourcesContent":["import { useCallback } from 'react'\nimport { useWeb3React } from '@web3-react/core'\nimport { useAppDispatch } from 'state'\nimport { updateUserBalance, updateUserPendingReward } from 'state/actions'\nimport { harvestFarm } from 'utils/calls'\nimport { BIG_ZERO } from 'utils/bigNumber'\nimport getGasPrice from 'utils/getGasPrice'\nimport { useMasterchef, useSousChef } from 'hooks/useContract'\nimport { DEFAULT_GAS_LIMIT } from 'config'\n\nconst options = {\n  gasLimit: DEFAULT_GAS_LIMIT,\n}\n\nconst harvestPool = async (sousChefContract) => {\n  const gasPrice = getGasPrice()\n  const tx = await sousChefContract.deposit('0', { ...options, gasPrice })\n  const receipt = await tx.wait()\n  return receipt.status\n}\n\nconst harvestPoolBnb = async (sousChefContract) => {\n  const gasPrice = getGasPrice()\n  const tx = await sousChefContract.deposit({ ...options, value: BIG_ZERO, gasPrice })\n  const receipt = await tx.wait()\n  return receipt.status\n}\n\nconst useHarvestPool = (sousId, isUsingBnb = false) => {\n  const dispatch = useAppDispatch()\n  const { account } = useWeb3React()\n  const sousChefContract = useSousChef(sousId)\n  const masterChefContract = useMasterchef()\n\n  const handleHarvest = useCallback(async () => {\n    if (sousId === 0) {\n      await harvestFarm(masterChefContract, 0)\n    } else if (isUsingBnb) {\n      await harvestPoolBnb(sousChefContract)\n    } else {\n      await harvestPool(sousChefContract)\n    }\n    dispatch(updateUserPendingReward(sousId, account))\n    dispatch(updateUserBalance(sousId, account))\n  }, [account, dispatch, isUsingBnb, masterChefContract, sousChefContract, sousId])\n\n  return { onReward: handleHarvest }\n}\n\nexport default useHarvestPool\n"]},"metadata":{},"sourceType":"module"}