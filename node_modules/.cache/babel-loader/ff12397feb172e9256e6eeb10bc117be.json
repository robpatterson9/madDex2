{"ast":null,"code":"import _slicedToArray from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _taggedTemplateLiteral from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject;import React,{useCallback}from'react';import{useWeb3React}from'@web3-react/core';import styled from'styled-components';import BigNumber from'bignumber.js';import{Button,Flex,Heading,IconButton,AddIcon,MinusIcon,useModal}from'@pancakeswap/uikit';import{useLocation}from'react-router-dom';import Balance from'components/Balance';import{useTranslation}from'contexts/Localization';import{useAppDispatch}from'state';import{fetchFarmUserDataAsync}from'state/farms';import{useLpTokenPrice}from'state/farms/hooks';import{getBalanceAmount,getBalanceNumber}from'utils/formatBalance';import DepositModal from'../DepositModal';import WithdrawModal from'../WithdrawModal';import useUnstakeFarms from'../../hooks/useUnstakeFarms';import useStakeFarms from'../../hooks/useStakeFarms';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var IconButtonWrapper=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex;\\n  svg {\\n    width: 20px;\\n  }\\n\"])));var StakeAction=function StakeAction(_ref){var stakedBalance=_ref.stakedBalance,tokenBalance=_ref.tokenBalance,tokenName=_ref.tokenName,pid=_ref.pid,multiplier=_ref.multiplier,apr=_ref.apr,displayApr=_ref.displayApr,addLiquidityUrl=_ref.addLiquidityUrl,cakePrice=_ref.cakePrice,lpLabel=_ref.lpLabel;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useStakeFarms=useStakeFarms(pid),onStake=_useStakeFarms.onStake;var _useUnstakeFarms=useUnstakeFarms(pid),onUnstake=_useUnstakeFarms.onUnstake;var location=useLocation();var dispatch=useAppDispatch();var _useWeb3React=useWeb3React(),account=_useWeb3React.account;var lpPrice=useLpTokenPrice(tokenName);var handleStake=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(amount){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return onStake(amount);case 2:dispatch(fetchFarmUserDataAsync({account:account,pids:[pid]}));case 3:case\"end\":return _context.stop();}}},_callee);}));return function handleStake(_x){return _ref2.apply(this,arguments);};}();var handleUnstake=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(amount){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return onUnstake(amount);case 2:dispatch(fetchFarmUserDataAsync({account:account,pids:[pid]}));case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function handleUnstake(_x2){return _ref3.apply(this,arguments);};}();var displayBalance=useCallback(function(){var stakedBalanceBigNumber=getBalanceAmount(stakedBalance);if(stakedBalanceBigNumber.gt(0)&&stakedBalanceBigNumber.lt(0.0000001)){return'<0.0000001';}if(stakedBalanceBigNumber.gt(0)){return stakedBalanceBigNumber.toFixed(8,BigNumber.ROUND_DOWN);}return stakedBalanceBigNumber.toFixed(3,BigNumber.ROUND_DOWN);},[stakedBalance]);var _useModal=useModal(/*#__PURE__*/_jsx(DepositModal,{max:tokenBalance,stakedBalance:stakedBalance,onConfirm:handleStake,tokenName:tokenName,multiplier:multiplier,lpPrice:lpPrice,lpLabel:lpLabel,apr:apr,displayApr:displayApr,addLiquidityUrl:addLiquidityUrl,cakePrice:cakePrice})),_useModal2=_slicedToArray(_useModal,1),onPresentDeposit=_useModal2[0];var _useModal3=useModal(/*#__PURE__*/_jsx(WithdrawModal,{max:stakedBalance,onConfirm:handleUnstake,tokenName:tokenName})),_useModal4=_slicedToArray(_useModal3,1),onPresentWithdraw=_useModal4[0];var renderStakingButtons=function renderStakingButtons(){return stakedBalance.eq(0)?/*#__PURE__*/_jsx(Button,{onClick:onPresentDeposit,disabled:['history','archived'].some(function(item){return location.pathname.includes(item);}),children:t('Stake LP')}):/*#__PURE__*/_jsxs(IconButtonWrapper,{children:[/*#__PURE__*/_jsx(IconButton,{variant:\"tertiary\",onClick:onPresentWithdraw,mr:\"6px\",children:/*#__PURE__*/_jsx(MinusIcon,{color:\"primary\",width:\"14px\"})}),/*#__PURE__*/_jsx(IconButton,{variant:\"tertiary\",onClick:onPresentDeposit,disabled:['history','archived'].some(function(item){return location.pathname.includes(item);}),children:/*#__PURE__*/_jsx(AddIcon,{color:\"primary\",width:\"14px\"})})]});};return/*#__PURE__*/_jsxs(Flex,{justifyContent:\"space-between\",alignItems:\"center\",children:[/*#__PURE__*/_jsxs(Flex,{flexDirection:\"column\",alignItems:\"flex-start\",children:[/*#__PURE__*/_jsx(Heading,{color:stakedBalance.eq(0)?'textDisabled':'text',children:displayBalance()}),stakedBalance.gt(0)&&lpPrice.gt(0)&&/*#__PURE__*/_jsx(Balance,{fontSize:\"12px\",color:\"textSubtle\",decimals:2,value:getBalanceNumber(lpPrice.times(stakedBalance)),unit:\" USD\",prefix:\"~\"})]}),renderStakingButtons()]});};export default StakeAction;","map":{"version":3,"sources":["/Volumes/evo970/lou/madDex-master/src/views/Farms/components/FarmCard/StakeAction.tsx"],"names":["React","useCallback","useWeb3React","styled","BigNumber","Button","Flex","Heading","IconButton","AddIcon","MinusIcon","useModal","useLocation","Balance","useTranslation","useAppDispatch","fetchFarmUserDataAsync","useLpTokenPrice","getBalanceAmount","getBalanceNumber","DepositModal","WithdrawModal","useUnstakeFarms","useStakeFarms","IconButtonWrapper","div","StakeAction","stakedBalance","tokenBalance","tokenName","pid","multiplier","apr","displayApr","addLiquidityUrl","cakePrice","lpLabel","t","onStake","onUnstake","location","dispatch","account","lpPrice","handleStake","amount","pids","handleUnstake","displayBalance","stakedBalanceBigNumber","gt","lt","toFixed","ROUND_DOWN","onPresentDeposit","onPresentWithdraw","renderStakingButtons","eq","some","item","pathname","includes","times"],"mappings":"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","sourcesContent":["import React, { useCallback } from 'react'\nimport { useWeb3React } from '@web3-react/core'\nimport styled from 'styled-components'\nimport BigNumber from 'bignumber.js'\nimport { Button, Flex, Heading, IconButton, AddIcon, MinusIcon, useModal } from '@pancakeswap/uikit'\nimport { useLocation } from 'react-router-dom'\nimport Balance from 'components/Balance'\nimport { useTranslation } from 'contexts/Localization'\nimport { useAppDispatch } from 'state'\nimport { fetchFarmUserDataAsync } from 'state/farms'\nimport { useLpTokenPrice } from 'state/farms/hooks'\nimport { getBalanceAmount, getBalanceNumber } from 'utils/formatBalance'\nimport DepositModal from '../DepositModal'\nimport WithdrawModal from '../WithdrawModal'\nimport useUnstakeFarms from '../../hooks/useUnstakeFarms'\nimport useStakeFarms from '../../hooks/useStakeFarms'\n\ninterface FarmCardActionsProps {\n  stakedBalance?: BigNumber\n  tokenBalance?: BigNumber\n  tokenName?: string\n  pid?: number\n  multiplier?: string\n  apr?: number\n  displayApr?: string\n  addLiquidityUrl?: string\n  cakePrice?: BigNumber\n  lpLabel?: string\n}\n\nconst IconButtonWrapper = styled.div`\n  display: flex;\n  svg {\n    width: 20px;\n  }\n`\n\nconst StakeAction: React.FC<FarmCardActionsProps> = ({\n  stakedBalance,\n  tokenBalance,\n  tokenName,\n  pid,\n  multiplier,\n  apr,\n  displayApr,\n  addLiquidityUrl,\n  cakePrice,\n  lpLabel,\n}) => {\n  const { t } = useTranslation()\n  const { onStake } = useStakeFarms(pid)\n  const { onUnstake } = useUnstakeFarms(pid)\n  const location = useLocation()\n  const dispatch = useAppDispatch()\n  const { account } = useWeb3React()\n  const lpPrice = useLpTokenPrice(tokenName)\n\n  const handleStake = async (amount: string) => {\n    await onStake(amount)\n    dispatch(fetchFarmUserDataAsync({ account, pids: [pid] }))\n  }\n\n  const handleUnstake = async (amount: string) => {\n    await onUnstake(amount)\n    dispatch(fetchFarmUserDataAsync({ account, pids: [pid] }))\n  }\n\n  const displayBalance = useCallback(() => {\n    const stakedBalanceBigNumber = getBalanceAmount(stakedBalance)\n    if (stakedBalanceBigNumber.gt(0) && stakedBalanceBigNumber.lt(0.0000001)) {\n      return '<0.0000001'\n    }\n    if (stakedBalanceBigNumber.gt(0)) {\n      return stakedBalanceBigNumber.toFixed(8, BigNumber.ROUND_DOWN)\n    }\n    return stakedBalanceBigNumber.toFixed(3, BigNumber.ROUND_DOWN)\n  }, [stakedBalance])\n\n  const [onPresentDeposit] = useModal(\n    <DepositModal\n      max={tokenBalance}\n      stakedBalance={stakedBalance}\n      onConfirm={handleStake}\n      tokenName={tokenName}\n      multiplier={multiplier}\n      lpPrice={lpPrice}\n      lpLabel={lpLabel}\n      apr={apr}\n      displayApr={displayApr}\n      addLiquidityUrl={addLiquidityUrl}\n      cakePrice={cakePrice}\n    />,\n  )\n  const [onPresentWithdraw] = useModal(\n    <WithdrawModal max={stakedBalance} onConfirm={handleUnstake} tokenName={tokenName} />,\n  )\n\n  const renderStakingButtons = () => {\n    return stakedBalance.eq(0) ? (\n      <Button\n        onClick={onPresentDeposit}\n        disabled={['history', 'archived'].some((item) => location.pathname.includes(item))}\n      >\n        {t('Stake LP')}\n      </Button>\n    ) : (\n      <IconButtonWrapper>\n        <IconButton variant=\"tertiary\" onClick={onPresentWithdraw} mr=\"6px\">\n          <MinusIcon color=\"primary\" width=\"14px\" />\n        </IconButton>\n        <IconButton\n          variant=\"tertiary\"\n          onClick={onPresentDeposit}\n          disabled={['history', 'archived'].some((item) => location.pathname.includes(item))}\n        >\n          <AddIcon color=\"primary\" width=\"14px\" />\n        </IconButton>\n      </IconButtonWrapper>\n    )\n  }\n\n  return (\n    <Flex justifyContent=\"space-between\" alignItems=\"center\">\n      <Flex flexDirection=\"column\" alignItems=\"flex-start\">\n        <Heading color={stakedBalance.eq(0) ? 'textDisabled' : 'text'}>{displayBalance()}</Heading>\n        {stakedBalance.gt(0) && lpPrice.gt(0) && (\n          <Balance\n            fontSize=\"12px\"\n            color=\"textSubtle\"\n            decimals={2}\n            value={getBalanceNumber(lpPrice.times(stakedBalance))}\n            unit=\" USD\"\n            prefix=\"~\"\n          />\n        )}\n      </Flex>\n      {renderStakingButtons()}\n    </Flex>\n  )\n}\n\nexport default StakeAction\n"]},"metadata":{},"sourceType":"module"}