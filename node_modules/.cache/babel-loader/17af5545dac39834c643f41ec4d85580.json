{"ast":null,"code":"import _regeneratorRuntime from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _defineProperty from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _asyncToGenerator from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _toConsumableArray from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _taggedTemplateLiteral from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2;import React,{useEffect,useState}from'react';import styled from'styled-components';import{ModalContainer,ModalBody,ModalTitle,ModalHeader,Button,AutoRenewIcon,TrophyGoldIcon,Text,Flex,Heading,Box,ModalCloseButton,Skeleton}from'@pancakeswap/uikit';import{useWeb3React}from'@web3-react/core';import{useAppDispatch}from'state';import{REWARD_RATE}from'state/predictions/config';import{fetchNodeHistory,markAsCollected}from'state/predictions';import{useTranslation}from'contexts/Localization';import{useBNBBusdPrice}from'hooks/useBUSDPrice';import useToast from'hooks/useToast';import{usePredictionsContract}from'hooks/useContract';import{useCallWithGasPrice}from'hooks/useCallWithGasPrice';import{ToastDescriptionWithTx}from'components/Toast';import{useGetHistory,useGetIsFetchingHistory}from'state/predictions/hooks';import{multiplyPriceByAmount}from'utils/prices';import{formatNumber}from'utils/formatBalance';import{getPayout}from'./History/helpers';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Modal=styled(ModalContainer)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  overflow: visible;\\n\"])));var BunnyDecoration=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  position: absolute;\\n  top: -116px; // line up bunny at the top of the modal\\n  left: 0px;\\n  text-align: center;\\n  width: 100%;\\n\"])));var calculateClaimableRounds=function calculateClaimableRounds(history){if(!history){return{epochs:[],total:0};}return history.reduce(function(accum,bet){if(!bet.claimed&&bet.position===bet.round.position){var betPayout=getPayout(bet,REWARD_RATE);return _objectSpread(_objectSpread({},accum),{},{epochs:[].concat(_toConsumableArray(accum.epochs),[bet.round.epoch]),total:accum.total+betPayout});}return accum;},{epochs:[],total:0});};var CollectRoundWinningsModal=function CollectRoundWinningsModal(_ref){var onDismiss=_ref.onDismiss,onSuccess=_ref.onSuccess;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isPendingTx=_useState2[0],setIsPendingTx=_useState2[1];var _useWeb3React=useWeb3React(),account=_useWeb3React.account;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useToast=useToast(),toastSuccess=_useToast.toastSuccess,toastError=_useToast.toastError;var _useCallWithGasPrice=useCallWithGasPrice(),callWithGasPrice=_useCallWithGasPrice.callWithGasPrice;var predictionsContract=usePredictionsContract();var bnbBusdPrice=useBNBBusdPrice();var dispatch=useAppDispatch();var isLoadingHistory=useGetIsFetchingHistory();var history=useGetHistory();var _calculateClaimableRo=calculateClaimableRounds(history),epochs=_calculateClaimableRo.epochs,total=_calculateClaimableRo.total;var totalBnb=multiplyPriceByAmount(bnbBusdPrice,total);useEffect(function(){// Fetch history if they have not opened the history pane yet\nif(history.length===0){dispatch(fetchNodeHistory({account:account}));}},[account,history,dispatch]);var handleClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var tx,receipt,_error$data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return callWithGasPrice(predictionsContract,'claim',[epochs]);case 3:tx=_context.sent;setIsPendingTx(true);_context.next=7;return tx.wait();case 7:receipt=_context.sent;// Immediately mark rounds as claimed\ndispatch(markAsCollected(epochs.reduce(function(accum,epoch){return _objectSpread(_objectSpread({},accum),{},_defineProperty({},epoch,true));},{})));if(!onSuccess){_context.next=12;break;}_context.next=12;return onSuccess();case 12:onDismiss();setIsPendingTx(false);toastSuccess(t('Winnings collected!'),/*#__PURE__*/_jsx(ToastDescriptionWithTx,{txHash:receipt.transactionHash,children:t('Your prizes have been sent to your wallet')}));_context.next=21;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](0);console.error('Unable to claim winnings',_context.t0);toastError(t('Error'),(_context.t0===null||_context.t0===void 0?void 0:(_error$data=_context.t0.data)===null||_error$data===void 0?void 0:_error$data.message)||t('Please try again. Confirm the transaction and make sure you are paying enough gas!'));case 21:_context.prev=21;setIsPendingTx(false);return _context.finish(21);case 24:case\"end\":return _context.stop();}}},_callee,null,[[0,17,21,24]]);}));return function handleClick(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Modal,{minWidth:\"288px\",position:\"relative\",mt:\"124px\",children:[/*#__PURE__*/_jsx(BunnyDecoration,{children:/*#__PURE__*/_jsx(\"img\",{src:\"/images/decorations/prize-bunny.png\",alt:\"bunny decoration\",height:\"124px\",width:\"168px\"})}),/*#__PURE__*/_jsxs(ModalHeader,{children:[/*#__PURE__*/_jsx(ModalTitle,{children:/*#__PURE__*/_jsx(Heading,{children:t('Collect Winnings')})}),/*#__PURE__*/_jsx(ModalCloseButton,{onDismiss:onDismiss})]}),/*#__PURE__*/_jsxs(ModalBody,{p:\"24px\",children:[/*#__PURE__*/_jsx(TrophyGoldIcon,{width:\"96px\",mx:\"auto\",mb:\"24px\"}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"start\",justifyContent:\"space-between\",mb:\"8px\",children:[/*#__PURE__*/_jsx(Text,{children:t('Collecting')}),/*#__PURE__*/_jsxs(Box,{style:{textAlign:'right'},children:[/*#__PURE__*/_jsx(Text,{children:\"\".concat(formatNumber(total,0,4),\" BNB\")}),/*#__PURE__*/_jsx(Text,{fontSize:\"12px\",color:\"textSubtle\",children:\"~$\".concat(totalBnb.toFixed(2))})]})]}),/*#__PURE__*/_jsx(Flex,{alignItems:\"start\",justifyContent:\"center\",mb:\"24px\",children:isLoadingHistory?/*#__PURE__*/_jsx(Skeleton,{height:\"21\",width:\"140px\"}):/*#__PURE__*/_jsx(Text,{color:\"textSubtle\",fontSize:\"14px\",children:epochs.length===1?t('From round %round%',{round:epochs[0]}):t('From rounds %rounds%',{rounds:epochs.join(', ')})})}),/*#__PURE__*/_jsx(Button,{width:\"100%\",mb:\"8px\",onClick:handleClick,isLoading:isPendingTx||isLoadingHistory,endIcon:isPendingTx?/*#__PURE__*/_jsx(AutoRenewIcon,{spin:true,color:\"currentColor\"}):null,children:t('Confirm')})]})]});};export default CollectRoundWinningsModal;","map":{"version":3,"sources":["/Volumes/evo970/lou/madDex-master/src/views/Predictions/components/CollectRoundWinningsModal.tsx"],"names":["React","useEffect","useState","styled","ModalContainer","ModalBody","ModalTitle","ModalHeader","Button","AutoRenewIcon","TrophyGoldIcon","Text","Flex","Heading","Box","ModalCloseButton","Skeleton","useWeb3React","useAppDispatch","REWARD_RATE","fetchNodeHistory","markAsCollected","useTranslation","useBNBBusdPrice","useToast","usePredictionsContract","useCallWithGasPrice","ToastDescriptionWithTx","useGetHistory","useGetIsFetchingHistory","multiplyPriceByAmount","formatNumber","getPayout","Modal","BunnyDecoration","div","calculateClaimableRounds","history","epochs","total","reduce","accum","bet","claimed","position","round","betPayout","epoch","CollectRoundWinningsModal","onDismiss","onSuccess","isPendingTx","setIsPendingTx","account","t","toastSuccess","toastError","callWithGasPrice","predictionsContract","bnbBusdPrice","dispatch","isLoadingHistory","totalBnb","length","handleClick","tx","wait","receipt","transactionHash","console","error","data","message","textAlign","toFixed","rounds","join"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport styled from 'styled-components'\nimport {\n  ModalContainer,\n  ModalBody,\n  ModalTitle,\n  ModalHeader,\n  InjectedModalProps,\n  Button,\n  AutoRenewIcon,\n  TrophyGoldIcon,\n  Text,\n  Flex,\n  Heading,\n  Box,\n  ModalCloseButton,\n  Skeleton,\n} from '@pancakeswap/uikit'\nimport { useWeb3React } from '@web3-react/core'\nimport { useAppDispatch } from 'state'\nimport { REWARD_RATE } from 'state/predictions/config'\nimport { fetchNodeHistory, markAsCollected } from 'state/predictions'\nimport { Bet } from 'state/types'\nimport { useTranslation } from 'contexts/Localization'\nimport { useBNBBusdPrice } from 'hooks/useBUSDPrice'\nimport useToast from 'hooks/useToast'\nimport { usePredictionsContract } from 'hooks/useContract'\nimport { useCallWithGasPrice } from 'hooks/useCallWithGasPrice'\nimport { ToastDescriptionWithTx } from 'components/Toast'\nimport { useGetHistory, useGetIsFetchingHistory } from 'state/predictions/hooks'\nimport { multiplyPriceByAmount } from 'utils/prices'\nimport { formatNumber } from 'utils/formatBalance'\nimport { getPayout } from './History/helpers'\n\ninterface CollectRoundWinningsModalProps extends InjectedModalProps {\n  onSuccess?: () => Promise<void>\n}\n\nconst Modal = styled(ModalContainer)`\n  overflow: visible;\n`\n\nconst BunnyDecoration = styled.div`\n  position: absolute;\n  top: -116px; // line up bunny at the top of the modal\n  left: 0px;\n  text-align: center;\n  width: 100%;\n`\n\ninterface ClaimableRounds {\n  epochs: number[]\n  total: number\n}\n\nconst calculateClaimableRounds = (history): ClaimableRounds => {\n  if (!history) {\n    return { epochs: [], total: 0 }\n  }\n\n  return history.reduce(\n    (accum: ClaimableRounds, bet: Bet) => {\n      if (!bet.claimed && bet.position === bet.round.position) {\n        const betPayout = getPayout(bet, REWARD_RATE)\n        return {\n          ...accum,\n          epochs: [...accum.epochs, bet.round.epoch],\n          total: accum.total + betPayout,\n        }\n      }\n\n      return accum\n    },\n    { epochs: [], total: 0 },\n  )\n}\n\nconst CollectRoundWinningsModal: React.FC<CollectRoundWinningsModalProps> = ({ onDismiss, onSuccess }) => {\n  const [isPendingTx, setIsPendingTx] = useState(false)\n  const { account } = useWeb3React()\n  const { t } = useTranslation()\n  const { toastSuccess, toastError } = useToast()\n  const { callWithGasPrice } = useCallWithGasPrice()\n  const predictionsContract = usePredictionsContract()\n  const bnbBusdPrice = useBNBBusdPrice()\n  const dispatch = useAppDispatch()\n  const isLoadingHistory = useGetIsFetchingHistory()\n  const history = useGetHistory()\n\n  const { epochs, total } = calculateClaimableRounds(history)\n  const totalBnb = multiplyPriceByAmount(bnbBusdPrice, total)\n\n  useEffect(() => {\n    // Fetch history if they have not opened the history pane yet\n    if (history.length === 0) {\n      dispatch(fetchNodeHistory({ account }))\n    }\n  }, [account, history, dispatch])\n\n  const handleClick = async () => {\n    try {\n      const tx = await callWithGasPrice(predictionsContract, 'claim', [epochs])\n      setIsPendingTx(true)\n      const receipt = await tx.wait()\n\n      // Immediately mark rounds as claimed\n      dispatch(\n        markAsCollected(\n          epochs.reduce((accum, epoch) => {\n            return { ...accum, [epoch]: true }\n          }, {}),\n        ),\n      )\n\n      if (onSuccess) {\n        await onSuccess()\n      }\n\n      onDismiss()\n      setIsPendingTx(false)\n      toastSuccess(\n        t('Winnings collected!'),\n        <ToastDescriptionWithTx txHash={receipt.transactionHash}>\n          {t('Your prizes have been sent to your wallet')}\n        </ToastDescriptionWithTx>,\n      )\n    } catch (error) {\n      console.error('Unable to claim winnings', error)\n      toastError(\n        t('Error'),\n        error?.data?.message || t('Please try again. Confirm the transaction and make sure you are paying enough gas!'),\n      )\n    } finally {\n      setIsPendingTx(false)\n    }\n  }\n\n  return (\n    <Modal minWidth=\"288px\" position=\"relative\" mt=\"124px\">\n      <BunnyDecoration>\n        <img src=\"/images/decorations/prize-bunny.png\" alt=\"bunny decoration\" height=\"124px\" width=\"168px\" />\n      </BunnyDecoration>\n      <ModalHeader>\n        <ModalTitle>\n          <Heading>{t('Collect Winnings')}</Heading>\n        </ModalTitle>\n        <ModalCloseButton onDismiss={onDismiss} />\n      </ModalHeader>\n      <ModalBody p=\"24px\">\n        <TrophyGoldIcon width=\"96px\" mx=\"auto\" mb=\"24px\" />\n        <Flex alignItems=\"start\" justifyContent=\"space-between\" mb=\"8px\">\n          <Text>{t('Collecting')}</Text>\n          <Box style={{ textAlign: 'right' }}>\n            <Text>{`${formatNumber(total, 0, 4)} BNB`}</Text>\n            <Text fontSize=\"12px\" color=\"textSubtle\">\n              {`~$${totalBnb.toFixed(2)}`}\n            </Text>\n          </Box>\n        </Flex>\n        <Flex alignItems=\"start\" justifyContent=\"center\" mb=\"24px\">\n          {isLoadingHistory ? (\n            <Skeleton height=\"21\" width=\"140px\" />\n          ) : (\n            <Text color=\"textSubtle\" fontSize=\"14px\">\n              {epochs.length === 1\n                ? t('From round %round%', { round: epochs[0] })\n                : t('From rounds %rounds%', { rounds: epochs.join(', ') })}\n            </Text>\n          )}\n        </Flex>\n        <Button\n          width=\"100%\"\n          mb=\"8px\"\n          onClick={handleClick}\n          isLoading={isPendingTx || isLoadingHistory}\n          endIcon={isPendingTx ? <AutoRenewIcon spin color=\"currentColor\" /> : null}\n        >\n          {t('Confirm')}\n        </Button>\n      </ModalBody>\n    </Modal>\n  )\n}\n\nexport default CollectRoundWinningsModal\n"]},"metadata":{},"sourceType":"module"}