{"ast":null,"code":"import _taggedTemplateLiteral from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject;import React from'react';import styled from'styled-components';import{useWeb3React}from'@web3-react/core';import{Box,Flex,Heading,Text,Button,Link,OpenNewIcon}from'@pancakeswap/uikit';import{useTranslation}from'contexts/Localization';import{getRoundResult,Result}from'state/predictions/helpers';import{REWARD_RATE}from'state/predictions/config';import{getBscScanLink}from'utils';import{multiplyPriceByAmount}from'utils/prices';import{useBNBBusdPrice}from'hooks/useBUSDPrice';import{useGetCurrentEpoch}from'state/predictions/hooks';import{BetPosition}from'state/types';import{formatBnb,getMultiplier,getNetPayout}from'../helpers';import PnlChart from'./PnlChart';import SummaryRow from'./SummaryRow';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Divider=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  background-color: \",\";\\n  height: 1px;\\n  margin: 24px auto;\\n  width: 100%;\\n\"])),function(_ref){var theme=_ref.theme;return theme.colors.backgroundDisabled;});var initialPnlSummary={won:{rounds:0,amount:0,payout:0,// net payout after all deductions\nbestRound:{id:'0',payout:0,// net payout after all deductions\nmultiplier:0}},lost:{rounds:0,amount:0},entered:{rounds:0,amount:0}};var getPnlSummary=function getPnlSummary(bets,currentEpoch){return bets.reduce(function(summary,bet){var roundResult=getRoundResult(bet,currentEpoch);if(roundResult===Result.WIN){var payout=getNetPayout(bet,REWARD_RATE);var bestRound=summary.won.bestRound;if(payout>bestRound.payout){var _bet$round=bet.round,bullAmount=_bet$round.bullAmount,bearAmount=_bet$round.bearAmount,totalAmount=_bet$round.totalAmount;var multiplier=getMultiplier(totalAmount,bet.position===BetPosition.BULL?bullAmount:bearAmount);bestRound={id:bet.round.epoch.toString(),payout:payout,multiplier:multiplier};}return{won:{rounds:summary.won.rounds+1,amount:summary.won.amount+bet.amount,payout:summary.won.payout+payout,bestRound:bestRound},entered:{rounds:summary.entered.rounds+1,amount:summary.entered.amount+bet.amount},lost:summary.lost};}if(roundResult===Result.LOSE||roundResult===Result.HOUSE){return{lost:{rounds:summary.lost.rounds+1,amount:summary.lost.amount+bet.amount},entered:{rounds:summary.entered.rounds+1,amount:summary.entered.amount+bet.amount},won:summary.won};}// Ignore Canceled and Live rounds\nreturn summary;},initialPnlSummary);};var PnlTab=function PnlTab(_ref2){var hasBetHistory=_ref2.hasBetHistory,bets=_ref2.bets;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useWeb3React=useWeb3React(),account=_useWeb3React.account;var currentEpoch=useGetCurrentEpoch();var bnbBusdPrice=useBNBBusdPrice();var summary=getPnlSummary(bets,currentEpoch);var netResultAmount=summary.won.payout-summary.lost.amount;var netResultIsPositive=netResultAmount>0;var avgPositionEntered=summary.entered.amount/summary.entered.rounds;var avgBnbWonPerRound=netResultAmount/summary.entered.rounds;var avgBnbWonIsPositive=avgBnbWonPerRound>0;// Guard in case user has only lost rounds\nvar hasBestRound=summary.won.bestRound.payout!==0;var netResultInUsd=multiplyPriceByAmount(bnbBusdPrice,netResultAmount);var avgBnbWonInUsd=multiplyPriceByAmount(bnbBusdPrice,avgBnbWonPerRound);var betRoundInUsd=multiplyPriceByAmount(bnbBusdPrice,summary.won.bestRound.payout);var avgPositionEnteredInUsd=multiplyPriceByAmount(bnbBusdPrice,avgPositionEntered);return hasBetHistory?/*#__PURE__*/_jsxs(Box,{p:\"16px\",children:[/*#__PURE__*/_jsx(Text,{bold:true,fontSize:\"24px\",color:\"secondary\",pb:\"24px\",children:t('Your history')}),/*#__PURE__*/_jsxs(Flex,{children:[/*#__PURE__*/_jsx(PnlChart,{lost:summary.lost.rounds,won:summary.won.rounds}),/*#__PURE__*/_jsxs(Flex,{flexDirection:\"column\",justifyContent:\"center\",pl:\"24px\",children:[/*#__PURE__*/_jsx(Text,{bold:true,color:\"textSubtle\",children:t('Net results')}),/*#__PURE__*/_jsx(Text,{bold:true,fontSize:\"24px\",lineHeight:\"1\",color:netResultIsPositive?'success':'failure',children:\"\".concat(netResultIsPositive?'+':'').concat(formatBnb(netResultAmount),\" BNB\")}),/*#__PURE__*/_jsx(Text,{small:true,color:\"textSubtle\",children:\"~$\".concat(netResultInUsd.toFixed(2))})]})]}),/*#__PURE__*/_jsxs(Box,{pl:\"8px\",children:[/*#__PURE__*/_jsx(Text,{mt:\"24px\",bold:true,color:\"textSubtle\",children:t('Average return / round')}),/*#__PURE__*/_jsx(Text,{bold:true,color:avgBnbWonIsPositive?'success':'failure',children:\"\".concat(avgBnbWonIsPositive?'+':'').concat(formatBnb(avgBnbWonPerRound),\" BNB\")}),/*#__PURE__*/_jsx(Text,{small:true,color:\"textSubtle\",children:\"~$\".concat(avgBnbWonInUsd.toFixed(2))}),hasBestRound&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Text,{mt:\"16px\",bold:true,color:\"textSubtle\",children:t('Best round: #%roundId%',{roundId:summary.won.bestRound.id})}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"flex-end\",children:[/*#__PURE__*/_jsx(Text,{bold:true,color:\"success\",children:\"+\".concat(formatBnb(summary.won.bestRound.payout),\" BNB\")}),/*#__PURE__*/_jsxs(Text,{ml:\"4px\",small:true,color:\"textSubtle\",children:[\"(\",summary.won.bestRound.multiplier.toFixed(2),\"x)\"]})]}),/*#__PURE__*/_jsx(Text,{small:true,color:\"textSubtle\",children:\"~$\".concat(betRoundInUsd.toFixed(2))})]}),/*#__PURE__*/_jsx(Text,{mt:\"16px\",bold:true,color:\"textSubtle\",children:t('Average position entered / round')}),/*#__PURE__*/_jsx(Text,{bold:true,children:\"\".concat(formatBnb(avgPositionEntered),\" BNB\")}),/*#__PURE__*/_jsx(Text,{small:true,color:\"textSubtle\",children:\"~$\".concat(avgPositionEnteredInUsd.toFixed(2))}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(SummaryRow,{type:\"won\",summary:summary,bnbBusdPrice:bnbBusdPrice}),/*#__PURE__*/_jsx(SummaryRow,{type:\"lost\",summary:summary,bnbBusdPrice:bnbBusdPrice}),/*#__PURE__*/_jsx(SummaryRow,{type:\"entered\",summary:summary,bnbBusdPrice:bnbBusdPrice}),/*#__PURE__*/_jsx(Flex,{justifyContent:\"center\",mt:\"24px\",children:/*#__PURE__*/_jsx(Link,{href:\"\".concat(getBscScanLink(account,'address'),\"#internaltx\"),mb:\"16px\",external:true,children:/*#__PURE__*/_jsxs(Button,{mt:\"8px\",width:\"100%\",children:[t('View Reclaimed & Won'),/*#__PURE__*/_jsx(OpenNewIcon,{color:\"white\",ml:\"4px\"})]})})})]})]}):/*#__PURE__*/_jsxs(Box,{p:\"24px\",children:[/*#__PURE__*/_jsx(Heading,{size:\"lg\",textAlign:\"center\",mb:\"8px\",children:t('No prediction history available')}),/*#__PURE__*/_jsx(Text,{as:\"p\",textAlign:\"center\",children:t('If you are sure you should see history here, make sure you’re connected to the correct wallet and try again.')})]});};export default PnlTab;","map":{"version":3,"sources":["/Volumes/evo970/lou/madDex-master/src/views/Predictions/components/History/PnlTab/PnlTab.tsx"],"names":["React","styled","useWeb3React","Box","Flex","Heading","Text","Button","Link","OpenNewIcon","useTranslation","getRoundResult","Result","REWARD_RATE","getBscScanLink","multiplyPriceByAmount","useBNBBusdPrice","useGetCurrentEpoch","BetPosition","formatBnb","getMultiplier","getNetPayout","PnlChart","SummaryRow","Divider","div","theme","colors","backgroundDisabled","initialPnlSummary","won","rounds","amount","payout","bestRound","id","multiplier","lost","entered","getPnlSummary","bets","currentEpoch","reduce","summary","bet","roundResult","WIN","round","bullAmount","bearAmount","totalAmount","position","BULL","epoch","toString","LOSE","HOUSE","PnlTab","hasBetHistory","t","account","bnbBusdPrice","netResultAmount","netResultIsPositive","avgPositionEntered","avgBnbWonPerRound","avgBnbWonIsPositive","hasBestRound","netResultInUsd","avgBnbWonInUsd","betRoundInUsd","avgPositionEnteredInUsd","toFixed","roundId"],"mappings":"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","sourcesContent":["import React from 'react'\nimport styled from 'styled-components'\nimport { useWeb3React } from '@web3-react/core'\nimport { Box, Flex, Heading, Text, Button, Link, OpenNewIcon } from '@pancakeswap/uikit'\nimport { useTranslation } from 'contexts/Localization'\nimport { getRoundResult, Result } from 'state/predictions/helpers'\nimport { REWARD_RATE } from 'state/predictions/config'\nimport { getBscScanLink } from 'utils'\nimport { multiplyPriceByAmount } from 'utils/prices'\nimport { useBNBBusdPrice } from 'hooks/useBUSDPrice'\nimport { useGetCurrentEpoch } from 'state/predictions/hooks'\nimport { Bet, BetPosition } from 'state/types'\nimport { formatBnb, getMultiplier, getNetPayout } from '../helpers'\nimport PnlChart from './PnlChart'\nimport SummaryRow from './SummaryRow'\n\ninterface PnlTabProps {\n  hasBetHistory: boolean\n  bets: Bet[]\n}\n\ninterface PnlCategory {\n  rounds: number\n  amount: number\n}\n\ninterface PnlSummary {\n  won: PnlCategory & { payout: number; bestRound: { id: string; payout: number; multiplier: number } }\n  lost: PnlCategory\n  entered: PnlCategory\n}\n\nconst Divider = styled.div`\n  background-color: ${({ theme }) => theme.colors.backgroundDisabled};\n  height: 1px;\n  margin: 24px auto;\n  width: 100%;\n`\n\nconst initialPnlSummary: PnlSummary = {\n  won: {\n    rounds: 0,\n    amount: 0,\n    payout: 0, // net payout after all deductions\n    bestRound: {\n      id: '0',\n      payout: 0, // net payout after all deductions\n      multiplier: 0,\n    },\n  },\n  lost: {\n    rounds: 0,\n    amount: 0,\n  },\n  entered: {\n    rounds: 0,\n    amount: 0,\n  },\n}\n\nconst getPnlSummary = (bets: Bet[], currentEpoch: number): PnlSummary => {\n  return bets.reduce((summary: PnlSummary, bet) => {\n    const roundResult = getRoundResult(bet, currentEpoch)\n    if (roundResult === Result.WIN) {\n      const payout = getNetPayout(bet, REWARD_RATE)\n      let { bestRound } = summary.won\n      if (payout > bestRound.payout) {\n        const { bullAmount, bearAmount, totalAmount } = bet.round\n        const multiplier = getMultiplier(totalAmount, bet.position === BetPosition.BULL ? bullAmount : bearAmount)\n        bestRound = { id: bet.round.epoch.toString(), payout, multiplier }\n      }\n      return {\n        won: {\n          rounds: summary.won.rounds + 1,\n          amount: summary.won.amount + bet.amount,\n          payout: summary.won.payout + payout,\n          bestRound,\n        },\n        entered: {\n          rounds: summary.entered.rounds + 1,\n          amount: summary.entered.amount + bet.amount,\n        },\n        lost: summary.lost,\n      }\n    }\n    if (roundResult === Result.LOSE || roundResult === Result.HOUSE) {\n      return {\n        lost: {\n          rounds: summary.lost.rounds + 1,\n          amount: summary.lost.amount + bet.amount,\n        },\n        entered: {\n          rounds: summary.entered.rounds + 1,\n          amount: summary.entered.amount + bet.amount,\n        },\n        won: summary.won,\n      }\n    }\n    // Ignore Canceled and Live rounds\n    return summary\n  }, initialPnlSummary)\n}\n\nconst PnlTab: React.FC<PnlTabProps> = ({ hasBetHistory, bets }) => {\n  const { t } = useTranslation()\n  const { account } = useWeb3React()\n  const currentEpoch = useGetCurrentEpoch()\n  const bnbBusdPrice = useBNBBusdPrice()\n\n  const summary = getPnlSummary(bets, currentEpoch)\n\n  const netResultAmount = summary.won.payout - summary.lost.amount\n  const netResultIsPositive = netResultAmount > 0\n  const avgPositionEntered = summary.entered.amount / summary.entered.rounds\n  const avgBnbWonPerRound = netResultAmount / summary.entered.rounds\n  const avgBnbWonIsPositive = avgBnbWonPerRound > 0\n\n  // Guard in case user has only lost rounds\n  const hasBestRound = summary.won.bestRound.payout !== 0\n\n  const netResultInUsd = multiplyPriceByAmount(bnbBusdPrice, netResultAmount)\n  const avgBnbWonInUsd = multiplyPriceByAmount(bnbBusdPrice, avgBnbWonPerRound)\n  const betRoundInUsd = multiplyPriceByAmount(bnbBusdPrice, summary.won.bestRound.payout)\n  const avgPositionEnteredInUsd = multiplyPriceByAmount(bnbBusdPrice, avgPositionEntered)\n\n  return hasBetHistory ? (\n    <Box p=\"16px\">\n      <Text bold fontSize=\"24px\" color=\"secondary\" pb=\"24px\">\n        {t('Your history')}\n      </Text>\n      <Flex>\n        <PnlChart lost={summary.lost.rounds} won={summary.won.rounds} />\n        <Flex flexDirection=\"column\" justifyContent=\"center\" pl=\"24px\">\n          <Text bold color=\"textSubtle\">\n            {t('Net results')}\n          </Text>\n          <Text bold fontSize=\"24px\" lineHeight=\"1\" color={netResultIsPositive ? 'success' : 'failure'}>\n            {`${netResultIsPositive ? '+' : ''}${formatBnb(netResultAmount)} BNB`}\n          </Text>\n          <Text small color=\"textSubtle\">\n            {`~$${netResultInUsd.toFixed(2)}`}\n          </Text>\n        </Flex>\n      </Flex>\n      <Box pl=\"8px\">\n        <Text mt=\"24px\" bold color=\"textSubtle\">\n          {t('Average return / round')}\n        </Text>\n        <Text bold color={avgBnbWonIsPositive ? 'success' : 'failure'}>\n          {`${avgBnbWonIsPositive ? '+' : ''}${formatBnb(avgBnbWonPerRound)} BNB`}\n        </Text>\n        <Text small color=\"textSubtle\">\n          {`~$${avgBnbWonInUsd.toFixed(2)}`}\n        </Text>\n\n        {hasBestRound && (\n          <>\n            <Text mt=\"16px\" bold color=\"textSubtle\">\n              {t('Best round: #%roundId%', { roundId: summary.won.bestRound.id })}\n            </Text>\n            <Flex alignItems=\"flex-end\">\n              <Text bold color=\"success\">{`+${formatBnb(summary.won.bestRound.payout)} BNB`}</Text>\n              <Text ml=\"4px\" small color=\"textSubtle\">\n                ({summary.won.bestRound.multiplier.toFixed(2)}x)\n              </Text>\n            </Flex>\n            <Text small color=\"textSubtle\">\n              {`~$${betRoundInUsd.toFixed(2)}`}\n            </Text>\n          </>\n        )}\n\n        <Text mt=\"16px\" bold color=\"textSubtle\">\n          {t('Average position entered / round')}\n        </Text>\n        <Text bold>{`${formatBnb(avgPositionEntered)} BNB`}</Text>\n        <Text small color=\"textSubtle\">\n          {`~$${avgPositionEnteredInUsd.toFixed(2)}`}\n        </Text>\n\n        <Divider />\n\n        <SummaryRow type=\"won\" summary={summary} bnbBusdPrice={bnbBusdPrice} />\n        <SummaryRow type=\"lost\" summary={summary} bnbBusdPrice={bnbBusdPrice} />\n        <SummaryRow type=\"entered\" summary={summary} bnbBusdPrice={bnbBusdPrice} />\n\n        <Flex justifyContent=\"center\" mt=\"24px\">\n          <Link href={`${getBscScanLink(account, 'address')}#internaltx`} mb=\"16px\" external>\n            <Button mt=\"8px\" width=\"100%\">\n              {t('View Reclaimed & Won')}\n              <OpenNewIcon color=\"white\" ml=\"4px\" />\n            </Button>\n          </Link>\n        </Flex>\n      </Box>\n    </Box>\n  ) : (\n    <Box p=\"24px\">\n      <Heading size=\"lg\" textAlign=\"center\" mb=\"8px\">\n        {t('No prediction history available')}\n      </Heading>\n      <Text as=\"p\" textAlign=\"center\">\n        {t(\n          'If you are sure you should see history here, make sure you’re connected to the correct wallet and try again.',\n        )}\n      </Text>\n    </Box>\n  )\n}\n\nexport default PnlTab\n"]},"metadata":{},"sourceType":"module"}