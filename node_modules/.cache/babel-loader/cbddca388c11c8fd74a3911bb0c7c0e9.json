{"ast":null,"code":"import _toConsumableArray from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject;import React,{useCallback,useMemo,useState}from'react';import styled from'styled-components';import{splitSignature}from'@ethersproject/bytes';import{currencyEquals,ETHER,Percent,WETH}from'@pancakeswap/sdk';import{Button,Text,AddIcon,ArrowDownIcon,CardBody,Slider,Box,Flex,useModal}from'@pancakeswap/uikit';import{BigNumber}from'@ethersproject/bignumber';import{useTranslation}from'contexts/Localization';import{AutoColumn,ColumnCenter}from'../../components/Layout/Column';import TransactionConfirmationModal,{ConfirmationModalContent}from'../../components/TransactionConfirmationModal';import CurrencyInputPanel from'../../components/CurrencyInputPanel';import{MinimalPositionCard}from'../../components/PositionCard';import{AppHeader,AppBody}from'../../components/App';import{RowBetween,RowFixed}from'../../components/Layout/Row';import ConnectWalletButton from'../../components/ConnectWalletButton';import{LightGreyCard}from'../../components/Card';import{CurrencyLogo,DoubleCurrencyLogo}from'../../components/Logo';import{ROUTER_ADDRESS}from'../../config/constants';import useActiveWeb3React from'../../hooks/useActiveWeb3React';import{useCurrency}from'../../hooks/Tokens';import{usePairContract}from'../../hooks/useContract';import useTransactionDeadline from'../../hooks/useTransactionDeadline';import{useTransactionAdder}from'../../state/transactions/hooks';import StyledInternalLink from'../../components/Links';import{calculateGasMargin,calculateSlippageAmount,getRouterContract}from'../../utils';import{currencyId}from'../../utils/currencyId';import useDebouncedChangeHandler from'../../hooks/useDebouncedChangeHandler';import{wrappedCurrency}from'../../utils/wrappedCurrency';import{useApproveCallback,ApprovalState}from'../../hooks/useApproveCallback';import Dots from'../../components/Loader/Dots';import{useBurnActionHandlers,useDerivedBurnInfo,useBurnState}from'../../state/burn/hooks';import{Field}from'../../state/burn/actions';import{useGasPrice,useUserSlippageTolerance}from'../../state/user/hooks';import Page from'../Page';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var BorderCard=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  border: solid 1px \",\";\\n  border-radius: 16px;\\n  padding: 16px;\\n\"])),function(_ref){var theme=_ref.theme;return theme.colors.cardBorder;});export default function RemoveLiquidity(_ref2){var _useCurrency,_useCurrency2,_parsedAmounts$Field$,_parsedAmounts$Field$2,_parsedAmounts$Field$3,_parsedAmounts$Field$4,_parsedAmounts$Field$5,_parsedAmounts$Field$6,_formattedAmounts,_parsedAmounts$Field$7,_pair$liquidityToken,_parsedAmounts$Field$11,_parsedAmounts$Field$12,_currencyA$symbol2,_parsedAmounts$Field$13,_parsedAmounts$Field$14,_currencyB$symbol2,_currencyA$symbol3,_currencyB$symbol3,_currencyA$symbol4,_currencyB$symbol4;var history=_ref2.history,_ref2$match$params=_ref2.match.params,currencyIdA=_ref2$match$params.currencyIdA,currencyIdB=_ref2$match$params.currencyIdB;var currencyA=(_useCurrency=useCurrency(currencyIdA))!==null&&_useCurrency!==void 0?_useCurrency:undefined,currencyB=(_useCurrency2=useCurrency(currencyIdB))!==null&&_useCurrency2!==void 0?_useCurrency2:undefined;var _useActiveWeb3React=useActiveWeb3React(),account=_useActiveWeb3React.account,chainId=_useActiveWeb3React.chainId,library=_useActiveWeb3React.library;var _useMemo=useMemo(function(){return[wrappedCurrency(currencyA,chainId),wrappedCurrency(currencyB,chainId)];},[currencyA,currencyB,chainId]),_useMemo2=_slicedToArray(_useMemo,2),tokenA=_useMemo2[0],tokenB=_useMemo2[1];var _useTranslation=useTranslation(),t=_useTranslation.t;var gasPrice=useGasPrice();// burn state\nvar _useBurnState=useBurnState(),independentField=_useBurnState.independentField,typedValue=_useBurnState.typedValue;var _useDerivedBurnInfo=useDerivedBurnInfo(currencyA!==null&&currencyA!==void 0?currencyA:undefined,currencyB!==null&&currencyB!==void 0?currencyB:undefined),pair=_useDerivedBurnInfo.pair,parsedAmounts=_useDerivedBurnInfo.parsedAmounts,error=_useDerivedBurnInfo.error;var _useBurnActionHandler=useBurnActionHandlers(),_onUserInput=_useBurnActionHandler.onUserInput;var isValid=!error;// modal and loading\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),showDetailed=_useState2[0],setShowDetailed=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),attemptingTxn=_useState4[0],setAttemptingTxn=_useState4[1];// clicked confirm\n// txn values\nvar _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),txHash=_useState6[0],setTxHash=_useState6[1];var deadline=useTransactionDeadline();var _useUserSlippageToler=useUserSlippageTolerance(),_useUserSlippageToler2=_slicedToArray(_useUserSlippageToler,1),allowedSlippage=_useUserSlippageToler2[0];var formattedAmounts=(_formattedAmounts={},_defineProperty(_formattedAmounts,Field.LIQUIDITY_PERCENT,parsedAmounts[Field.LIQUIDITY_PERCENT].equalTo('0')?'0':parsedAmounts[Field.LIQUIDITY_PERCENT].lessThan(new Percent('1','100'))?'<1':parsedAmounts[Field.LIQUIDITY_PERCENT].toFixed(0)),_defineProperty(_formattedAmounts,Field.LIQUIDITY,independentField===Field.LIQUIDITY?typedValue:(_parsedAmounts$Field$=(_parsedAmounts$Field$2=parsedAmounts[Field.LIQUIDITY])===null||_parsedAmounts$Field$2===void 0?void 0:_parsedAmounts$Field$2.toSignificant(6))!==null&&_parsedAmounts$Field$!==void 0?_parsedAmounts$Field$:''),_defineProperty(_formattedAmounts,Field.CURRENCY_A,independentField===Field.CURRENCY_A?typedValue:(_parsedAmounts$Field$3=(_parsedAmounts$Field$4=parsedAmounts[Field.CURRENCY_A])===null||_parsedAmounts$Field$4===void 0?void 0:_parsedAmounts$Field$4.toSignificant(6))!==null&&_parsedAmounts$Field$3!==void 0?_parsedAmounts$Field$3:''),_defineProperty(_formattedAmounts,Field.CURRENCY_B,independentField===Field.CURRENCY_B?typedValue:(_parsedAmounts$Field$5=(_parsedAmounts$Field$6=parsedAmounts[Field.CURRENCY_B])===null||_parsedAmounts$Field$6===void 0?void 0:_parsedAmounts$Field$6.toSignificant(6))!==null&&_parsedAmounts$Field$5!==void 0?_parsedAmounts$Field$5:''),_formattedAmounts);var atMaxAmount=(_parsedAmounts$Field$7=parsedAmounts[Field.LIQUIDITY_PERCENT])===null||_parsedAmounts$Field$7===void 0?void 0:_parsedAmounts$Field$7.equalTo(new Percent('1'));// pair contract\nvar pairContract=usePairContract(pair===null||pair===void 0?void 0:(_pair$liquidityToken=pair.liquidityToken)===null||_pair$liquidityToken===void 0?void 0:_pair$liquidityToken.address);// allowance handling\nvar _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),signatureData=_useState8[0],setSignatureData=_useState8[1];var _useApproveCallback=useApproveCallback(parsedAmounts[Field.LIQUIDITY],ROUTER_ADDRESS),_useApproveCallback2=_slicedToArray(_useApproveCallback,2),approval=_useApproveCallback2[0],approveCallback=_useApproveCallback2[1];function onAttemptToApprove(){return _onAttemptToApprove.apply(this,arguments);}// wrapped onUserInput to clear signatures\nfunction _onAttemptToApprove(){_onAttemptToApprove=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var liquidityAmount,nonce,EIP712Domain,domain,Permit,message,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(!pairContract||!pair||!library||!deadline)){_context.next=2;break;}throw new Error('missing dependencies');case 2:liquidityAmount=parsedAmounts[Field.LIQUIDITY];if(liquidityAmount){_context.next=5;break;}throw new Error('missing liquidity amount');case 5:_context.next=7;return pairContract.nonces(account);case 7:nonce=_context.sent;EIP712Domain=[{name:'name',type:'string'},{name:'version',type:'string'},{name:'chainId',type:'uint256'},{name:'verifyingContract',type:'address'}];domain={name:'Pancake LPs',version:'1',chainId:chainId,verifyingContract:pair.liquidityToken.address};Permit=[{name:'owner',type:'address'},{name:'spender',type:'address'},{name:'value',type:'uint256'},{name:'nonce',type:'uint256'},{name:'deadline',type:'uint256'}];message={owner:account,spender:ROUTER_ADDRESS,value:liquidityAmount.raw.toString(),nonce:nonce.toHexString(),deadline:deadline.toNumber()};data=JSON.stringify({types:{EIP712Domain:EIP712Domain,Permit:Permit},domain:domain,primaryType:'Permit',message:message});library.send('eth_signTypedData_v4',[account,data]).then(splitSignature).then(function(signature){setSignatureData({v:signature.v,r:signature.r,s:signature.s,deadline:deadline.toNumber()});}).catch(function(err){// for all errors other than 4001 (EIP-1193 user rejected request), fall back to manual approve\nif((err===null||err===void 0?void 0:err.code)!==4001){approveCallback();}});case 14:case\"end\":return _context.stop();}}},_callee);}));return _onAttemptToApprove.apply(this,arguments);}var onUserInput=useCallback(function(field,value){setSignatureData(null);return _onUserInput(field,value);},[_onUserInput]);var onLiquidityInput=useCallback(function(value){return onUserInput(Field.LIQUIDITY,value);},[onUserInput]);var onCurrencyAInput=useCallback(function(value){return onUserInput(Field.CURRENCY_A,value);},[onUserInput]);var onCurrencyBInput=useCallback(function(value){return onUserInput(Field.CURRENCY_B,value);},[onUserInput]);// tx sending\nvar addTransaction=useTransactionAdder();function onRemove(){return _onRemove.apply(this,arguments);}function _onRemove(){_onRemove=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _amountsMin;var currencyAmountA,currencyAmountB,router,amountsMin,liquidityAmount,currencyBIsETH,oneCurrencyIsETH,methodNames,args,safeGasEstimates,indexOfSuccessfulEstimation,methodName,safeGasEstimate;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(!chainId||!library||!account||!deadline)){_context2.next=2;break;}throw new Error('missing dependencies');case 2:currencyAmountA=parsedAmounts[Field.CURRENCY_A],currencyAmountB=parsedAmounts[Field.CURRENCY_B];if(!(!currencyAmountA||!currencyAmountB)){_context2.next=5;break;}throw new Error('missing currency amounts');case 5:router=getRouterContract(chainId,library,account);amountsMin=(_amountsMin={},_defineProperty(_amountsMin,Field.CURRENCY_A,calculateSlippageAmount(currencyAmountA,allowedSlippage)[0]),_defineProperty(_amountsMin,Field.CURRENCY_B,calculateSlippageAmount(currencyAmountB,allowedSlippage)[0]),_amountsMin);if(!(!currencyA||!currencyB)){_context2.next=9;break;}throw new Error('missing tokens');case 9:liquidityAmount=parsedAmounts[Field.LIQUIDITY];if(liquidityAmount){_context2.next=12;break;}throw new Error('missing liquidity amount');case 12:currencyBIsETH=currencyB===ETHER;oneCurrencyIsETH=currencyA===ETHER||currencyBIsETH;if(!(!tokenA||!tokenB)){_context2.next=16;break;}throw new Error('could not wrap');case 16:if(!(approval===ApprovalState.APPROVED)){_context2.next=20;break;}// removeLiquidityETH\nif(oneCurrencyIsETH){methodNames=['removeLiquidityETH','removeLiquidityETHSupportingFeeOnTransferTokens'];args=[currencyBIsETH?tokenA.address:tokenB.address,liquidityAmount.raw.toString(),amountsMin[currencyBIsETH?Field.CURRENCY_A:Field.CURRENCY_B].toString(),amountsMin[currencyBIsETH?Field.CURRENCY_B:Field.CURRENCY_A].toString(),account,deadline.toHexString()];}// removeLiquidity\nelse{methodNames=['removeLiquidity'];args=[tokenA.address,tokenB.address,liquidityAmount.raw.toString(),amountsMin[Field.CURRENCY_A].toString(),amountsMin[Field.CURRENCY_B].toString(),account,deadline.toHexString()];}_context2.next=25;break;case 20:if(!(signatureData!==null)){_context2.next=24;break;}// removeLiquidityETHWithPermit\nif(oneCurrencyIsETH){methodNames=['removeLiquidityETHWithPermit','removeLiquidityETHWithPermitSupportingFeeOnTransferTokens'];args=[currencyBIsETH?tokenA.address:tokenB.address,liquidityAmount.raw.toString(),amountsMin[currencyBIsETH?Field.CURRENCY_A:Field.CURRENCY_B].toString(),amountsMin[currencyBIsETH?Field.CURRENCY_B:Field.CURRENCY_A].toString(),account,signatureData.deadline,false,signatureData.v,signatureData.r,signatureData.s];}// removeLiquidityETHWithPermit\nelse{methodNames=['removeLiquidityWithPermit'];args=[tokenA.address,tokenB.address,liquidityAmount.raw.toString(),amountsMin[Field.CURRENCY_A].toString(),amountsMin[Field.CURRENCY_B].toString(),account,signatureData.deadline,false,signatureData.v,signatureData.r,signatureData.s];}_context2.next=25;break;case 24:throw new Error('Attempting to confirm without approval or a signature. Please contact support.');case 25:_context2.next=27;return Promise.all(methodNames.map(function(methodName){var _router$estimateGas;return(_router$estimateGas=router.estimateGas)[methodName].apply(_router$estimateGas,_toConsumableArray(args)).then(calculateGasMargin).catch(function(err){console.error(\"estimateGas failed\",methodName,args,err);return undefined;});}));case 27:safeGasEstimates=_context2.sent;indexOfSuccessfulEstimation=safeGasEstimates.findIndex(function(safeGasEstimate){return BigNumber.isBigNumber(safeGasEstimate);});// all estimations failed...\nif(!(indexOfSuccessfulEstimation===-1)){_context2.next=33;break;}console.error('This transaction would fail. Please contact support.');_context2.next=38;break;case 33:methodName=methodNames[indexOfSuccessfulEstimation];safeGasEstimate=safeGasEstimates[indexOfSuccessfulEstimation];setAttemptingTxn(true);_context2.next=38;return router[methodName].apply(router,_toConsumableArray(args).concat([{gasLimit:safeGasEstimate,gasPrice:gasPrice}])).then(function(response){var _parsedAmounts$Field$15,_parsedAmounts$Field$16;setAttemptingTxn(false);addTransaction(response,{summary:\"Remove \".concat((_parsedAmounts$Field$15=parsedAmounts[Field.CURRENCY_A])===null||_parsedAmounts$Field$15===void 0?void 0:_parsedAmounts$Field$15.toSignificant(3),\" \").concat(currencyA===null||currencyA===void 0?void 0:currencyA.symbol,\" and \").concat((_parsedAmounts$Field$16=parsedAmounts[Field.CURRENCY_B])===null||_parsedAmounts$Field$16===void 0?void 0:_parsedAmounts$Field$16.toSignificant(3),\" \").concat(currencyB===null||currencyB===void 0?void 0:currencyB.symbol)});setTxHash(response.hash);}).catch(function(err){setAttemptingTxn(false);// we only care if the error is something _other_ than the user rejected the tx\n// we only care if the error is something _other_ than the user rejected the tx\nconsole.error(err);});case 38:case\"end\":return _context2.stop();}}},_callee2);}));return _onRemove.apply(this,arguments);}function modalHeader(){var _parsedAmounts$Field$8,_parsedAmounts$Field$9;return/*#__PURE__*/_jsxs(AutoColumn,{gap:\"md\",children:[/*#__PURE__*/_jsxs(RowBetween,{align:\"flex-end\",children:[/*#__PURE__*/_jsx(Text,{fontSize:\"24px\",children:(_parsedAmounts$Field$8=parsedAmounts[Field.CURRENCY_A])===null||_parsedAmounts$Field$8===void 0?void 0:_parsedAmounts$Field$8.toSignificant(6)}),/*#__PURE__*/_jsxs(RowFixed,{gap:\"4px\",children:[/*#__PURE__*/_jsx(CurrencyLogo,{currency:currencyA,size:\"24px\"}),/*#__PURE__*/_jsx(Text,{fontSize:\"24px\",ml:\"10px\",children:currencyA===null||currencyA===void 0?void 0:currencyA.symbol})]})]}),/*#__PURE__*/_jsx(RowFixed,{children:/*#__PURE__*/_jsx(AddIcon,{width:\"16px\"})}),/*#__PURE__*/_jsxs(RowBetween,{align:\"flex-end\",children:[/*#__PURE__*/_jsx(Text,{fontSize:\"24px\",children:(_parsedAmounts$Field$9=parsedAmounts[Field.CURRENCY_B])===null||_parsedAmounts$Field$9===void 0?void 0:_parsedAmounts$Field$9.toSignificant(6)}),/*#__PURE__*/_jsxs(RowFixed,{gap:\"4px\",children:[/*#__PURE__*/_jsx(CurrencyLogo,{currency:currencyB,size:\"24px\"}),/*#__PURE__*/_jsx(Text,{fontSize:\"24px\",ml:\"10px\",children:currencyB===null||currencyB===void 0?void 0:currencyB.symbol})]})]}),/*#__PURE__*/_jsx(Text,{small:true,textAlign:\"left\",pt:\"12px\",children:t('Output is estimated. If the price changes by more than %slippage%% your transaction will revert.',{slippage:allowedSlippage/100})})]});}function modalBottom(){var _currencyA$symbol,_currencyB$symbol,_parsedAmounts$Field$10;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(Text,{children:t('%assetA%/%assetB% Burned',{assetA:(_currencyA$symbol=currencyA===null||currencyA===void 0?void 0:currencyA.symbol)!==null&&_currencyA$symbol!==void 0?_currencyA$symbol:'',assetB:(_currencyB$symbol=currencyB===null||currencyB===void 0?void 0:currencyB.symbol)!==null&&_currencyB$symbol!==void 0?_currencyB$symbol:''})}),/*#__PURE__*/_jsxs(RowFixed,{children:[/*#__PURE__*/_jsx(DoubleCurrencyLogo,{currency0:currencyA,currency1:currencyB,margin:true}),/*#__PURE__*/_jsx(Text,{children:(_parsedAmounts$Field$10=parsedAmounts[Field.LIQUIDITY])===null||_parsedAmounts$Field$10===void 0?void 0:_parsedAmounts$Field$10.toSignificant(6)})]})]}),pair&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(Text,{children:t('Price')}),/*#__PURE__*/_jsxs(Text,{children:[\"1 \",currencyA===null||currencyA===void 0?void 0:currencyA.symbol,\" = \",tokenA?pair.priceOf(tokenA).toSignificant(6):'-',\" \",currencyB===null||currencyB===void 0?void 0:currencyB.symbol]})]}),/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsxs(Text,{children:[\"1 \",currencyB===null||currencyB===void 0?void 0:currencyB.symbol,\" = \",tokenB?pair.priceOf(tokenB).toSignificant(6):'-',\" \",currencyA===null||currencyA===void 0?void 0:currencyA.symbol]})]})]}),/*#__PURE__*/_jsx(Button,{disabled:!(approval===ApprovalState.APPROVED||signatureData!==null),onClick:onRemove,children:t('Confirm')})]});}var pendingText=t('Removing %amountA% %symbolA% and %amountB% %symbolB%',{amountA:(_parsedAmounts$Field$11=(_parsedAmounts$Field$12=parsedAmounts[Field.CURRENCY_A])===null||_parsedAmounts$Field$12===void 0?void 0:_parsedAmounts$Field$12.toSignificant(6))!==null&&_parsedAmounts$Field$11!==void 0?_parsedAmounts$Field$11:'',symbolA:(_currencyA$symbol2=currencyA===null||currencyA===void 0?void 0:currencyA.symbol)!==null&&_currencyA$symbol2!==void 0?_currencyA$symbol2:'',amountB:(_parsedAmounts$Field$13=(_parsedAmounts$Field$14=parsedAmounts[Field.CURRENCY_B])===null||_parsedAmounts$Field$14===void 0?void 0:_parsedAmounts$Field$14.toSignificant(6))!==null&&_parsedAmounts$Field$13!==void 0?_parsedAmounts$Field$13:'',symbolB:(_currencyB$symbol2=currencyB===null||currencyB===void 0?void 0:currencyB.symbol)!==null&&_currencyB$symbol2!==void 0?_currencyB$symbol2:''});var liquidityPercentChangeCallback=useCallback(function(value){onUserInput(Field.LIQUIDITY_PERCENT,value.toString());},[onUserInput]);var oneCurrencyIsETH=currencyA===ETHER||currencyB===ETHER;var oneCurrencyIsWETH=Boolean(chainId&&(currencyA&&currencyEquals(WETH[chainId],currencyA)||currencyB&&currencyEquals(WETH[chainId],currencyB)));var handleSelectCurrencyA=useCallback(function(currency){if(currencyIdB&&currencyId(currency)===currencyIdB){history.push(\"/remove/\".concat(currencyId(currency),\"/\").concat(currencyIdA));}else{history.push(\"/remove/\".concat(currencyId(currency),\"/\").concat(currencyIdB));}},[currencyIdA,currencyIdB,history]);var handleSelectCurrencyB=useCallback(function(currency){if(currencyIdA&&currencyId(currency)===currencyIdA){history.push(\"/remove/\".concat(currencyIdB,\"/\").concat(currencyId(currency)));}else{history.push(\"/remove/\".concat(currencyIdA,\"/\").concat(currencyId(currency)));}},[currencyIdA,currencyIdB,history]);var handleDismissConfirmation=useCallback(function(){setSignatureData(null);// important that we clear signature data to avoid bad sigs\n// if there was a tx hash, we want to clear the input\nif(txHash){onUserInput(Field.LIQUIDITY_PERCENT,'0');}setTxHash('');},[onUserInput,txHash]);var _useDebouncedChangeHa=useDebouncedChangeHandler(Number.parseInt(parsedAmounts[Field.LIQUIDITY_PERCENT].toFixed(0)),liquidityPercentChangeCallback),_useDebouncedChangeHa2=_slicedToArray(_useDebouncedChangeHa,2),innerLiquidityPercentage=_useDebouncedChangeHa2[0],setInnerLiquidityPercentage=_useDebouncedChangeHa2[1];var _useModal=useModal(/*#__PURE__*/_jsx(TransactionConfirmationModal,{title:t('You will receive'),customOnDismiss:handleDismissConfirmation,attemptingTxn:attemptingTxn,hash:txHash||'',content:function content(){return/*#__PURE__*/_jsx(ConfirmationModalContent,{topContent:modalHeader,bottomContent:modalBottom});},pendingText:pendingText}),true,true,'removeLiquidityModal'),_useModal2=_slicedToArray(_useModal,1),onPresentRemoveLiquidity=_useModal2[0];return/*#__PURE__*/_jsxs(Page,{children:[/*#__PURE__*/_jsxs(AppBody,{children:[/*#__PURE__*/_jsx(AppHeader,{backTo:\"/pool\",title:t('Remove %assetA%-%assetB% liquidity',{assetA:(_currencyA$symbol3=currencyA===null||currencyA===void 0?void 0:currencyA.symbol)!==null&&_currencyA$symbol3!==void 0?_currencyA$symbol3:'',assetB:(_currencyB$symbol3=currencyB===null||currencyB===void 0?void 0:currencyB.symbol)!==null&&_currencyB$symbol3!==void 0?_currencyB$symbol3:''}),subtitle:t('To receive %assetA% and %assetB%',{assetA:(_currencyA$symbol4=currencyA===null||currencyA===void 0?void 0:currencyA.symbol)!==null&&_currencyA$symbol4!==void 0?_currencyA$symbol4:'',assetB:(_currencyB$symbol4=currencyB===null||currencyB===void 0?void 0:currencyB.symbol)!==null&&_currencyB$symbol4!==void 0?_currencyB$symbol4:''}),noConfig:true}),/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsxs(AutoColumn,{gap:\"20px\",children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(Text,{children:t('Amount')}),/*#__PURE__*/_jsx(Button,{variant:\"text\",scale:\"sm\",onClick:function onClick(){return setShowDetailed(!showDetailed);},children:showDetailed?t('Simple'):t('Detailed')})]}),!showDetailed&&/*#__PURE__*/_jsxs(BorderCard,{children:[/*#__PURE__*/_jsxs(Text,{fontSize:\"40px\",bold:true,mb:\"16px\",style:{lineHeight:1},children:[formattedAmounts[Field.LIQUIDITY_PERCENT],\"%\"]}),/*#__PURE__*/_jsx(Slider,{name:\"lp-amount\",min:0,max:100,value:innerLiquidityPercentage,onValueChanged:function onValueChanged(value){return setInnerLiquidityPercentage(Math.ceil(value));},mb:\"16px\"}),/*#__PURE__*/_jsxs(Flex,{flexWrap:\"wrap\",justifyContent:\"space-evenly\",children:[/*#__PURE__*/_jsx(Button,{variant:\"tertiary\",scale:\"sm\",onClick:function onClick(){return onUserInput(Field.LIQUIDITY_PERCENT,'25');},children:\"25%\"}),/*#__PURE__*/_jsx(Button,{variant:\"tertiary\",scale:\"sm\",onClick:function onClick(){return onUserInput(Field.LIQUIDITY_PERCENT,'50');},children:\"50%\"}),/*#__PURE__*/_jsx(Button,{variant:\"tertiary\",scale:\"sm\",onClick:function onClick(){return onUserInput(Field.LIQUIDITY_PERCENT,'75');},children:\"75%\"}),/*#__PURE__*/_jsx(Button,{variant:\"tertiary\",scale:\"sm\",onClick:function onClick(){return onUserInput(Field.LIQUIDITY_PERCENT,'100');},children:\"Max\"})]})]})]}),!showDetailed&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ColumnCenter,{children:/*#__PURE__*/_jsx(ArrowDownIcon,{color:\"textSubtle\",width:\"24px\",my:\"16px\"})}),/*#__PURE__*/_jsxs(AutoColumn,{gap:\"10px\",children:[/*#__PURE__*/_jsx(Text,{bold:true,color:\"secondary\",fontSize:\"12px\",textTransform:\"uppercase\",children:t('You will receive')}),/*#__PURE__*/_jsxs(LightGreyCard,{children:[/*#__PURE__*/_jsxs(Flex,{justifyContent:\"space-between\",mb:\"8px\",children:[/*#__PURE__*/_jsxs(Flex,{children:[/*#__PURE__*/_jsx(CurrencyLogo,{currency:currencyA}),/*#__PURE__*/_jsx(Text,{small:true,color:\"textSubtle\",id:\"remove-liquidity-tokena-symbol\",ml:\"4px\",children:currencyA===null||currencyA===void 0?void 0:currencyA.symbol})]}),/*#__PURE__*/_jsx(Text,{small:true,children:formattedAmounts[Field.CURRENCY_A]||'-'})]}),/*#__PURE__*/_jsxs(Flex,{justifyContent:\"space-between\",children:[/*#__PURE__*/_jsxs(Flex,{children:[/*#__PURE__*/_jsx(CurrencyLogo,{currency:currencyB}),/*#__PURE__*/_jsx(Text,{small:true,color:\"textSubtle\",id:\"remove-liquidity-tokenb-symbol\",ml:\"4px\",children:currencyB===null||currencyB===void 0?void 0:currencyB.symbol})]}),/*#__PURE__*/_jsx(Text,{small:true,children:formattedAmounts[Field.CURRENCY_B]||'-'})]}),chainId&&(oneCurrencyIsWETH||oneCurrencyIsETH)?/*#__PURE__*/_jsx(RowBetween,{style:{justifyContent:'flex-end',fontSize:'14px'},children:oneCurrencyIsETH?/*#__PURE__*/_jsx(StyledInternalLink,{to:\"/remove/\".concat(currencyA===ETHER?WETH[chainId].address:currencyIdA,\"/\").concat(currencyB===ETHER?WETH[chainId].address:currencyIdB),children:t('Receive WBNB')}):oneCurrencyIsWETH?/*#__PURE__*/_jsx(StyledInternalLink,{to:\"/remove/\".concat(currencyA&&currencyEquals(currencyA,WETH[chainId])?'BNB':currencyIdA,\"/\").concat(currencyB&&currencyEquals(currencyB,WETH[chainId])?'BNB':currencyIdB),children:t('Receive BNB')}):null}):null]})]})]}),showDetailed&&/*#__PURE__*/_jsxs(Box,{my:\"16px\",children:[/*#__PURE__*/_jsx(CurrencyInputPanel,{value:formattedAmounts[Field.LIQUIDITY],onUserInput:onLiquidityInput,onMax:function onMax(){onUserInput(Field.LIQUIDITY_PERCENT,'100');},showMaxButton:!atMaxAmount,disableCurrencySelect:true,currency:pair===null||pair===void 0?void 0:pair.liquidityToken,pair:pair,id:\"liquidity-amount\",onCurrencySelect:function onCurrencySelect(){return null;}}),/*#__PURE__*/_jsx(ColumnCenter,{children:/*#__PURE__*/_jsx(ArrowDownIcon,{width:\"24px\",my:\"16px\"})}),/*#__PURE__*/_jsx(CurrencyInputPanel,{hideBalance:true,value:formattedAmounts[Field.CURRENCY_A],onUserInput:onCurrencyAInput,onMax:function onMax(){return onUserInput(Field.LIQUIDITY_PERCENT,'100');},showMaxButton:!atMaxAmount,currency:currencyA,label:t('Output'),onCurrencySelect:handleSelectCurrencyA,id:\"remove-liquidity-tokena\"}),/*#__PURE__*/_jsx(ColumnCenter,{children:/*#__PURE__*/_jsx(AddIcon,{width:\"24px\",my:\"16px\"})}),/*#__PURE__*/_jsx(CurrencyInputPanel,{hideBalance:true,value:formattedAmounts[Field.CURRENCY_B],onUserInput:onCurrencyBInput,onMax:function onMax(){return onUserInput(Field.LIQUIDITY_PERCENT,'100');},showMaxButton:!atMaxAmount,currency:currencyB,label:t('Output'),onCurrencySelect:handleSelectCurrencyB,id:\"remove-liquidity-tokenb\"})]}),pair&&/*#__PURE__*/_jsxs(AutoColumn,{gap:\"10px\",style:{marginTop:'16px'},children:[/*#__PURE__*/_jsx(Text,{bold:true,color:\"secondary\",fontSize:\"12px\",textTransform:\"uppercase\",children:t('Prices')}),/*#__PURE__*/_jsxs(LightGreyCard,{children:[/*#__PURE__*/_jsxs(Flex,{justifyContent:\"space-between\",children:[/*#__PURE__*/_jsxs(Text,{small:true,color:\"textSubtle\",children:[\"1 \",currencyA===null||currencyA===void 0?void 0:currencyA.symbol,\" =\"]}),/*#__PURE__*/_jsxs(Text,{small:true,children:[tokenA?pair.priceOf(tokenA).toSignificant(6):'-',\" \",currencyB===null||currencyB===void 0?void 0:currencyB.symbol]})]}),/*#__PURE__*/_jsxs(Flex,{justifyContent:\"space-between\",children:[/*#__PURE__*/_jsxs(Text,{small:true,color:\"textSubtle\",children:[\"1 \",currencyB===null||currencyB===void 0?void 0:currencyB.symbol,\" =\"]}),/*#__PURE__*/_jsxs(Text,{small:true,children:[tokenB?pair.priceOf(tokenB).toSignificant(6):'-',\" \",currencyA===null||currencyA===void 0?void 0:currencyA.symbol]})]})]})]}),/*#__PURE__*/_jsx(Box,{position:\"relative\",mt:\"16px\",children:!account?/*#__PURE__*/_jsx(ConnectWalletButton,{}):/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(Button,{variant:approval===ApprovalState.APPROVED||signatureData!==null?'success':'primary',onClick:onAttemptToApprove,disabled:approval!==ApprovalState.NOT_APPROVED||signatureData!==null,width:\"100%\",mr:\"0.5rem\",children:approval===ApprovalState.PENDING?/*#__PURE__*/_jsx(Dots,{children:t('Enabling')}):approval===ApprovalState.APPROVED||signatureData!==null?t('Enabled'):t('Enable')}),/*#__PURE__*/_jsx(Button,{variant:!isValid&&!!parsedAmounts[Field.CURRENCY_A]&&!!parsedAmounts[Field.CURRENCY_B]?'danger':'primary',onClick:function onClick(){onPresentRemoveLiquidity();},width:\"100%\",disabled:!isValid||signatureData===null&&approval!==ApprovalState.APPROVED,children:error||t('Remove')})]})})]})]}),pair?/*#__PURE__*/_jsx(AutoColumn,{style:{minWidth:'20rem',width:'100%',maxWidth:'400px',marginTop:'1rem'},children:/*#__PURE__*/_jsx(MinimalPositionCard,{showUnwrapped:oneCurrencyIsWETH,pair:pair})}):null]});}","map":{"version":3,"sources":["/Volumes/evo970/lou/madDex-master/src/views/RemoveLiquidity/index.tsx"],"names":["React","useCallback","useMemo","useState","styled","splitSignature","currencyEquals","ETHER","Percent","WETH","Button","Text","AddIcon","ArrowDownIcon","CardBody","Slider","Box","Flex","useModal","BigNumber","useTranslation","AutoColumn","ColumnCenter","TransactionConfirmationModal","ConfirmationModalContent","CurrencyInputPanel","MinimalPositionCard","AppHeader","AppBody","RowBetween","RowFixed","ConnectWalletButton","LightGreyCard","CurrencyLogo","DoubleCurrencyLogo","ROUTER_ADDRESS","useActiveWeb3React","useCurrency","usePairContract","useTransactionDeadline","useTransactionAdder","StyledInternalLink","calculateGasMargin","calculateSlippageAmount","getRouterContract","currencyId","useDebouncedChangeHandler","wrappedCurrency","useApproveCallback","ApprovalState","Dots","useBurnActionHandlers","useDerivedBurnInfo","useBurnState","Field","useGasPrice","useUserSlippageTolerance","Page","BorderCard","div","theme","colors","cardBorder","RemoveLiquidity","history","match","params","currencyIdA","currencyIdB","currencyA","undefined","currencyB","account","chainId","library","tokenA","tokenB","t","gasPrice","independentField","typedValue","pair","parsedAmounts","error","_onUserInput","onUserInput","isValid","showDetailed","setShowDetailed","attemptingTxn","setAttemptingTxn","txHash","setTxHash","deadline","allowedSlippage","formattedAmounts","LIQUIDITY_PERCENT","equalTo","lessThan","toFixed","LIQUIDITY","toSignificant","CURRENCY_A","CURRENCY_B","atMaxAmount","pairContract","liquidityToken","address","signatureData","setSignatureData","approval","approveCallback","onAttemptToApprove","Error","liquidityAmount","nonces","nonce","EIP712Domain","name","type","domain","version","verifyingContract","Permit","message","owner","spender","value","raw","toString","toHexString","toNumber","data","JSON","stringify","types","primaryType","send","then","signature","v","r","s","catch","err","code","field","onLiquidityInput","onCurrencyAInput","onCurrencyBInput","addTransaction","onRemove","currencyAmountA","currencyAmountB","router","amountsMin","currencyBIsETH","oneCurrencyIsETH","APPROVED","methodNames","args","Promise","all","map","methodName","estimateGas","console","safeGasEstimates","indexOfSuccessfulEstimation","findIndex","safeGasEstimate","isBigNumber","gasLimit","response","summary","symbol","hash","modalHeader","slippage","modalBottom","assetA","assetB","priceOf","pendingText","amountA","symbolA","amountB","symbolB","liquidityPercentChangeCallback","oneCurrencyIsWETH","Boolean","handleSelectCurrencyA","currency","push","handleSelectCurrencyB","handleDismissConfirmation","Number","parseInt","innerLiquidityPercentage","setInnerLiquidityPercentage","onPresentRemoveLiquidity","lineHeight","Math","ceil","justifyContent","fontSize","marginTop","NOT_APPROVED","PENDING","minWidth","width","maxWidth"],"mappings":"27BAAA,MAAOA,CAAAA,KAAP,EAAgBC,WAAhB,CAA6BC,OAA7B,CAAsCC,QAAtC,KAAsD,OAAtD,CACA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CACA,OAASC,cAAT,KAA+B,sBAA/B,CAGA,OAAmBC,cAAnB,CAAmCC,KAAnC,CAA0CC,OAA1C,CAAmDC,IAAnD,KAA+D,kBAA/D,CACA,OAASC,MAAT,CAAiBC,IAAjB,CAAuBC,OAAvB,CAAgCC,aAAhC,CAA+CC,QAA/C,CAAyDC,MAAzD,CAAiEC,GAAjE,CAAsEC,IAAtE,CAA4EC,QAA5E,KAA4F,oBAA5F,CAEA,OAASC,SAAT,KAA0B,0BAA1B,CACA,OAASC,cAAT,KAA+B,uBAA/B,CACA,OAASC,UAAT,CAAqBC,YAArB,KAAyC,gCAAzC,CACA,MAAOC,CAAAA,4BAAP,EAAuCC,wBAAvC,KAAuE,+CAAvE,CACA,MAAOC,CAAAA,kBAAP,KAA+B,qCAA/B,CACA,OAASC,mBAAT,KAAoC,+BAApC,CACA,OAASC,SAAT,CAAoBC,OAApB,KAAmC,sBAAnC,CACA,OAASC,UAAT,CAAqBC,QAArB,KAAqC,6BAArC,CACA,MAAOC,CAAAA,mBAAP,KAAgC,sCAAhC,CACA,OAASC,aAAT,KAA8B,uBAA9B,CAEA,OAASC,YAAT,CAAuBC,kBAAvB,KAAiD,uBAAjD,CACA,OAASC,cAAT,KAA+B,wBAA/B,CACA,MAAOC,CAAAA,kBAAP,KAA+B,gCAA/B,CACA,OAASC,WAAT,KAA4B,oBAA5B,CACA,OAASC,eAAT,KAAgC,yBAAhC,CACA,MAAOC,CAAAA,sBAAP,KAAmC,oCAAnC,CAEA,OAASC,mBAAT,KAAoC,gCAApC,CACA,MAAOC,CAAAA,kBAAP,KAA+B,wBAA/B,CACA,OAASC,kBAAT,CAA6BC,uBAA7B,CAAsDC,iBAAtD,KAA+E,aAA/E,CACA,OAASC,UAAT,KAA2B,wBAA3B,CACA,MAAOC,CAAAA,yBAAP,KAAsC,uCAAtC,CACA,OAASC,eAAT,KAAgC,6BAAhC,CACA,OAASC,kBAAT,CAA6BC,aAA7B,KAAkD,gCAAlD,CACA,MAAOC,CAAAA,IAAP,KAAiB,8BAAjB,CACA,OAASC,qBAAT,CAAgCC,kBAAhC,CAAoDC,YAApD,KAAwE,wBAAxE,CAEA,OAASC,KAAT,KAAsB,0BAAtB,CACA,OAASC,WAAT,CAAsBC,wBAAtB,KAAsD,wBAAtD,CACA,MAAOC,CAAAA,IAAP,KAAiB,SAAjB,C,6IAEA,GAAMC,CAAAA,UAAU,CAAGtD,MAAM,CAACuD,GAAV,uIACM,kBAAGC,CAAAA,KAAH,MAAGA,KAAH,OAAeA,CAAAA,KAAK,CAACC,MAAN,CAAaC,UAA5B,EADN,CAAhB,CAMA,cAAe,SAASC,CAAAA,eAAT,OAKuD,4bAJpEC,CAAAA,OAIoE,OAJpEA,OAIoE,0BAHpEC,KAGoE,CAFlEC,MAEkE,CAFxDC,WAEwD,oBAFxDA,WAEwD,CAF3CC,WAE2C,oBAF3CA,WAE2C,CACpE,GAAOC,CAAAA,SAAP,eAAgChC,WAAW,CAAC8B,WAAD,CAA3C,6CAA4DG,SAA5D,CAAkBC,SAAlB,gBAAuElC,WAAW,CAAC+B,WAAD,CAAlF,+CAAmGE,SAAnG,CACA,wBAAsClC,kBAAkB,EAAxD,CAAQoC,OAAR,qBAAQA,OAAR,CAAiBC,OAAjB,qBAAiBA,OAAjB,CAA0BC,OAA1B,qBAA0BA,OAA1B,CACA,aAAyBxE,OAAO,CAC9B,iBAAM,CAAC6C,eAAe,CAACsB,SAAD,CAAYI,OAAZ,CAAhB,CAAsC1B,eAAe,CAACwB,SAAD,CAAYE,OAAZ,CAArD,CAAN,EAD8B,CAE9B,CAACJ,SAAD,CAAYE,SAAZ,CAAuBE,OAAvB,CAF8B,CAAhC,sCAAOE,MAAP,cAAeC,MAAf,cAKA,oBAAcxD,cAAc,EAA5B,CAAQyD,CAAR,iBAAQA,CAAR,CACA,GAAMC,CAAAA,QAAQ,CAAGvB,WAAW,EAA5B,CAEA;AACA,kBAAyCF,YAAY,EAArD,CAAQ0B,gBAAR,eAAQA,gBAAR,CAA0BC,UAA1B,eAA0BA,UAA1B,CACA,wBAAuC5B,kBAAkB,CAACiB,SAAD,SAACA,SAAD,UAACA,SAAD,CAAcC,SAAd,CAAyBC,SAAzB,SAAyBA,SAAzB,UAAyBA,SAAzB,CAAsCD,SAAtC,CAAzD,CAAQW,IAAR,qBAAQA,IAAR,CAAcC,aAAd,qBAAcA,aAAd,CAA6BC,KAA7B,qBAA6BA,KAA7B,CACA,0BAAsChC,qBAAqB,EAA3D,CAAqBiC,YAArB,uBAAQC,WAAR,CACA,GAAMC,CAAAA,OAAO,CAAG,CAACH,KAAjB,CAEA;AACA,cAAwChF,QAAQ,CAAU,KAAV,CAAhD,wCAAOoF,YAAP,eAAqBC,eAArB,eACA,eAA0CrF,QAAQ,CAAC,KAAD,CAAlD,yCAAOsF,aAAP,eAAsBC,gBAAtB,eAA0D;AAE1D;AACA,eAA4BvF,QAAQ,CAAS,EAAT,CAApC,yCAAOwF,MAAP,eAAeC,SAAf,eACA,GAAMC,CAAAA,QAAQ,CAAGtD,sBAAsB,EAAvC,CACA,0BAA0BiB,wBAAwB,EAAlD,gEAAOsC,eAAP,2BAEA,GAAMC,CAAAA,gBAAgB,yDACnBzC,KAAK,CAAC0C,iBADa,CACOd,aAAa,CAAC5B,KAAK,CAAC0C,iBAAP,CAAb,CAAuCC,OAAvC,CAA+C,GAA/C,EACvB,GADuB,CAEvBf,aAAa,CAAC5B,KAAK,CAAC0C,iBAAP,CAAb,CAAuCE,QAAvC,CAAgD,GAAI1F,CAAAA,OAAJ,CAAY,GAAZ,CAAiB,KAAjB,CAAhD,EACA,IADA,CAEA0E,aAAa,CAAC5B,KAAK,CAAC0C,iBAAP,CAAb,CAAuCG,OAAvC,CAA+C,CAA/C,CALgB,oCAMnB7C,KAAK,CAAC8C,SANa,CAOlBrB,gBAAgB,GAAKzB,KAAK,CAAC8C,SAA3B,CAAuCpB,UAAvC,gDAAoDE,aAAa,CAAC5B,KAAK,CAAC8C,SAAP,CAAjE,iDAAoD,uBAAgCC,aAAhC,CAA8C,CAA9C,CAApD,+DAAwG,EAPtF,oCAQnB/C,KAAK,CAACgD,UARa,CASlBvB,gBAAgB,GAAKzB,KAAK,CAACgD,UAA3B,CAAwCtB,UAAxC,iDAAqDE,aAAa,CAAC5B,KAAK,CAACgD,UAAP,CAAlE,iDAAqD,uBAAiCD,aAAjC,CAA+C,CAA/C,CAArD,iEAA0G,EATxF,oCAUnB/C,KAAK,CAACiD,UAVa,CAWlBxB,gBAAgB,GAAKzB,KAAK,CAACiD,UAA3B,CAAwCvB,UAAxC,iDAAqDE,aAAa,CAAC5B,KAAK,CAACiD,UAAP,CAAlE,iDAAqD,uBAAiCF,aAAjC,CAA+C,CAA/C,CAArD,iEAA0G,EAXxF,oBAAtB,CAcA,GAAMG,CAAAA,WAAW,yBAAGtB,aAAa,CAAC5B,KAAK,CAAC0C,iBAAP,CAAhB,iDAAG,uBAAwCC,OAAxC,CAAgD,GAAIzF,CAAAA,OAAJ,CAAY,GAAZ,CAAhD,CAApB,CAEA;AACA,GAAMiG,CAAAA,YAA6B,CAAGnE,eAAe,CAAC2C,IAAD,SAACA,IAAD,uCAACA,IAAI,CAAEyB,cAAP,+CAAC,qBAAsBC,OAAvB,CAArD,CAEA;AACA,eAA0CxG,QAAQ,CAA+D,IAA/D,CAAlD,yCAAOyG,aAAP,eAAsBC,gBAAtB,eACA,wBAAoC7D,kBAAkB,CAACkC,aAAa,CAAC5B,KAAK,CAAC8C,SAAP,CAAd,CAAiCjE,cAAjC,CAAtD,4DAAO2E,QAAP,yBAAiBC,eAAjB,yBA/CoE,QAiDrDC,CAAAA,kBAjDqD,qDAgHpE;AAhHoE,2GAiDpE,0MACM,CAACP,YAAD,EAAiB,CAACxB,IAAlB,EAA0B,CAACP,OAA3B,EAAsC,CAACmB,QAD7C,+BAC6D,IAAIoB,CAAAA,KAAJ,CAAU,sBAAV,CAD7D,QAEQC,eAFR,CAE0BhC,aAAa,CAAC5B,KAAK,CAAC8C,SAAP,CAFvC,IAGOc,eAHP,8BAG8B,IAAID,CAAAA,KAAJ,CAAU,0BAAV,CAH9B,8BAMsBR,CAAAA,YAAY,CAACU,MAAb,CAAoB3C,OAApB,CANtB,QAMQ4C,KANR,eAQQC,YARR,CAQuB,CACnB,CAAEC,IAAI,CAAE,MAAR,CAAgBC,IAAI,CAAE,QAAtB,CADmB,CAEnB,CAAED,IAAI,CAAE,SAAR,CAAmBC,IAAI,CAAE,QAAzB,CAFmB,CAGnB,CAAED,IAAI,CAAE,SAAR,CAAmBC,IAAI,CAAE,SAAzB,CAHmB,CAInB,CAAED,IAAI,CAAE,mBAAR,CAA6BC,IAAI,CAAE,SAAnC,CAJmB,CARvB,CAcQC,MAdR,CAciB,CACbF,IAAI,CAAE,aADO,CAEbG,OAAO,CAAE,GAFI,CAGbhD,OAAO,CAAPA,OAHa,CAIbiD,iBAAiB,CAAEzC,IAAI,CAACyB,cAAL,CAAoBC,OAJ1B,CAdjB,CAoBQgB,MApBR,CAoBiB,CACb,CAAEL,IAAI,CAAE,OAAR,CAAiBC,IAAI,CAAE,SAAvB,CADa,CAEb,CAAED,IAAI,CAAE,SAAR,CAAmBC,IAAI,CAAE,SAAzB,CAFa,CAGb,CAAED,IAAI,CAAE,OAAR,CAAiBC,IAAI,CAAE,SAAvB,CAHa,CAIb,CAAED,IAAI,CAAE,OAAR,CAAiBC,IAAI,CAAE,SAAvB,CAJa,CAKb,CAAED,IAAI,CAAE,UAAR,CAAoBC,IAAI,CAAE,SAA1B,CALa,CApBjB,CA2BQK,OA3BR,CA2BkB,CACdC,KAAK,CAAErD,OADO,CAEdsD,OAAO,CAAE3F,cAFK,CAGd4F,KAAK,CAAEb,eAAe,CAACc,GAAhB,CAAoBC,QAApB,EAHO,CAIdb,KAAK,CAAEA,KAAK,CAACc,WAAN,EAJO,CAKdrC,QAAQ,CAAEA,QAAQ,CAACsC,QAAT,EALI,CA3BlB,CAkCQC,IAlCR,CAkCeC,IAAI,CAACC,SAAL,CAAe,CAC1BC,KAAK,CAAE,CACLlB,YAAY,CAAZA,YADK,CAELM,MAAM,CAANA,MAFK,CADmB,CAK1BH,MAAM,CAANA,MAL0B,CAM1BgB,WAAW,CAAE,QANa,CAO1BZ,OAAO,CAAPA,OAP0B,CAAf,CAlCf,CA4CElD,OAAO,CACJ+D,IADH,CACQ,sBADR,CACgC,CAACjE,OAAD,CAAU4D,IAAV,CADhC,EAEGM,IAFH,CAEQrI,cAFR,EAGGqI,IAHH,CAGQ,SAACC,SAAD,CAAe,CACnB9B,gBAAgB,CAAC,CACf+B,CAAC,CAAED,SAAS,CAACC,CADE,CAEfC,CAAC,CAAEF,SAAS,CAACE,CAFE,CAGfC,CAAC,CAAEH,SAAS,CAACG,CAHE,CAIfjD,QAAQ,CAAEA,QAAQ,CAACsC,QAAT,EAJK,CAAD,CAAhB,CAMD,CAVH,EAWGY,KAXH,CAWS,SAACC,GAAD,CAAS,CACd;AACA,GAAI,CAAAA,GAAG,OAAH,EAAAA,GAAG,SAAH,QAAAA,GAAG,CAAEC,IAAL,IAAc,IAAlB,CAAwB,CACtBlC,eAAe,GAChB,CACF,CAhBH,EA5CF,uDAjDoE,qDAiHpE,GAAM1B,CAAAA,WAAW,CAAGpF,WAAW,CAC7B,SAACiJ,KAAD,CAAenB,KAAf,CAAiC,CAC/BlB,gBAAgB,CAAC,IAAD,CAAhB,CACA,MAAOzB,CAAAA,YAAY,CAAC8D,KAAD,CAAQnB,KAAR,CAAnB,CACD,CAJ4B,CAK7B,CAAC3C,YAAD,CAL6B,CAA/B,CAQA,GAAM+D,CAAAA,gBAAgB,CAAGlJ,WAAW,CAAC,SAAC8H,KAAD,QAAyB1C,CAAAA,WAAW,CAAC/B,KAAK,CAAC8C,SAAP,CAAkB2B,KAAlB,CAApC,EAAD,CAA+D,CAAC1C,WAAD,CAA/D,CAApC,CACA,GAAM+D,CAAAA,gBAAgB,CAAGnJ,WAAW,CAAC,SAAC8H,KAAD,QAAyB1C,CAAAA,WAAW,CAAC/B,KAAK,CAACgD,UAAP,CAAmByB,KAAnB,CAApC,EAAD,CAAgE,CAAC1C,WAAD,CAAhE,CAApC,CACA,GAAMgE,CAAAA,gBAAgB,CAAGpJ,WAAW,CAAC,SAAC8H,KAAD,QAAyB1C,CAAAA,WAAW,CAAC/B,KAAK,CAACiD,UAAP,CAAmBwB,KAAnB,CAApC,EAAD,CAAgE,CAAC1C,WAAD,CAAhE,CAApC,CAEA;AACA,GAAMiE,CAAAA,cAAc,CAAG9G,mBAAmB,EAA1C,CA9HoE,QA+HrD+G,CAAAA,QA/HqD,kIA+HpE,4VACM,CAAC9E,OAAD,EAAY,CAACC,OAAb,EAAwB,CAACF,OAAzB,EAAoC,CAACqB,QAD3C,gCAC2D,IAAIoB,CAAAA,KAAJ,CAAU,sBAAV,CAD3D,QAE8BuC,eAF9B,CAEuFtE,aAFvF,CAEW5B,KAAK,CAACgD,UAFjB,EAEmEmD,eAFnE,CAEuFvE,aAFvF,CAEgD5B,KAAK,CAACiD,UAFtD,OAGM,CAACiD,eAAD,EAAoB,CAACC,eAH3B,gCAIU,IAAIxC,CAAAA,KAAJ,CAAU,0BAAV,CAJV,QAMQyC,MANR,CAMiB9G,iBAAiB,CAAC6B,OAAD,CAAUC,OAAV,CAAmBF,OAAnB,CANlC,CAQQmF,UARR,6CASKrG,KAAK,CAACgD,UATX,CASwB3D,uBAAuB,CAAC6G,eAAD,CAAkB1D,eAAlB,CAAvB,CAA0D,CAA1D,CATxB,8BAUKxC,KAAK,CAACiD,UAVX,CAUwB5D,uBAAuB,CAAC8G,eAAD,CAAkB3D,eAAlB,CAAvB,CAA0D,CAA1D,CAVxB,oBAaM,CAACzB,SAAD,EAAc,CAACE,SAbrB,gCAasC,IAAI0C,CAAAA,KAAJ,CAAU,gBAAV,CAbtC,QAcQC,eAdR,CAc0BhC,aAAa,CAAC5B,KAAK,CAAC8C,SAAP,CAdvC,IAeOc,eAfP,gCAe8B,IAAID,CAAAA,KAAJ,CAAU,0BAAV,CAf9B,SAiBQ2C,cAjBR,CAiByBrF,SAAS,GAAKhE,KAjBvC,CAkBQsJ,gBAlBR,CAkB2BxF,SAAS,GAAK9D,KAAd,EAAuBqJ,cAlBlD,MAoBM,CAACjF,MAAD,EAAW,CAACC,MApBlB,iCAoBgC,IAAIqC,CAAAA,KAAJ,CAAU,gBAAV,CApBhC,cAyBMH,QAAQ,GAAK7D,aAAa,CAAC6G,QAzBjC,4BA0BI;AACA,GAAID,gBAAJ,CAAsB,CACpBE,WAAW,CAAG,CAAC,oBAAD,CAAuB,iDAAvB,CAAd,CACAC,IAAI,CAAG,CACLJ,cAAc,CAAGjF,MAAM,CAACgC,OAAV,CAAoB/B,MAAM,CAAC+B,OADpC,CAELO,eAAe,CAACc,GAAhB,CAAoBC,QAApB,EAFK,CAGL0B,UAAU,CAACC,cAAc,CAAGtG,KAAK,CAACgD,UAAT,CAAsBhD,KAAK,CAACiD,UAA3C,CAAV,CAAiE0B,QAAjE,EAHK,CAIL0B,UAAU,CAACC,cAAc,CAAGtG,KAAK,CAACiD,UAAT,CAAsBjD,KAAK,CAACgD,UAA3C,CAAV,CAAiE2B,QAAjE,EAJK,CAKLzD,OALK,CAMLqB,QAAQ,CAACqC,WAAT,EANK,CAAP,CAQD,CACD;AAXA,IAYK,CACH6B,WAAW,CAAG,CAAC,iBAAD,CAAd,CACAC,IAAI,CAAG,CACLrF,MAAM,CAACgC,OADF,CAEL/B,MAAM,CAAC+B,OAFF,CAGLO,eAAe,CAACc,GAAhB,CAAoBC,QAApB,EAHK,CAIL0B,UAAU,CAACrG,KAAK,CAACgD,UAAP,CAAV,CAA6B2B,QAA7B,EAJK,CAKL0B,UAAU,CAACrG,KAAK,CAACiD,UAAP,CAAV,CAA6B0B,QAA7B,EALK,CAMLzD,OANK,CAOLqB,QAAQ,CAACqC,WAAT,EAPK,CAAP,CASD,CAlDL,qCAqDWtB,aAAa,GAAK,IArD7B,4BAsDI;AACA,GAAIiD,gBAAJ,CAAsB,CACpBE,WAAW,CAAG,CAAC,8BAAD,CAAiC,2DAAjC,CAAd,CACAC,IAAI,CAAG,CACLJ,cAAc,CAAGjF,MAAM,CAACgC,OAAV,CAAoB/B,MAAM,CAAC+B,OADpC,CAELO,eAAe,CAACc,GAAhB,CAAoBC,QAApB,EAFK,CAGL0B,UAAU,CAACC,cAAc,CAAGtG,KAAK,CAACgD,UAAT,CAAsBhD,KAAK,CAACiD,UAA3C,CAAV,CAAiE0B,QAAjE,EAHK,CAIL0B,UAAU,CAACC,cAAc,CAAGtG,KAAK,CAACiD,UAAT,CAAsBjD,KAAK,CAACgD,UAA3C,CAAV,CAAiE2B,QAAjE,EAJK,CAKLzD,OALK,CAMLoC,aAAa,CAACf,QANT,CAOL,KAPK,CAQLe,aAAa,CAACgC,CART,CASLhC,aAAa,CAACiC,CATT,CAULjC,aAAa,CAACkC,CAVT,CAAP,CAYD,CACD;AAfA,IAgBK,CACHiB,WAAW,CAAG,CAAC,2BAAD,CAAd,CACAC,IAAI,CAAG,CACLrF,MAAM,CAACgC,OADF,CAEL/B,MAAM,CAAC+B,OAFF,CAGLO,eAAe,CAACc,GAAhB,CAAoBC,QAApB,EAHK,CAIL0B,UAAU,CAACrG,KAAK,CAACgD,UAAP,CAAV,CAA6B2B,QAA7B,EAJK,CAKL0B,UAAU,CAACrG,KAAK,CAACiD,UAAP,CAAV,CAA6B0B,QAA7B,EALK,CAMLzD,OANK,CAOLoC,aAAa,CAACf,QAPT,CAQL,KARK,CASLe,aAAa,CAACgC,CATT,CAULhC,aAAa,CAACiC,CAVT,CAWLjC,aAAa,CAACkC,CAXT,CAAP,CAaD,CAtFL,qCAwFU,IAAI7B,CAAAA,KAAJ,CAAU,gFAAV,CAxFV,iCA2F4DgD,CAAAA,OAAO,CAACC,GAAR,CACxDH,WAAW,CAACI,GAAZ,CAAgB,SAACC,UAAD,gCACd,qBAAAV,MAAM,CAACW,WAAP,EAAmBD,UAAnB,+CAAkCJ,IAAlC,GACGtB,IADH,CACQhG,kBADR,EAEGqG,KAFH,CAES,SAACC,GAAD,CAAS,CACdsB,OAAO,CAACnF,KAAR,sBAAoCiF,UAApC,CAAgDJ,IAAhD,CAAsDhB,GAAtD,EACA,MAAO1E,CAAAA,SAAP,CACD,CALH,CADc,EAAhB,CADwD,CA3F5D,SA2FQiG,gBA3FR,gBAsGQC,2BAtGR,CAsGsCD,gBAAgB,CAACE,SAAjB,CAA2B,SAACC,eAAD,QAC7DvJ,CAAAA,SAAS,CAACwJ,WAAV,CAAsBD,eAAtB,CAD6D,EAA3B,CAtGtC,CA0GE;AA1GF,KA2GMF,2BAA2B,GAAK,CAAC,CA3GvC,4BA4GIF,OAAO,CAACnF,KAAR,CAAc,sDAAd,EA5GJ,gCA8GUiF,UA9GV,CA8GuBL,WAAW,CAACS,2BAAD,CA9GlC,CA+GUE,eA/GV,CA+G4BH,gBAAgB,CAACC,2BAAD,CA/G5C,CAiHI9E,gBAAgB,CAAC,IAAD,CAAhB,CAjHJ,wBAkHUgE,CAAAA,MAAM,CAACU,UAAD,CAAN,OAAAV,MAAM,oBAAgBM,IAAhB,UAAsB,CAChCY,QAAQ,CAAEF,eADsB,CAEhC5F,QAAQ,CAARA,QAFgC,CAAtB,GAAN,CAIH4D,IAJG,CAIE,SAACmC,QAAD,CAAmC,qDACvCnF,gBAAgB,CAAC,KAAD,CAAhB,CAEA4D,cAAc,CAACuB,QAAD,CAAW,CACvBC,OAAO,2CAAY5F,aAAa,CAAC5B,KAAK,CAACgD,UAAP,CAAzB,kDAAY,wBAAiCD,aAAjC,CAA+C,CAA/C,CAAZ,aACLhC,SADK,SACLA,SADK,iBACLA,SAAS,CAAE0G,MADN,0CAEC7F,aAAa,CAAC5B,KAAK,CAACiD,UAAP,CAFd,kDAEC,wBAAiCF,aAAjC,CAA+C,CAA/C,CAFD,aAEsD9B,SAFtD,SAEsDA,SAFtD,iBAEsDA,SAAS,CAAEwG,MAFjE,CADgB,CAAX,CAAd,CAMAnF,SAAS,CAACiF,QAAQ,CAACG,IAAV,CAAT,CACD,CAdG,EAeHjC,KAfG,CAeG,SAACC,GAAD,CAAgB,CACrBtD,gBAAgB,CAAC,KAAD,CAAhB,CACA;AAAA;AACA4E,OAAO,CAACnF,KAAR,CAAc6D,GAAd,EACD,CAnBG,CAlHV,0DA/HoE,2CAwQpE,QAASiC,CAAAA,WAAT,EAAuB,mDACrB,mBACE,MAAC,UAAD,EAAY,GAAG,CAAC,IAAhB,wBACE,MAAC,UAAD,EAAY,KAAK,CAAC,UAAlB,wBACE,KAAC,IAAD,EAAM,QAAQ,CAAC,MAAf,kCAAuB/F,aAAa,CAAC5B,KAAK,CAACgD,UAAP,CAApC,iDAAuB,uBAAiCD,aAAjC,CAA+C,CAA/C,CAAvB,EADF,cAEE,MAAC,QAAD,EAAU,GAAG,CAAC,KAAd,wBACE,KAAC,YAAD,EAAc,QAAQ,CAAEhC,SAAxB,CAAmC,IAAI,CAAC,MAAxC,EADF,cAEE,KAAC,IAAD,EAAM,QAAQ,CAAC,MAAf,CAAsB,EAAE,CAAC,MAAzB,UACGA,SADH,SACGA,SADH,iBACGA,SAAS,CAAE0G,MADd,EAFF,GAFF,GADF,cAUE,KAAC,QAAD,wBACE,KAAC,OAAD,EAAS,KAAK,CAAC,MAAf,EADF,EAVF,cAaE,MAAC,UAAD,EAAY,KAAK,CAAC,UAAlB,wBACE,KAAC,IAAD,EAAM,QAAQ,CAAC,MAAf,kCAAuB7F,aAAa,CAAC5B,KAAK,CAACiD,UAAP,CAApC,iDAAuB,uBAAiCF,aAAjC,CAA+C,CAA/C,CAAvB,EADF,cAEE,MAAC,QAAD,EAAU,GAAG,CAAC,KAAd,wBACE,KAAC,YAAD,EAAc,QAAQ,CAAE9B,SAAxB,CAAmC,IAAI,CAAC,MAAxC,EADF,cAEE,KAAC,IAAD,EAAM,QAAQ,CAAC,MAAf,CAAsB,EAAE,CAAC,MAAzB,UACGA,SADH,SACGA,SADH,iBACGA,SAAS,CAAEwG,MADd,EAFF,GAFF,GAbF,cAuBE,KAAC,IAAD,EAAM,KAAK,KAAX,CAAY,SAAS,CAAC,MAAtB,CAA6B,EAAE,CAAC,MAAhC,UACGlG,CAAC,CAAC,kGAAD,CAAqG,CACrGqG,QAAQ,CAAEpF,eAAe,CAAG,GADyE,CAArG,CADJ,EAvBF,GADF,CA+BD,CAED,QAASqF,CAAAA,WAAT,EAAuB,iEACrB,mBACE,wCACE,MAAC,UAAD,yBACE,KAAC,IAAD,WACGtG,CAAC,CAAC,0BAAD,CAA6B,CAAEuG,MAAM,oBAAE/G,SAAF,SAAEA,SAAF,iBAAEA,SAAS,CAAE0G,MAAb,uDAAuB,EAA/B,CAAmCM,MAAM,oBAAE9G,SAAF,SAAEA,SAAF,iBAAEA,SAAS,CAAEwG,MAAb,uDAAuB,EAAhE,CAA7B,CADJ,EADF,cAIE,MAAC,QAAD,yBACE,KAAC,kBAAD,EAAoB,SAAS,CAAE1G,SAA/B,CAA0C,SAAS,CAAEE,SAArD,CAAgE,MAAM,KAAtE,EADF,cAEE,KAAC,IAAD,oCAAOW,aAAa,CAAC5B,KAAK,CAAC8C,SAAP,CAApB,kDAAO,wBAAgCC,aAAhC,CAA8C,CAA9C,CAAP,EAFF,GAJF,GADF,CAUGpB,IAAI,eACH,wCACE,MAAC,UAAD,yBACE,KAAC,IAAD,WAAOJ,CAAC,CAAC,OAAD,CAAR,EADF,cAEE,MAAC,IAAD,iBACKR,SADL,SACKA,SADL,iBACKA,SAAS,CAAE0G,MADhB,OAC2BpG,MAAM,CAAGM,IAAI,CAACqG,OAAL,CAAa3G,MAAb,EAAqB0B,aAArB,CAAmC,CAAnC,CAAH,CAA2C,GAD5E,KACkF9B,SADlF,SACkFA,SADlF,iBACkFA,SAAS,CAAEwG,MAD7F,GAFF,GADF,cAOE,MAAC,UAAD,yBACE,cADF,cAEE,MAAC,IAAD,iBACKxG,SADL,SACKA,SADL,iBACKA,SAAS,CAAEwG,MADhB,OAC2BnG,MAAM,CAAGK,IAAI,CAACqG,OAAL,CAAa1G,MAAb,EAAqByB,aAArB,CAAmC,CAAnC,CAAH,CAA2C,GAD5E,KACkFhC,SADlF,SACkFA,SADlF,iBACkFA,SAAS,CAAE0G,MAD7F,GAFF,GAPF,GAXJ,cA0BE,KAAC,MAAD,EAAQ,QAAQ,CAAE,EAAEjE,QAAQ,GAAK7D,aAAa,CAAC6G,QAA3B,EAAuClD,aAAa,GAAK,IAA3D,CAAlB,CAAoF,OAAO,CAAE2C,QAA7F,UACG1E,CAAC,CAAC,SAAD,CADJ,EA1BF,GADF,CAgCD,CAED,GAAM0G,CAAAA,WAAW,CAAG1G,CAAC,CAAC,sDAAD,CAAyD,CAC5E2G,OAAO,mDAAEtG,aAAa,CAAC5B,KAAK,CAACgD,UAAP,CAAf,kDAAE,wBAAiCD,aAAjC,CAA+C,CAA/C,CAAF,mEAAuD,EADc,CAE5EoF,OAAO,qBAAEpH,SAAF,SAAEA,SAAF,iBAAEA,SAAS,CAAE0G,MAAb,yDAAuB,EAF8C,CAG5EW,OAAO,mDAAExG,aAAa,CAAC5B,KAAK,CAACiD,UAAP,CAAf,kDAAE,wBAAiCF,aAAjC,CAA+C,CAA/C,CAAF,mEAAuD,EAHc,CAI5EsF,OAAO,qBAAEpH,SAAF,SAAEA,SAAF,iBAAEA,SAAS,CAAEwG,MAAb,yDAAuB,EAJ8C,CAAzD,CAArB,CAOA,GAAMa,CAAAA,8BAA8B,CAAG3L,WAAW,CAChD,SAAC8H,KAAD,CAAmB,CACjB1C,WAAW,CAAC/B,KAAK,CAAC0C,iBAAP,CAA0B+B,KAAK,CAACE,QAAN,EAA1B,CAAX,CACD,CAH+C,CAIhD,CAAC5C,WAAD,CAJgD,CAAlD,CAOA,GAAMwE,CAAAA,gBAAgB,CAAGxF,SAAS,GAAK9D,KAAd,EAAuBgE,SAAS,GAAKhE,KAA9D,CACA,GAAMsL,CAAAA,iBAAiB,CAAGC,OAAO,CAC/BrH,OAAO,GACHJ,SAAS,EAAI/D,cAAc,CAACG,IAAI,CAACgE,OAAD,CAAL,CAAgBJ,SAAhB,CAA5B,EACEE,SAAS,EAAIjE,cAAc,CAACG,IAAI,CAACgE,OAAD,CAAL,CAAgBF,SAAhB,CAFzB,CADwB,CAAjC,CAMA,GAAMwH,CAAAA,qBAAqB,CAAG9L,WAAW,CACvC,SAAC+L,QAAD,CAAwB,CACtB,GAAI5H,WAAW,EAAIvB,UAAU,CAACmJ,QAAD,CAAV,GAAyB5H,WAA5C,CAAyD,CACvDJ,OAAO,CAACiI,IAAR,mBAAwBpJ,UAAU,CAACmJ,QAAD,CAAlC,aAAgD7H,WAAhD,GACD,CAFD,IAEO,CACLH,OAAO,CAACiI,IAAR,mBAAwBpJ,UAAU,CAACmJ,QAAD,CAAlC,aAAgD5H,WAAhD,GACD,CACF,CAPsC,CAQvC,CAACD,WAAD,CAAcC,WAAd,CAA2BJ,OAA3B,CARuC,CAAzC,CAUA,GAAMkI,CAAAA,qBAAqB,CAAGjM,WAAW,CACvC,SAAC+L,QAAD,CAAwB,CACtB,GAAI7H,WAAW,EAAItB,UAAU,CAACmJ,QAAD,CAAV,GAAyB7H,WAA5C,CAAyD,CACvDH,OAAO,CAACiI,IAAR,mBAAwB7H,WAAxB,aAAuCvB,UAAU,CAACmJ,QAAD,CAAjD,GACD,CAFD,IAEO,CACLhI,OAAO,CAACiI,IAAR,mBAAwB9H,WAAxB,aAAuCtB,UAAU,CAACmJ,QAAD,CAAjD,GACD,CACF,CAPsC,CAQvC,CAAC7H,WAAD,CAAcC,WAAd,CAA2BJ,OAA3B,CARuC,CAAzC,CAWA,GAAMmI,CAAAA,yBAAyB,CAAGlM,WAAW,CAAC,UAAM,CAClD4G,gBAAgB,CAAC,IAAD,CAAhB,CAAuB;AACvB;AACA,GAAIlB,MAAJ,CAAY,CACVN,WAAW,CAAC/B,KAAK,CAAC0C,iBAAP,CAA0B,GAA1B,CAAX,CACD,CACDJ,SAAS,CAAC,EAAD,CAAT,CACD,CAP4C,CAO1C,CAACP,WAAD,CAAcM,MAAd,CAP0C,CAA7C,CASA,0BAAgE7C,yBAAyB,CACvFsJ,MAAM,CAACC,QAAP,CAAgBnH,aAAa,CAAC5B,KAAK,CAAC0C,iBAAP,CAAb,CAAuCG,OAAvC,CAA+C,CAA/C,CAAhB,CADuF,CAEvFyF,8BAFuF,CAAzF,gEAAOU,wBAAP,2BAAiCC,2BAAjC,2BAKA,cAAmCrL,QAAQ,cACzC,KAAC,4BAAD,EACE,KAAK,CAAE2D,CAAC,CAAC,kBAAD,CADV,CAEE,eAAe,CAAEsH,yBAFnB,CAGE,aAAa,CAAE1G,aAHjB,CAIE,IAAI,CAAEE,MAAM,EAAI,EAJlB,CAKE,OAAO,CAAE,sCAAM,KAAC,wBAAD,EAA0B,UAAU,CAAEsF,WAAtC,CAAmD,aAAa,CAAEE,WAAlE,EAAN,EALX,CAME,WAAW,CAAEI,WANf,EADyC,CASzC,IATyC,CAUzC,IAVyC,CAWzC,sBAXyC,CAA3C,wCAAOiB,wBAAP,eAcA,mBACE,MAAC,IAAD,yBACE,MAAC,OAAD,yBACE,KAAC,SAAD,EACE,MAAM,CAAC,OADT,CAEE,KAAK,CAAE3H,CAAC,CAAC,oCAAD,CAAuC,CAC7CuG,MAAM,qBAAE/G,SAAF,SAAEA,SAAF,iBAAEA,SAAS,CAAE0G,MAAb,yDAAuB,EADgB,CAE7CM,MAAM,qBAAE9G,SAAF,SAAEA,SAAF,iBAAEA,SAAS,CAAEwG,MAAb,yDAAuB,EAFgB,CAAvC,CAFV,CAME,QAAQ,CAAElG,CAAC,CAAC,kCAAD,CAAqC,CAC9CuG,MAAM,qBAAE/G,SAAF,SAAEA,SAAF,iBAAEA,SAAS,CAAE0G,MAAb,yDAAuB,EADiB,CAE9CM,MAAM,qBAAE9G,SAAF,SAAEA,SAAF,iBAAEA,SAAS,CAAEwG,MAAb,yDAAuB,EAFiB,CAArC,CANb,CAUE,QAAQ,KAVV,EADF,cAcE,MAAC,QAAD,yBACE,MAAC,UAAD,EAAY,GAAG,CAAC,MAAhB,wBACE,MAAC,UAAD,yBACE,KAAC,IAAD,WAAOlG,CAAC,CAAC,QAAD,CAAR,EADF,cAEE,KAAC,MAAD,EAAQ,OAAO,CAAC,MAAhB,CAAuB,KAAK,CAAC,IAA7B,CAAkC,OAAO,CAAE,yBAAMW,CAAAA,eAAe,CAAC,CAACD,YAAF,CAArB,EAA3C,UACGA,YAAY,CAAGV,CAAC,CAAC,QAAD,CAAJ,CAAiBA,CAAC,CAAC,UAAD,CADjC,EAFF,GADF,CAOG,CAACU,YAAD,eACC,MAAC,UAAD,yBACE,MAAC,IAAD,EAAM,QAAQ,CAAC,MAAf,CAAsB,IAAI,KAA1B,CAA2B,EAAE,CAAC,MAA9B,CAAqC,KAAK,CAAE,CAAEkH,UAAU,CAAE,CAAd,CAA5C,WACG1G,gBAAgB,CAACzC,KAAK,CAAC0C,iBAAP,CADnB,OADF,cAIE,KAAC,MAAD,EACE,IAAI,CAAC,WADP,CAEE,GAAG,CAAE,CAFP,CAGE,GAAG,CAAE,GAHP,CAIE,KAAK,CAAEsG,wBAJT,CAKE,cAAc,CAAE,wBAACvE,KAAD,QAAWwE,CAAAA,2BAA2B,CAACG,IAAI,CAACC,IAAL,CAAU5E,KAAV,CAAD,CAAtC,EALlB,CAME,EAAE,CAAC,MANL,EAJF,cAYE,MAAC,IAAD,EAAM,QAAQ,CAAC,MAAf,CAAsB,cAAc,CAAC,cAArC,wBACE,KAAC,MAAD,EAAQ,OAAO,CAAC,UAAhB,CAA2B,KAAK,CAAC,IAAjC,CAAsC,OAAO,CAAE,yBAAM1C,CAAAA,WAAW,CAAC/B,KAAK,CAAC0C,iBAAP,CAA0B,IAA1B,CAAjB,EAA/C,iBADF,cAIE,KAAC,MAAD,EAAQ,OAAO,CAAC,UAAhB,CAA2B,KAAK,CAAC,IAAjC,CAAsC,OAAO,CAAE,yBAAMX,CAAAA,WAAW,CAAC/B,KAAK,CAAC0C,iBAAP,CAA0B,IAA1B,CAAjB,EAA/C,iBAJF,cAOE,KAAC,MAAD,EAAQ,OAAO,CAAC,UAAhB,CAA2B,KAAK,CAAC,IAAjC,CAAsC,OAAO,CAAE,yBAAMX,CAAAA,WAAW,CAAC/B,KAAK,CAAC0C,iBAAP,CAA0B,IAA1B,CAAjB,EAA/C,iBAPF,cAUE,KAAC,MAAD,EAAQ,OAAO,CAAC,UAAhB,CAA2B,KAAK,CAAC,IAAjC,CAAsC,OAAO,CAAE,yBAAMX,CAAAA,WAAW,CAAC/B,KAAK,CAAC0C,iBAAP,CAA0B,KAA1B,CAAjB,EAA/C,iBAVF,GAZF,GARJ,GADF,CAsCG,CAACT,YAAD,eACC,wCACE,KAAC,YAAD,wBACE,KAAC,aAAD,EAAe,KAAK,CAAC,YAArB,CAAkC,KAAK,CAAC,MAAxC,CAA+C,EAAE,CAAC,MAAlD,EADF,EADF,cAIE,MAAC,UAAD,EAAY,GAAG,CAAC,MAAhB,wBACE,KAAC,IAAD,EAAM,IAAI,KAAV,CAAW,KAAK,CAAC,WAAjB,CAA6B,QAAQ,CAAC,MAAtC,CAA6C,aAAa,CAAC,WAA3D,UACGV,CAAC,CAAC,kBAAD,CADJ,EADF,cAIE,MAAC,aAAD,yBACE,MAAC,IAAD,EAAM,cAAc,CAAC,eAArB,CAAqC,EAAE,CAAC,KAAxC,wBACE,MAAC,IAAD,yBACE,KAAC,YAAD,EAAc,QAAQ,CAAER,SAAxB,EADF,cAEE,KAAC,IAAD,EAAM,KAAK,KAAX,CAAY,KAAK,CAAC,YAAlB,CAA+B,EAAE,CAAC,gCAAlC,CAAmE,EAAE,CAAC,KAAtE,UACGA,SADH,SACGA,SADH,iBACGA,SAAS,CAAE0G,MADd,EAFF,GADF,cAOE,KAAC,IAAD,EAAM,KAAK,KAAX,UAAahF,gBAAgB,CAACzC,KAAK,CAACgD,UAAP,CAAhB,EAAsC,GAAnD,EAPF,GADF,cAUE,MAAC,IAAD,EAAM,cAAc,CAAC,eAArB,wBACE,MAAC,IAAD,yBACE,KAAC,YAAD,EAAc,QAAQ,CAAE/B,SAAxB,EADF,cAEE,KAAC,IAAD,EAAM,KAAK,KAAX,CAAY,KAAK,CAAC,YAAlB,CAA+B,EAAE,CAAC,gCAAlC,CAAmE,EAAE,CAAC,KAAtE,UACGA,SADH,SACGA,SADH,iBACGA,SAAS,CAAEwG,MADd,EAFF,GADF,cAOE,KAAC,IAAD,EAAM,KAAK,KAAX,UAAahF,gBAAgB,CAACzC,KAAK,CAACiD,UAAP,CAAhB,EAAsC,GAAnD,EAPF,GAVF,CAmBG9B,OAAO,GAAKoH,iBAAiB,EAAIhC,gBAA1B,CAAP,cACC,KAAC,UAAD,EAAY,KAAK,CAAE,CAAE+C,cAAc,CAAE,UAAlB,CAA8BC,QAAQ,CAAE,MAAxC,CAAnB,UACGhD,gBAAgB,cACf,KAAC,kBAAD,EACE,EAAE,mBAAaxF,SAAS,GAAK9D,KAAd,CAAsBE,IAAI,CAACgE,OAAD,CAAJ,CAAckC,OAApC,CAA8CxC,WAA3D,aACAI,SAAS,GAAKhE,KAAd,CAAsBE,IAAI,CAACgE,OAAD,CAAJ,CAAckC,OAApC,CAA8CvC,WAD9C,CADJ,UAKGS,CAAC,CAAC,cAAD,CALJ,EADe,CAQbgH,iBAAiB,cACnB,KAAC,kBAAD,EACE,EAAE,mBAAaxH,SAAS,EAAI/D,cAAc,CAAC+D,SAAD,CAAY5D,IAAI,CAACgE,OAAD,CAAhB,CAA3B,CAAwD,KAAxD,CAAgEN,WAA7E,aACAI,SAAS,EAAIjE,cAAc,CAACiE,SAAD,CAAY9D,IAAI,CAACgE,OAAD,CAAhB,CAA3B,CAAwD,KAAxD,CAAgEL,WADhE,CADJ,UAKGS,CAAC,CAAC,aAAD,CALJ,EADmB,CAQjB,IAjBN,EADD,CAoBG,IAvCN,GAJF,GAJF,GAvCJ,CA4FGU,YAAY,eACX,MAAC,GAAD,EAAK,EAAE,CAAC,MAAR,wBACE,KAAC,kBAAD,EACE,KAAK,CAAEQ,gBAAgB,CAACzC,KAAK,CAAC8C,SAAP,CADzB,CAEE,WAAW,CAAE+C,gBAFf,CAGE,KAAK,CAAE,gBAAM,CACX9D,WAAW,CAAC/B,KAAK,CAAC0C,iBAAP,CAA0B,KAA1B,CAAX,CACD,CALH,CAME,aAAa,CAAE,CAACQ,WANlB,CAOE,qBAAqB,KAPvB,CAQE,QAAQ,CAAEvB,IAAF,SAAEA,IAAF,iBAAEA,IAAI,CAAEyB,cARlB,CASE,IAAI,CAAEzB,IATR,CAUE,EAAE,CAAC,kBAVL,CAWE,gBAAgB,CAAE,kCAAM,KAAN,EAXpB,EADF,cAcE,KAAC,YAAD,wBACE,KAAC,aAAD,EAAe,KAAK,CAAC,MAArB,CAA4B,EAAE,CAAC,MAA/B,EADF,EAdF,cAiBE,KAAC,kBAAD,EACE,WAAW,KADb,CAEE,KAAK,CAAEc,gBAAgB,CAACzC,KAAK,CAACgD,UAAP,CAFzB,CAGE,WAAW,CAAE8C,gBAHf,CAIE,KAAK,CAAE,uBAAM/D,CAAAA,WAAW,CAAC/B,KAAK,CAAC0C,iBAAP,CAA0B,KAA1B,CAAjB,EAJT,CAKE,aAAa,CAAE,CAACQ,WALlB,CAME,QAAQ,CAAEnC,SANZ,CAOE,KAAK,CAAEQ,CAAC,CAAC,QAAD,CAPV,CAQE,gBAAgB,CAAEkH,qBARpB,CASE,EAAE,CAAC,yBATL,EAjBF,cA4BE,KAAC,YAAD,wBACE,KAAC,OAAD,EAAS,KAAK,CAAC,MAAf,CAAsB,EAAE,CAAC,MAAzB,EADF,EA5BF,cA+BE,KAAC,kBAAD,EACE,WAAW,KADb,CAEE,KAAK,CAAEhG,gBAAgB,CAACzC,KAAK,CAACiD,UAAP,CAFzB,CAGE,WAAW,CAAE8C,gBAHf,CAIE,KAAK,CAAE,uBAAMhE,CAAAA,WAAW,CAAC/B,KAAK,CAAC0C,iBAAP,CAA0B,KAA1B,CAAjB,EAJT,CAKE,aAAa,CAAE,CAACQ,WALlB,CAME,QAAQ,CAAEjC,SANZ,CAOE,KAAK,CAAEM,CAAC,CAAC,QAAD,CAPV,CAQE,gBAAgB,CAAEqH,qBARpB,CASE,EAAE,CAAC,yBATL,EA/BF,GA7FJ,CAyIGjH,IAAI,eACH,MAAC,UAAD,EAAY,GAAG,CAAC,MAAhB,CAAuB,KAAK,CAAE,CAAE6H,SAAS,CAAE,MAAb,CAA9B,wBACE,KAAC,IAAD,EAAM,IAAI,KAAV,CAAW,KAAK,CAAC,WAAjB,CAA6B,QAAQ,CAAC,MAAtC,CAA6C,aAAa,CAAC,WAA3D,UACGjI,CAAC,CAAC,QAAD,CADJ,EADF,cAIE,MAAC,aAAD,yBACE,MAAC,IAAD,EAAM,cAAc,CAAC,eAArB,wBACE,MAAC,IAAD,EAAM,KAAK,KAAX,CAAY,KAAK,CAAC,YAAlB,gBACKR,SADL,SACKA,SADL,iBACKA,SAAS,CAAE0G,MADhB,QADF,cAIE,MAAC,IAAD,EAAM,KAAK,KAAX,WACGpG,MAAM,CAAGM,IAAI,CAACqG,OAAL,CAAa3G,MAAb,EAAqB0B,aAArB,CAAmC,CAAnC,CAAH,CAA2C,GADpD,KAC0D9B,SAD1D,SAC0DA,SAD1D,iBAC0DA,SAAS,CAAEwG,MADrE,GAJF,GADF,cASE,MAAC,IAAD,EAAM,cAAc,CAAC,eAArB,wBACE,MAAC,IAAD,EAAM,KAAK,KAAX,CAAY,KAAK,CAAC,YAAlB,gBACKxG,SADL,SACKA,SADL,iBACKA,SAAS,CAAEwG,MADhB,QADF,cAIE,MAAC,IAAD,EAAM,KAAK,KAAX,WACGnG,MAAM,CAAGK,IAAI,CAACqG,OAAL,CAAa1G,MAAb,EAAqByB,aAArB,CAAmC,CAAnC,CAAH,CAA2C,GADpD,KAC0DhC,SAD1D,SAC0DA,SAD1D,iBAC0DA,SAAS,CAAE0G,MADrE,GAJF,GATF,GAJF,GA1IJ,cAkKE,KAAC,GAAD,EAAK,QAAQ,CAAC,UAAd,CAAyB,EAAE,CAAC,MAA5B,UACG,CAACvG,OAAD,cACC,KAAC,mBAAD,IADD,cAGC,MAAC,UAAD,yBACE,KAAC,MAAD,EACE,OAAO,CAAEsC,QAAQ,GAAK7D,aAAa,CAAC6G,QAA3B,EAAuClD,aAAa,GAAK,IAAzD,CAAgE,SAAhE,CAA4E,SADvF,CAEE,OAAO,CAAEI,kBAFX,CAGE,QAAQ,CAAEF,QAAQ,GAAK7D,aAAa,CAAC8J,YAA3B,EAA2CnG,aAAa,GAAK,IAHzE,CAIE,KAAK,CAAC,MAJR,CAKE,EAAE,CAAC,QALL,UAOGE,QAAQ,GAAK7D,aAAa,CAAC+J,OAA3B,cACC,KAAC,IAAD,WAAOnI,CAAC,CAAC,UAAD,CAAR,EADD,CAEGiC,QAAQ,GAAK7D,aAAa,CAAC6G,QAA3B,EAAuClD,aAAa,GAAK,IAAzD,CACF/B,CAAC,CAAC,SAAD,CADC,CAGFA,CAAC,CAAC,QAAD,CAZL,EADF,cAgBE,KAAC,MAAD,EACE,OAAO,CACL,CAACS,OAAD,EAAY,CAAC,CAACJ,aAAa,CAAC5B,KAAK,CAACgD,UAAP,CAA3B,EAAiD,CAAC,CAACpB,aAAa,CAAC5B,KAAK,CAACiD,UAAP,CAAhE,CACI,QADJ,CAEI,SAJR,CAME,OAAO,CAAE,kBAAM,CACbiG,wBAAwB,GACzB,CARH,CASE,KAAK,CAAC,MATR,CAUE,QAAQ,CAAE,CAAClH,OAAD,EAAasB,aAAa,GAAK,IAAlB,EAA0BE,QAAQ,GAAK7D,aAAa,CAAC6G,QAV9E,UAYG3E,KAAK,EAAIN,CAAC,CAAC,QAAD,CAZb,EAhBF,GAJJ,EAlKF,GAdF,GADF,CAyNGI,IAAI,cACH,KAAC,UAAD,EAAY,KAAK,CAAE,CAAEgI,QAAQ,CAAE,OAAZ,CAAqBC,KAAK,CAAE,MAA5B,CAAoCC,QAAQ,CAAE,OAA9C,CAAuDL,SAAS,CAAE,MAAlE,CAAnB,uBACE,KAAC,mBAAD,EAAqB,aAAa,CAAEjB,iBAApC,CAAuD,IAAI,CAAE5G,IAA7D,EADF,EADG,CAID,IA7NN,GADF,CAiOD","sourcesContent":["import React, { useCallback, useMemo, useState } from 'react'\nimport styled from 'styled-components'\nimport { splitSignature } from '@ethersproject/bytes'\nimport { Contract } from '@ethersproject/contracts'\nimport { TransactionResponse } from '@ethersproject/providers'\nimport { Currency, currencyEquals, ETHER, Percent, WETH } from '@pancakeswap/sdk'\nimport { Button, Text, AddIcon, ArrowDownIcon, CardBody, Slider, Box, Flex, useModal } from '@pancakeswap/uikit'\nimport { RouteComponentProps } from 'react-router'\nimport { BigNumber } from '@ethersproject/bignumber'\nimport { useTranslation } from 'contexts/Localization'\nimport { AutoColumn, ColumnCenter } from '../../components/Layout/Column'\nimport TransactionConfirmationModal, { ConfirmationModalContent } from '../../components/TransactionConfirmationModal'\nimport CurrencyInputPanel from '../../components/CurrencyInputPanel'\nimport { MinimalPositionCard } from '../../components/PositionCard'\nimport { AppHeader, AppBody } from '../../components/App'\nimport { RowBetween, RowFixed } from '../../components/Layout/Row'\nimport ConnectWalletButton from '../../components/ConnectWalletButton'\nimport { LightGreyCard } from '../../components/Card'\n\nimport { CurrencyLogo, DoubleCurrencyLogo } from '../../components/Logo'\nimport { ROUTER_ADDRESS } from '../../config/constants'\nimport useActiveWeb3React from '../../hooks/useActiveWeb3React'\nimport { useCurrency } from '../../hooks/Tokens'\nimport { usePairContract } from '../../hooks/useContract'\nimport useTransactionDeadline from '../../hooks/useTransactionDeadline'\n\nimport { useTransactionAdder } from '../../state/transactions/hooks'\nimport StyledInternalLink from '../../components/Links'\nimport { calculateGasMargin, calculateSlippageAmount, getRouterContract } from '../../utils'\nimport { currencyId } from '../../utils/currencyId'\nimport useDebouncedChangeHandler from '../../hooks/useDebouncedChangeHandler'\nimport { wrappedCurrency } from '../../utils/wrappedCurrency'\nimport { useApproveCallback, ApprovalState } from '../../hooks/useApproveCallback'\nimport Dots from '../../components/Loader/Dots'\nimport { useBurnActionHandlers, useDerivedBurnInfo, useBurnState } from '../../state/burn/hooks'\n\nimport { Field } from '../../state/burn/actions'\nimport { useGasPrice, useUserSlippageTolerance } from '../../state/user/hooks'\nimport Page from '../Page'\n\nconst BorderCard = styled.div`\n  border: solid 1px ${({ theme }) => theme.colors.cardBorder};\n  border-radius: 16px;\n  padding: 16px;\n`\n\nexport default function RemoveLiquidity({\n  history,\n  match: {\n    params: { currencyIdA, currencyIdB },\n  },\n}: RouteComponentProps<{ currencyIdA: string; currencyIdB: string }>) {\n  const [currencyA, currencyB] = [useCurrency(currencyIdA) ?? undefined, useCurrency(currencyIdB) ?? undefined]\n  const { account, chainId, library } = useActiveWeb3React()\n  const [tokenA, tokenB] = useMemo(\n    () => [wrappedCurrency(currencyA, chainId), wrappedCurrency(currencyB, chainId)],\n    [currencyA, currencyB, chainId],\n  )\n\n  const { t } = useTranslation()\n  const gasPrice = useGasPrice()\n\n  // burn state\n  const { independentField, typedValue } = useBurnState()\n  const { pair, parsedAmounts, error } = useDerivedBurnInfo(currencyA ?? undefined, currencyB ?? undefined)\n  const { onUserInput: _onUserInput } = useBurnActionHandlers()\n  const isValid = !error\n\n  // modal and loading\n  const [showDetailed, setShowDetailed] = useState<boolean>(false)\n  const [attemptingTxn, setAttemptingTxn] = useState(false) // clicked confirm\n\n  // txn values\n  const [txHash, setTxHash] = useState<string>('')\n  const deadline = useTransactionDeadline()\n  const [allowedSlippage] = useUserSlippageTolerance()\n\n  const formattedAmounts = {\n    [Field.LIQUIDITY_PERCENT]: parsedAmounts[Field.LIQUIDITY_PERCENT].equalTo('0')\n      ? '0'\n      : parsedAmounts[Field.LIQUIDITY_PERCENT].lessThan(new Percent('1', '100'))\n      ? '<1'\n      : parsedAmounts[Field.LIQUIDITY_PERCENT].toFixed(0),\n    [Field.LIQUIDITY]:\n      independentField === Field.LIQUIDITY ? typedValue : parsedAmounts[Field.LIQUIDITY]?.toSignificant(6) ?? '',\n    [Field.CURRENCY_A]:\n      independentField === Field.CURRENCY_A ? typedValue : parsedAmounts[Field.CURRENCY_A]?.toSignificant(6) ?? '',\n    [Field.CURRENCY_B]:\n      independentField === Field.CURRENCY_B ? typedValue : parsedAmounts[Field.CURRENCY_B]?.toSignificant(6) ?? '',\n  }\n\n  const atMaxAmount = parsedAmounts[Field.LIQUIDITY_PERCENT]?.equalTo(new Percent('1'))\n\n  // pair contract\n  const pairContract: Contract | null = usePairContract(pair?.liquidityToken?.address)\n\n  // allowance handling\n  const [signatureData, setSignatureData] = useState<{ v: number; r: string; s: string; deadline: number } | null>(null)\n  const [approval, approveCallback] = useApproveCallback(parsedAmounts[Field.LIQUIDITY], ROUTER_ADDRESS)\n\n  async function onAttemptToApprove() {\n    if (!pairContract || !pair || !library || !deadline) throw new Error('missing dependencies')\n    const liquidityAmount = parsedAmounts[Field.LIQUIDITY]\n    if (!liquidityAmount) throw new Error('missing liquidity amount')\n\n    // try to gather a signature for permission\n    const nonce = await pairContract.nonces(account)\n\n    const EIP712Domain = [\n      { name: 'name', type: 'string' },\n      { name: 'version', type: 'string' },\n      { name: 'chainId', type: 'uint256' },\n      { name: 'verifyingContract', type: 'address' },\n    ]\n    const domain = {\n      name: 'Pancake LPs',\n      version: '1',\n      chainId,\n      verifyingContract: pair.liquidityToken.address,\n    }\n    const Permit = [\n      { name: 'owner', type: 'address' },\n      { name: 'spender', type: 'address' },\n      { name: 'value', type: 'uint256' },\n      { name: 'nonce', type: 'uint256' },\n      { name: 'deadline', type: 'uint256' },\n    ]\n    const message = {\n      owner: account,\n      spender: ROUTER_ADDRESS,\n      value: liquidityAmount.raw.toString(),\n      nonce: nonce.toHexString(),\n      deadline: deadline.toNumber(),\n    }\n    const data = JSON.stringify({\n      types: {\n        EIP712Domain,\n        Permit,\n      },\n      domain,\n      primaryType: 'Permit',\n      message,\n    })\n\n    library\n      .send('eth_signTypedData_v4', [account, data])\n      .then(splitSignature)\n      .then((signature) => {\n        setSignatureData({\n          v: signature.v,\n          r: signature.r,\n          s: signature.s,\n          deadline: deadline.toNumber(),\n        })\n      })\n      .catch((err) => {\n        // for all errors other than 4001 (EIP-1193 user rejected request), fall back to manual approve\n        if (err?.code !== 4001) {\n          approveCallback()\n        }\n      })\n  }\n\n  // wrapped onUserInput to clear signatures\n  const onUserInput = useCallback(\n    (field: Field, value: string) => {\n      setSignatureData(null)\n      return _onUserInput(field, value)\n    },\n    [_onUserInput],\n  )\n\n  const onLiquidityInput = useCallback((value: string): void => onUserInput(Field.LIQUIDITY, value), [onUserInput])\n  const onCurrencyAInput = useCallback((value: string): void => onUserInput(Field.CURRENCY_A, value), [onUserInput])\n  const onCurrencyBInput = useCallback((value: string): void => onUserInput(Field.CURRENCY_B, value), [onUserInput])\n\n  // tx sending\n  const addTransaction = useTransactionAdder()\n  async function onRemove() {\n    if (!chainId || !library || !account || !deadline) throw new Error('missing dependencies')\n    const { [Field.CURRENCY_A]: currencyAmountA, [Field.CURRENCY_B]: currencyAmountB } = parsedAmounts\n    if (!currencyAmountA || !currencyAmountB) {\n      throw new Error('missing currency amounts')\n    }\n    const router = getRouterContract(chainId, library, account)\n\n    const amountsMin = {\n      [Field.CURRENCY_A]: calculateSlippageAmount(currencyAmountA, allowedSlippage)[0],\n      [Field.CURRENCY_B]: calculateSlippageAmount(currencyAmountB, allowedSlippage)[0],\n    }\n\n    if (!currencyA || !currencyB) throw new Error('missing tokens')\n    const liquidityAmount = parsedAmounts[Field.LIQUIDITY]\n    if (!liquidityAmount) throw new Error('missing liquidity amount')\n\n    const currencyBIsETH = currencyB === ETHER\n    const oneCurrencyIsETH = currencyA === ETHER || currencyBIsETH\n\n    if (!tokenA || !tokenB) throw new Error('could not wrap')\n\n    let methodNames: string[]\n    let args: Array<string | string[] | number | boolean>\n    // we have approval, use normal remove liquidity\n    if (approval === ApprovalState.APPROVED) {\n      // removeLiquidityETH\n      if (oneCurrencyIsETH) {\n        methodNames = ['removeLiquidityETH', 'removeLiquidityETHSupportingFeeOnTransferTokens']\n        args = [\n          currencyBIsETH ? tokenA.address : tokenB.address,\n          liquidityAmount.raw.toString(),\n          amountsMin[currencyBIsETH ? Field.CURRENCY_A : Field.CURRENCY_B].toString(),\n          amountsMin[currencyBIsETH ? Field.CURRENCY_B : Field.CURRENCY_A].toString(),\n          account,\n          deadline.toHexString(),\n        ]\n      }\n      // removeLiquidity\n      else {\n        methodNames = ['removeLiquidity']\n        args = [\n          tokenA.address,\n          tokenB.address,\n          liquidityAmount.raw.toString(),\n          amountsMin[Field.CURRENCY_A].toString(),\n          amountsMin[Field.CURRENCY_B].toString(),\n          account,\n          deadline.toHexString(),\n        ]\n      }\n    }\n    // we have a signature, use permit versions of remove liquidity\n    else if (signatureData !== null) {\n      // removeLiquidityETHWithPermit\n      if (oneCurrencyIsETH) {\n        methodNames = ['removeLiquidityETHWithPermit', 'removeLiquidityETHWithPermitSupportingFeeOnTransferTokens']\n        args = [\n          currencyBIsETH ? tokenA.address : tokenB.address,\n          liquidityAmount.raw.toString(),\n          amountsMin[currencyBIsETH ? Field.CURRENCY_A : Field.CURRENCY_B].toString(),\n          amountsMin[currencyBIsETH ? Field.CURRENCY_B : Field.CURRENCY_A].toString(),\n          account,\n          signatureData.deadline,\n          false,\n          signatureData.v,\n          signatureData.r,\n          signatureData.s,\n        ]\n      }\n      // removeLiquidityETHWithPermit\n      else {\n        methodNames = ['removeLiquidityWithPermit']\n        args = [\n          tokenA.address,\n          tokenB.address,\n          liquidityAmount.raw.toString(),\n          amountsMin[Field.CURRENCY_A].toString(),\n          amountsMin[Field.CURRENCY_B].toString(),\n          account,\n          signatureData.deadline,\n          false,\n          signatureData.v,\n          signatureData.r,\n          signatureData.s,\n        ]\n      }\n    } else {\n      throw new Error('Attempting to confirm without approval or a signature. Please contact support.')\n    }\n\n    const safeGasEstimates: (BigNumber | undefined)[] = await Promise.all(\n      methodNames.map((methodName) =>\n        router.estimateGas[methodName](...args)\n          .then(calculateGasMargin)\n          .catch((err) => {\n            console.error(`estimateGas failed`, methodName, args, err)\n            return undefined\n          }),\n      ),\n    )\n\n    const indexOfSuccessfulEstimation = safeGasEstimates.findIndex((safeGasEstimate) =>\n      BigNumber.isBigNumber(safeGasEstimate),\n    )\n\n    // all estimations failed...\n    if (indexOfSuccessfulEstimation === -1) {\n      console.error('This transaction would fail. Please contact support.')\n    } else {\n      const methodName = methodNames[indexOfSuccessfulEstimation]\n      const safeGasEstimate = safeGasEstimates[indexOfSuccessfulEstimation]\n\n      setAttemptingTxn(true)\n      await router[methodName](...args, {\n        gasLimit: safeGasEstimate,\n        gasPrice,\n      })\n        .then((response: TransactionResponse) => {\n          setAttemptingTxn(false)\n\n          addTransaction(response, {\n            summary: `Remove ${parsedAmounts[Field.CURRENCY_A]?.toSignificant(3)} ${\n              currencyA?.symbol\n            } and ${parsedAmounts[Field.CURRENCY_B]?.toSignificant(3)} ${currencyB?.symbol}`,\n          })\n\n          setTxHash(response.hash)\n        })\n        .catch((err: Error) => {\n          setAttemptingTxn(false)\n          // we only care if the error is something _other_ than the user rejected the tx\n          console.error(err)\n        })\n    }\n  }\n\n  function modalHeader() {\n    return (\n      <AutoColumn gap=\"md\">\n        <RowBetween align=\"flex-end\">\n          <Text fontSize=\"24px\">{parsedAmounts[Field.CURRENCY_A]?.toSignificant(6)}</Text>\n          <RowFixed gap=\"4px\">\n            <CurrencyLogo currency={currencyA} size=\"24px\" />\n            <Text fontSize=\"24px\" ml=\"10px\">\n              {currencyA?.symbol}\n            </Text>\n          </RowFixed>\n        </RowBetween>\n        <RowFixed>\n          <AddIcon width=\"16px\" />\n        </RowFixed>\n        <RowBetween align=\"flex-end\">\n          <Text fontSize=\"24px\">{parsedAmounts[Field.CURRENCY_B]?.toSignificant(6)}</Text>\n          <RowFixed gap=\"4px\">\n            <CurrencyLogo currency={currencyB} size=\"24px\" />\n            <Text fontSize=\"24px\" ml=\"10px\">\n              {currencyB?.symbol}\n            </Text>\n          </RowFixed>\n        </RowBetween>\n\n        <Text small textAlign=\"left\" pt=\"12px\">\n          {t('Output is estimated. If the price changes by more than %slippage%% your transaction will revert.', {\n            slippage: allowedSlippage / 100,\n          })}\n        </Text>\n      </AutoColumn>\n    )\n  }\n\n  function modalBottom() {\n    return (\n      <>\n        <RowBetween>\n          <Text>\n            {t('%assetA%/%assetB% Burned', { assetA: currencyA?.symbol ?? '', assetB: currencyB?.symbol ?? '' })}\n          </Text>\n          <RowFixed>\n            <DoubleCurrencyLogo currency0={currencyA} currency1={currencyB} margin />\n            <Text>{parsedAmounts[Field.LIQUIDITY]?.toSignificant(6)}</Text>\n          </RowFixed>\n        </RowBetween>\n        {pair && (\n          <>\n            <RowBetween>\n              <Text>{t('Price')}</Text>\n              <Text>\n                1 {currencyA?.symbol} = {tokenA ? pair.priceOf(tokenA).toSignificant(6) : '-'} {currencyB?.symbol}\n              </Text>\n            </RowBetween>\n            <RowBetween>\n              <div />\n              <Text>\n                1 {currencyB?.symbol} = {tokenB ? pair.priceOf(tokenB).toSignificant(6) : '-'} {currencyA?.symbol}\n              </Text>\n            </RowBetween>\n          </>\n        )}\n        <Button disabled={!(approval === ApprovalState.APPROVED || signatureData !== null)} onClick={onRemove}>\n          {t('Confirm')}\n        </Button>\n      </>\n    )\n  }\n\n  const pendingText = t('Removing %amountA% %symbolA% and %amountB% %symbolB%', {\n    amountA: parsedAmounts[Field.CURRENCY_A]?.toSignificant(6) ?? '',\n    symbolA: currencyA?.symbol ?? '',\n    amountB: parsedAmounts[Field.CURRENCY_B]?.toSignificant(6) ?? '',\n    symbolB: currencyB?.symbol ?? '',\n  })\n\n  const liquidityPercentChangeCallback = useCallback(\n    (value: number) => {\n      onUserInput(Field.LIQUIDITY_PERCENT, value.toString())\n    },\n    [onUserInput],\n  )\n\n  const oneCurrencyIsETH = currencyA === ETHER || currencyB === ETHER\n  const oneCurrencyIsWETH = Boolean(\n    chainId &&\n      ((currencyA && currencyEquals(WETH[chainId], currencyA)) ||\n        (currencyB && currencyEquals(WETH[chainId], currencyB))),\n  )\n\n  const handleSelectCurrencyA = useCallback(\n    (currency: Currency) => {\n      if (currencyIdB && currencyId(currency) === currencyIdB) {\n        history.push(`/remove/${currencyId(currency)}/${currencyIdA}`)\n      } else {\n        history.push(`/remove/${currencyId(currency)}/${currencyIdB}`)\n      }\n    },\n    [currencyIdA, currencyIdB, history],\n  )\n  const handleSelectCurrencyB = useCallback(\n    (currency: Currency) => {\n      if (currencyIdA && currencyId(currency) === currencyIdA) {\n        history.push(`/remove/${currencyIdB}/${currencyId(currency)}`)\n      } else {\n        history.push(`/remove/${currencyIdA}/${currencyId(currency)}`)\n      }\n    },\n    [currencyIdA, currencyIdB, history],\n  )\n\n  const handleDismissConfirmation = useCallback(() => {\n    setSignatureData(null) // important that we clear signature data to avoid bad sigs\n    // if there was a tx hash, we want to clear the input\n    if (txHash) {\n      onUserInput(Field.LIQUIDITY_PERCENT, '0')\n    }\n    setTxHash('')\n  }, [onUserInput, txHash])\n\n  const [innerLiquidityPercentage, setInnerLiquidityPercentage] = useDebouncedChangeHandler(\n    Number.parseInt(parsedAmounts[Field.LIQUIDITY_PERCENT].toFixed(0)),\n    liquidityPercentChangeCallback,\n  )\n\n  const [onPresentRemoveLiquidity] = useModal(\n    <TransactionConfirmationModal\n      title={t('You will receive')}\n      customOnDismiss={handleDismissConfirmation}\n      attemptingTxn={attemptingTxn}\n      hash={txHash || ''}\n      content={() => <ConfirmationModalContent topContent={modalHeader} bottomContent={modalBottom} />}\n      pendingText={pendingText}\n    />,\n    true,\n    true,\n    'removeLiquidityModal',\n  )\n\n  return (\n    <Page>\n      <AppBody>\n        <AppHeader\n          backTo=\"/pool\"\n          title={t('Remove %assetA%-%assetB% liquidity', {\n            assetA: currencyA?.symbol ?? '',\n            assetB: currencyB?.symbol ?? '',\n          })}\n          subtitle={t('To receive %assetA% and %assetB%', {\n            assetA: currencyA?.symbol ?? '',\n            assetB: currencyB?.symbol ?? '',\n          })}\n          noConfig\n        />\n\n        <CardBody>\n          <AutoColumn gap=\"20px\">\n            <RowBetween>\n              <Text>{t('Amount')}</Text>\n              <Button variant=\"text\" scale=\"sm\" onClick={() => setShowDetailed(!showDetailed)}>\n                {showDetailed ? t('Simple') : t('Detailed')}\n              </Button>\n            </RowBetween>\n            {!showDetailed && (\n              <BorderCard>\n                <Text fontSize=\"40px\" bold mb=\"16px\" style={{ lineHeight: 1 }}>\n                  {formattedAmounts[Field.LIQUIDITY_PERCENT]}%\n                </Text>\n                <Slider\n                  name=\"lp-amount\"\n                  min={0}\n                  max={100}\n                  value={innerLiquidityPercentage}\n                  onValueChanged={(value) => setInnerLiquidityPercentage(Math.ceil(value))}\n                  mb=\"16px\"\n                />\n                <Flex flexWrap=\"wrap\" justifyContent=\"space-evenly\">\n                  <Button variant=\"tertiary\" scale=\"sm\" onClick={() => onUserInput(Field.LIQUIDITY_PERCENT, '25')}>\n                    25%\n                  </Button>\n                  <Button variant=\"tertiary\" scale=\"sm\" onClick={() => onUserInput(Field.LIQUIDITY_PERCENT, '50')}>\n                    50%\n                  </Button>\n                  <Button variant=\"tertiary\" scale=\"sm\" onClick={() => onUserInput(Field.LIQUIDITY_PERCENT, '75')}>\n                    75%\n                  </Button>\n                  <Button variant=\"tertiary\" scale=\"sm\" onClick={() => onUserInput(Field.LIQUIDITY_PERCENT, '100')}>\n                    Max\n                  </Button>\n                </Flex>\n              </BorderCard>\n            )}\n          </AutoColumn>\n          {!showDetailed && (\n            <>\n              <ColumnCenter>\n                <ArrowDownIcon color=\"textSubtle\" width=\"24px\" my=\"16px\" />\n              </ColumnCenter>\n              <AutoColumn gap=\"10px\">\n                <Text bold color=\"secondary\" fontSize=\"12px\" textTransform=\"uppercase\">\n                  {t('You will receive')}\n                </Text>\n                <LightGreyCard>\n                  <Flex justifyContent=\"space-between\" mb=\"8px\">\n                    <Flex>\n                      <CurrencyLogo currency={currencyA} />\n                      <Text small color=\"textSubtle\" id=\"remove-liquidity-tokena-symbol\" ml=\"4px\">\n                        {currencyA?.symbol}\n                      </Text>\n                    </Flex>\n                    <Text small>{formattedAmounts[Field.CURRENCY_A] || '-'}</Text>\n                  </Flex>\n                  <Flex justifyContent=\"space-between\">\n                    <Flex>\n                      <CurrencyLogo currency={currencyB} />\n                      <Text small color=\"textSubtle\" id=\"remove-liquidity-tokenb-symbol\" ml=\"4px\">\n                        {currencyB?.symbol}\n                      </Text>\n                    </Flex>\n                    <Text small>{formattedAmounts[Field.CURRENCY_B] || '-'}</Text>\n                  </Flex>\n                  {chainId && (oneCurrencyIsWETH || oneCurrencyIsETH) ? (\n                    <RowBetween style={{ justifyContent: 'flex-end', fontSize: '14px' }}>\n                      {oneCurrencyIsETH ? (\n                        <StyledInternalLink\n                          to={`/remove/${currencyA === ETHER ? WETH[chainId].address : currencyIdA}/${\n                            currencyB === ETHER ? WETH[chainId].address : currencyIdB\n                          }`}\n                        >\n                          {t('Receive WBNB')}\n                        </StyledInternalLink>\n                      ) : oneCurrencyIsWETH ? (\n                        <StyledInternalLink\n                          to={`/remove/${currencyA && currencyEquals(currencyA, WETH[chainId]) ? 'BNB' : currencyIdA}/${\n                            currencyB && currencyEquals(currencyB, WETH[chainId]) ? 'BNB' : currencyIdB\n                          }`}\n                        >\n                          {t('Receive BNB')}\n                        </StyledInternalLink>\n                      ) : null}\n                    </RowBetween>\n                  ) : null}\n                </LightGreyCard>\n              </AutoColumn>\n            </>\n          )}\n\n          {showDetailed && (\n            <Box my=\"16px\">\n              <CurrencyInputPanel\n                value={formattedAmounts[Field.LIQUIDITY]}\n                onUserInput={onLiquidityInput}\n                onMax={() => {\n                  onUserInput(Field.LIQUIDITY_PERCENT, '100')\n                }}\n                showMaxButton={!atMaxAmount}\n                disableCurrencySelect\n                currency={pair?.liquidityToken}\n                pair={pair}\n                id=\"liquidity-amount\"\n                onCurrencySelect={() => null}\n              />\n              <ColumnCenter>\n                <ArrowDownIcon width=\"24px\" my=\"16px\" />\n              </ColumnCenter>\n              <CurrencyInputPanel\n                hideBalance\n                value={formattedAmounts[Field.CURRENCY_A]}\n                onUserInput={onCurrencyAInput}\n                onMax={() => onUserInput(Field.LIQUIDITY_PERCENT, '100')}\n                showMaxButton={!atMaxAmount}\n                currency={currencyA}\n                label={t('Output')}\n                onCurrencySelect={handleSelectCurrencyA}\n                id=\"remove-liquidity-tokena\"\n              />\n              <ColumnCenter>\n                <AddIcon width=\"24px\" my=\"16px\" />\n              </ColumnCenter>\n              <CurrencyInputPanel\n                hideBalance\n                value={formattedAmounts[Field.CURRENCY_B]}\n                onUserInput={onCurrencyBInput}\n                onMax={() => onUserInput(Field.LIQUIDITY_PERCENT, '100')}\n                showMaxButton={!atMaxAmount}\n                currency={currencyB}\n                label={t('Output')}\n                onCurrencySelect={handleSelectCurrencyB}\n                id=\"remove-liquidity-tokenb\"\n              />\n            </Box>\n          )}\n          {pair && (\n            <AutoColumn gap=\"10px\" style={{ marginTop: '16px' }}>\n              <Text bold color=\"secondary\" fontSize=\"12px\" textTransform=\"uppercase\">\n                {t('Prices')}\n              </Text>\n              <LightGreyCard>\n                <Flex justifyContent=\"space-between\">\n                  <Text small color=\"textSubtle\">\n                    1 {currencyA?.symbol} =\n                  </Text>\n                  <Text small>\n                    {tokenA ? pair.priceOf(tokenA).toSignificant(6) : '-'} {currencyB?.symbol}\n                  </Text>\n                </Flex>\n                <Flex justifyContent=\"space-between\">\n                  <Text small color=\"textSubtle\">\n                    1 {currencyB?.symbol} =\n                  </Text>\n                  <Text small>\n                    {tokenB ? pair.priceOf(tokenB).toSignificant(6) : '-'} {currencyA?.symbol}\n                  </Text>\n                </Flex>\n              </LightGreyCard>\n            </AutoColumn>\n          )}\n          <Box position=\"relative\" mt=\"16px\">\n            {!account ? (\n              <ConnectWalletButton />\n            ) : (\n              <RowBetween>\n                <Button\n                  variant={approval === ApprovalState.APPROVED || signatureData !== null ? 'success' : 'primary'}\n                  onClick={onAttemptToApprove}\n                  disabled={approval !== ApprovalState.NOT_APPROVED || signatureData !== null}\n                  width=\"100%\"\n                  mr=\"0.5rem\"\n                >\n                  {approval === ApprovalState.PENDING ? (\n                    <Dots>{t('Enabling')}</Dots>\n                  ) : approval === ApprovalState.APPROVED || signatureData !== null ? (\n                    t('Enabled')\n                  ) : (\n                    t('Enable')\n                  )}\n                </Button>\n                <Button\n                  variant={\n                    !isValid && !!parsedAmounts[Field.CURRENCY_A] && !!parsedAmounts[Field.CURRENCY_B]\n                      ? 'danger'\n                      : 'primary'\n                  }\n                  onClick={() => {\n                    onPresentRemoveLiquidity()\n                  }}\n                  width=\"100%\"\n                  disabled={!isValid || (signatureData === null && approval !== ApprovalState.APPROVED)}\n                >\n                  {error || t('Remove')}\n                </Button>\n              </RowBetween>\n            )}\n          </Box>\n        </CardBody>\n      </AppBody>\n\n      {pair ? (\n        <AutoColumn style={{ minWidth: '20rem', width: '100%', maxWidth: '400px', marginTop: '1rem' }}>\n          <MinimalPositionCard showUnwrapped={oneCurrencyIsWETH} pair={pair} />\n        </AutoColumn>\n      ) : null}\n    </Page>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}