{"ast":null,"code":"import _defineProperty from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{JSBI,Percent,TokenAmount}from'@pancakeswap/sdk';import{useCallback}from'react';import{useDispatch,useSelector}from'react-redux';import useActiveWeb3React from'hooks/useActiveWeb3React';import{wrappedCurrency}from'utils/wrappedCurrency';import{usePair}from'hooks/usePairs';import useTotalSupply from'hooks/useTotalSupply';import{useTranslation}from'contexts/Localization';import{tryParseAmount}from'../swap/hooks';import{useTokenBalances}from'../wallet/hooks';import{Field,typeInput}from'./actions';export function useBurnState(){return useSelector(function(state){return state.burn;});}export function useDerivedBurnInfo(currencyA,currencyB){var _pair$liquidityToken$,_pair$liquidityToken,_tokens,_liquidityValues,_parsedAmounts;var _useActiveWeb3React=useActiveWeb3React(),account=_useActiveWeb3React.account,chainId=_useActiveWeb3React.chainId;var _useBurnState=useBurnState(),independentField=_useBurnState.independentField,typedValue=_useBurnState.typedValue;var _useTranslation=useTranslation(),t=_useTranslation.t;// pair + totalsupply\nvar _usePair=usePair(currencyA,currencyB),_usePair2=_slicedToArray(_usePair,2),pair=_usePair2[1];// balances\nvar relevantTokenBalances=useTokenBalances(account!==null&&account!==void 0?account:undefined,[pair===null||pair===void 0?void 0:pair.liquidityToken]);var userLiquidity=relevantTokenBalances===null||relevantTokenBalances===void 0?void 0:relevantTokenBalances[(_pair$liquidityToken$=pair===null||pair===void 0?void 0:(_pair$liquidityToken=pair.liquidityToken)===null||_pair$liquidityToken===void 0?void 0:_pair$liquidityToken.address)!==null&&_pair$liquidityToken$!==void 0?_pair$liquidityToken$:''];var _ref=[wrappedCurrency(currencyA,chainId),wrappedCurrency(currencyB,chainId)],tokenA=_ref[0],tokenB=_ref[1];var tokens=(_tokens={},_defineProperty(_tokens,Field.CURRENCY_A,tokenA),_defineProperty(_tokens,Field.CURRENCY_B,tokenB),_defineProperty(_tokens,Field.LIQUIDITY,pair===null||pair===void 0?void 0:pair.liquidityToken),_tokens);// liquidity values\nvar totalSupply=useTotalSupply(pair===null||pair===void 0?void 0:pair.liquidityToken);var liquidityValueA=pair&&totalSupply&&userLiquidity&&tokenA&&// this condition is a short-circuit in the case where useTokenBalance updates sooner than useTotalSupply\nJSBI.greaterThanOrEqual(totalSupply.raw,userLiquidity.raw)?new TokenAmount(tokenA,pair.getLiquidityValue(tokenA,totalSupply,userLiquidity,false).raw):undefined;var liquidityValueB=pair&&totalSupply&&userLiquidity&&tokenB&&// this condition is a short-circuit in the case where useTokenBalance updates sooner than useTotalSupply\nJSBI.greaterThanOrEqual(totalSupply.raw,userLiquidity.raw)?new TokenAmount(tokenB,pair.getLiquidityValue(tokenB,totalSupply,userLiquidity,false).raw):undefined;var liquidityValues=(_liquidityValues={},_defineProperty(_liquidityValues,Field.CURRENCY_A,liquidityValueA),_defineProperty(_liquidityValues,Field.CURRENCY_B,liquidityValueB),_liquidityValues);var percentToRemove=new Percent('0','100');// user specified a %\nif(independentField===Field.LIQUIDITY_PERCENT){percentToRemove=new Percent(typedValue,'100');}// user specified a specific amount of liquidity tokens\nelse if(independentField===Field.LIQUIDITY){if(pair===null||pair===void 0?void 0:pair.liquidityToken){var independentAmount=tryParseAmount(typedValue,pair.liquidityToken);if(independentAmount&&userLiquidity&&!independentAmount.greaterThan(userLiquidity)){percentToRemove=new Percent(independentAmount.raw,userLiquidity.raw);}}}// user specified a specific amount of token a or b\nelse if(tokens[independentField]){var _independentAmount=tryParseAmount(typedValue,tokens[independentField]);var liquidityValue=liquidityValues[independentField];if(_independentAmount&&liquidityValue&&!_independentAmount.greaterThan(liquidityValue)){percentToRemove=new Percent(_independentAmount.raw,liquidityValue.raw);}}var parsedAmounts=(_parsedAmounts={},_defineProperty(_parsedAmounts,Field.LIQUIDITY_PERCENT,percentToRemove),_defineProperty(_parsedAmounts,Field.LIQUIDITY,userLiquidity&&percentToRemove&&percentToRemove.greaterThan('0')?new TokenAmount(userLiquidity.token,percentToRemove.multiply(userLiquidity.raw).quotient):undefined),_defineProperty(_parsedAmounts,Field.CURRENCY_A,tokenA&&percentToRemove&&percentToRemove.greaterThan('0')&&liquidityValueA?new TokenAmount(tokenA,percentToRemove.multiply(liquidityValueA.raw).quotient):undefined),_defineProperty(_parsedAmounts,Field.CURRENCY_B,tokenB&&percentToRemove&&percentToRemove.greaterThan('0')&&liquidityValueB?new TokenAmount(tokenB,percentToRemove.multiply(liquidityValueB.raw).quotient):undefined),_parsedAmounts);var error;if(!account){error=t('Connect Wallet');}if(!parsedAmounts[Field.LIQUIDITY]||!parsedAmounts[Field.CURRENCY_A]||!parsedAmounts[Field.CURRENCY_B]){var _error;error=(_error=error)!==null&&_error!==void 0?_error:t('Enter an amount');}return{pair:pair,parsedAmounts:parsedAmounts,error:error};}export function useBurnActionHandlers(){var dispatch=useDispatch();var onUserInput=useCallback(function(field,typedValue){dispatch(typeInput({field:field,typedValue:typedValue}));},[dispatch]);return{onUserInput:onUserInput};}","map":{"version":3,"sources":["/Volumes/evo970/lou/madDex-master/src/state/burn/hooks.ts"],"names":["JSBI","Percent","TokenAmount","useCallback","useDispatch","useSelector","useActiveWeb3React","wrappedCurrency","usePair","useTotalSupply","useTranslation","tryParseAmount","useTokenBalances","Field","typeInput","useBurnState","state","burn","useDerivedBurnInfo","currencyA","currencyB","account","chainId","independentField","typedValue","t","pair","relevantTokenBalances","undefined","liquidityToken","userLiquidity","address","tokenA","tokenB","tokens","CURRENCY_A","CURRENCY_B","LIQUIDITY","totalSupply","liquidityValueA","greaterThanOrEqual","raw","getLiquidityValue","liquidityValueB","liquidityValues","percentToRemove","LIQUIDITY_PERCENT","independentAmount","greaterThan","liquidityValue","parsedAmounts","token","multiply","quotient","error","useBurnActionHandlers","dispatch","onUserInput","field"],"mappings":"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","sourcesContent":["import { Currency, CurrencyAmount, JSBI, Pair, Percent, TokenAmount } from '@pancakeswap/sdk'\nimport { useCallback } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport useActiveWeb3React from 'hooks/useActiveWeb3React'\nimport { wrappedCurrency } from 'utils/wrappedCurrency'\nimport { usePair } from 'hooks/usePairs'\nimport useTotalSupply from 'hooks/useTotalSupply'\n\nimport { useTranslation } from 'contexts/Localization'\nimport { AppDispatch, AppState } from '../index'\nimport { tryParseAmount } from '../swap/hooks'\nimport { useTokenBalances } from '../wallet/hooks'\nimport { Field, typeInput } from './actions'\n\nexport function useBurnState(): AppState['burn'] {\n  return useSelector<AppState, AppState['burn']>((state) => state.burn)\n}\n\nexport function useDerivedBurnInfo(\n  currencyA: Currency | undefined,\n  currencyB: Currency | undefined,\n): {\n  pair?: Pair | null\n  parsedAmounts: {\n    [Field.LIQUIDITY_PERCENT]: Percent\n    [Field.LIQUIDITY]?: TokenAmount\n    [Field.CURRENCY_A]?: CurrencyAmount\n    [Field.CURRENCY_B]?: CurrencyAmount\n  }\n  error?: string\n} {\n  const { account, chainId } = useActiveWeb3React()\n\n  const { independentField, typedValue } = useBurnState()\n\n  const { t } = useTranslation()\n\n  // pair + totalsupply\n  const [, pair] = usePair(currencyA, currencyB)\n\n  // balances\n  const relevantTokenBalances = useTokenBalances(account ?? undefined, [pair?.liquidityToken])\n  const userLiquidity: undefined | TokenAmount = relevantTokenBalances?.[pair?.liquidityToken?.address ?? '']\n\n  const [tokenA, tokenB] = [wrappedCurrency(currencyA, chainId), wrappedCurrency(currencyB, chainId)]\n  const tokens = {\n    [Field.CURRENCY_A]: tokenA,\n    [Field.CURRENCY_B]: tokenB,\n    [Field.LIQUIDITY]: pair?.liquidityToken,\n  }\n\n  // liquidity values\n  const totalSupply = useTotalSupply(pair?.liquidityToken)\n  const liquidityValueA =\n    pair &&\n    totalSupply &&\n    userLiquidity &&\n    tokenA &&\n    // this condition is a short-circuit in the case where useTokenBalance updates sooner than useTotalSupply\n    JSBI.greaterThanOrEqual(totalSupply.raw, userLiquidity.raw)\n      ? new TokenAmount(tokenA, pair.getLiquidityValue(tokenA, totalSupply, userLiquidity, false).raw)\n      : undefined\n  const liquidityValueB =\n    pair &&\n    totalSupply &&\n    userLiquidity &&\n    tokenB &&\n    // this condition is a short-circuit in the case where useTokenBalance updates sooner than useTotalSupply\n    JSBI.greaterThanOrEqual(totalSupply.raw, userLiquidity.raw)\n      ? new TokenAmount(tokenB, pair.getLiquidityValue(tokenB, totalSupply, userLiquidity, false).raw)\n      : undefined\n  const liquidityValues: { [Field.CURRENCY_A]?: TokenAmount; [Field.CURRENCY_B]?: TokenAmount } = {\n    [Field.CURRENCY_A]: liquidityValueA,\n    [Field.CURRENCY_B]: liquidityValueB,\n  }\n\n  let percentToRemove: Percent = new Percent('0', '100')\n  // user specified a %\n  if (independentField === Field.LIQUIDITY_PERCENT) {\n    percentToRemove = new Percent(typedValue, '100')\n  }\n  // user specified a specific amount of liquidity tokens\n  else if (independentField === Field.LIQUIDITY) {\n    if (pair?.liquidityToken) {\n      const independentAmount = tryParseAmount(typedValue, pair.liquidityToken)\n      if (independentAmount && userLiquidity && !independentAmount.greaterThan(userLiquidity)) {\n        percentToRemove = new Percent(independentAmount.raw, userLiquidity.raw)\n      }\n    }\n  }\n  // user specified a specific amount of token a or b\n  else if (tokens[independentField]) {\n    const independentAmount = tryParseAmount(typedValue, tokens[independentField])\n    const liquidityValue = liquidityValues[independentField]\n    if (independentAmount && liquidityValue && !independentAmount.greaterThan(liquidityValue)) {\n      percentToRemove = new Percent(independentAmount.raw, liquidityValue.raw)\n    }\n  }\n\n  const parsedAmounts: {\n    [Field.LIQUIDITY_PERCENT]: Percent\n    [Field.LIQUIDITY]?: TokenAmount\n    [Field.CURRENCY_A]?: TokenAmount\n    [Field.CURRENCY_B]?: TokenAmount\n  } = {\n    [Field.LIQUIDITY_PERCENT]: percentToRemove,\n    [Field.LIQUIDITY]:\n      userLiquidity && percentToRemove && percentToRemove.greaterThan('0')\n        ? new TokenAmount(userLiquidity.token, percentToRemove.multiply(userLiquidity.raw).quotient)\n        : undefined,\n    [Field.CURRENCY_A]:\n      tokenA && percentToRemove && percentToRemove.greaterThan('0') && liquidityValueA\n        ? new TokenAmount(tokenA, percentToRemove.multiply(liquidityValueA.raw).quotient)\n        : undefined,\n    [Field.CURRENCY_B]:\n      tokenB && percentToRemove && percentToRemove.greaterThan('0') && liquidityValueB\n        ? new TokenAmount(tokenB, percentToRemove.multiply(liquidityValueB.raw).quotient)\n        : undefined,\n  }\n\n  let error: string | undefined\n  if (!account) {\n    error = t('Connect Wallet')\n  }\n\n  if (!parsedAmounts[Field.LIQUIDITY] || !parsedAmounts[Field.CURRENCY_A] || !parsedAmounts[Field.CURRENCY_B]) {\n    error = error ?? t('Enter an amount')\n  }\n\n  return { pair, parsedAmounts, error }\n}\n\nexport function useBurnActionHandlers(): {\n  onUserInput: (field: Field, typedValue: string) => void\n} {\n  const dispatch = useDispatch<AppDispatch>()\n\n  const onUserInput = useCallback(\n    (field: Field, typedValue: string) => {\n      dispatch(typeInput({ field, typedValue }))\n    },\n    [dispatch],\n  )\n\n  return {\n    onUserInput,\n  }\n}\n"]},"metadata":{},"sourceType":"module"}