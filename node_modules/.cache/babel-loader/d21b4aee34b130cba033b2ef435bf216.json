{"ast":null,"code":"import _regeneratorRuntime from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Volumes/evo970/lou/madDex-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2;import React,{useEffect,useState}from'react';import styled from'styled-components';import{useWeb3React}from'@web3-react/core';import{Button,Flex,Text}from'@pancakeswap/uikit';import{formatBigNumber}from'utils/formatBalance';import{getPancakeProfileAddress}from'utils/addressHelpers';import{useCake}from'hooks/useContract';import{FetchStatus,useGetCakeBalance}from'hooks/useTokenBalance';import{useTranslation}from'contexts/Localization';import useGetProfileCosts from'views/Nft/market/Profile/hooks/useGetProfileCosts';import{useProfile}from'state/profile/hooks';import ProfileAvatarWithTeam from'components/ProfileAvatarWithTeam';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var DangerOutline=styled(Button).attrs({variant:'secondary'})(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  border-color: \",\";\\n  color: \",\";\\n  margin-bottom: 24px;\\n\\n  &:hover:not(:disabled):not(.button--disabled):not(:active) {\\n    border-color: \",\";\\n    opacity: 0.8;\\n  }\\n\"])),function(_ref){var theme=_ref.theme;return theme.colors.failure;},function(_ref2){var theme=_ref2.theme;return theme.colors.failure;},function(_ref3){var theme=_ref3.theme;return theme.colors.failure;});var AvatarWrapper=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  height: 64px;\\n  width: 64px;\\n\\n  \",\" {\\n    height: 128px;\\n    width: 128px;\\n  }\\n\"])),function(_ref4){var theme=_ref4.theme;return theme.mediaQueries.sm;});var StartPage=function StartPage(_ref5){var goToApprove=_ref5.goToApprove,goToChange=_ref5.goToChange,goToRemove=_ref5.goToRemove,onDismiss=_ref5.onDismiss;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),needsApproval=_useState2[0],setNeedsApproval=_useState2[1];var _useProfile=useProfile(),profile=_useProfile.profile;var _useGetProfileCosts=useGetProfileCosts(),numberCakeToUpdate=_useGetProfileCosts.numberCakeToUpdate,numberCakeToReactivate=_useGetProfileCosts.numberCakeToReactivate;var minimumCakeRequired=profile.isActive?numberCakeToUpdate:numberCakeToReactivate;var _useGetCakeBalance=useGetCakeBalance(),cakeBalance=_useGetCakeBalance.balance,fetchStatus=_useGetCakeBalance.fetchStatus;var hasMinimumCakeRequired=fetchStatus===FetchStatus.SUCCESS&&cakeBalance.gte(minimumCakeRequired);var _useTranslation=useTranslation(),t=_useTranslation.t;var _useWeb3React=useWeb3React(),account=_useWeb3React.account;var cakeContract=useCake();var cost=profile.isActive?numberCakeToUpdate:numberCakeToReactivate;/**\n   * Check if the wallet has the required CAKE allowance to change their profile pic or reactivate\n   * If they don't, we send them to the approval screen first\n   */useEffect(function(){var checkApprovalStatus=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return cakeContract.allowance(account,getPancakeProfileAddress());case 2:response=_context.sent;setNeedsApproval(response.lt(cost));case 4:case\"end\":return _context.stop();}}},_callee);}));return function checkApprovalStatus(){return _ref6.apply(this,arguments);};}();if(account){checkApprovalStatus();}},[account,cost,setNeedsApproval,cakeContract]);if(!profile){return null;}return/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",justifyContent:\"center\",flexDirection:\"column\",children:[/*#__PURE__*/_jsx(AvatarWrapper,{children:/*#__PURE__*/_jsx(ProfileAvatarWithTeam,{profile:profile})}),/*#__PURE__*/_jsx(Flex,{alignItems:\"center\",style:{height:'48px'},justifyContent:\"center\",children:/*#__PURE__*/_jsx(Text,{as:\"p\",color:\"failure\",children:!hasMinimumCakeRequired&&t('%minimum% CAKE required to change profile pic',{minimum:formatBigNumber(minimumCakeRequired)})})}),profile.isActive?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Button,{width:\"100%\",mb:\"8px\",onClick:needsApproval===true?goToApprove:goToChange,disabled:!hasMinimumCakeRequired||needsApproval===null,children:t('Change Profile Pic')}),/*#__PURE__*/_jsx(DangerOutline,{width:\"100%\",onClick:goToRemove,children:t('Remove Profile Pic')})]}):/*#__PURE__*/_jsx(Button,{width:\"100%\",mb:\"8px\",onClick:needsApproval===true?goToApprove:goToChange,disabled:!hasMinimumCakeRequired||needsApproval===null,children:t('Reactivate Profile')}),/*#__PURE__*/_jsx(Button,{variant:\"text\",width:\"100%\",onClick:onDismiss,children:t('Close Window')})]});};export default StartPage;","map":{"version":3,"sources":["/Volumes/evo970/lou/madDex-master/src/views/Nft/market/Profile/components/EditProfileModal/StartView.tsx"],"names":["React","useEffect","useState","styled","useWeb3React","Button","Flex","Text","formatBigNumber","getPancakeProfileAddress","useCake","FetchStatus","useGetCakeBalance","useTranslation","useGetProfileCosts","useProfile","ProfileAvatarWithTeam","DangerOutline","attrs","variant","theme","colors","failure","AvatarWrapper","div","mediaQueries","sm","StartPage","goToApprove","goToChange","goToRemove","onDismiss","needsApproval","setNeedsApproval","profile","numberCakeToUpdate","numberCakeToReactivate","minimumCakeRequired","isActive","cakeBalance","balance","fetchStatus","hasMinimumCakeRequired","SUCCESS","gte","t","account","cakeContract","cost","checkApprovalStatus","allowance","response","lt","height","minimum"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport styled from 'styled-components'\nimport { useWeb3React } from '@web3-react/core'\nimport { Button, Flex, Text, InjectedModalProps } from '@pancakeswap/uikit'\nimport { formatBigNumber } from 'utils/formatBalance'\nimport { getPancakeProfileAddress } from 'utils/addressHelpers'\nimport { useCake } from 'hooks/useContract'\nimport { FetchStatus, useGetCakeBalance } from 'hooks/useTokenBalance'\nimport { useTranslation } from 'contexts/Localization'\nimport useGetProfileCosts from 'views/Nft/market/Profile/hooks/useGetProfileCosts'\nimport { useProfile } from 'state/profile/hooks'\nimport ProfileAvatarWithTeam from 'components/ProfileAvatarWithTeam'\nimport { UseEditProfileResponse } from './reducer'\n\ninterface StartPageProps extends InjectedModalProps {\n  goToChange: UseEditProfileResponse['goToChange']\n  goToRemove: UseEditProfileResponse['goToRemove']\n  goToApprove: UseEditProfileResponse['goToApprove']\n}\n\nconst DangerOutline = styled(Button).attrs({ variant: 'secondary' })`\n  border-color: ${({ theme }) => theme.colors.failure};\n  color: ${({ theme }) => theme.colors.failure};\n  margin-bottom: 24px;\n\n  &:hover:not(:disabled):not(.button--disabled):not(:active) {\n    border-color: ${({ theme }) => theme.colors.failure};\n    opacity: 0.8;\n  }\n`\n\nconst AvatarWrapper = styled.div`\n  height: 64px;\n  width: 64px;\n\n  ${({ theme }) => theme.mediaQueries.sm} {\n    height: 128px;\n    width: 128px;\n  }\n`\n\nconst StartPage: React.FC<StartPageProps> = ({ goToApprove, goToChange, goToRemove, onDismiss }) => {\n  const [needsApproval, setNeedsApproval] = useState(null)\n  const { profile } = useProfile()\n  const { numberCakeToUpdate, numberCakeToReactivate } = useGetProfileCosts()\n  const minimumCakeRequired = profile.isActive ? numberCakeToUpdate : numberCakeToReactivate\n  const { balance: cakeBalance, fetchStatus } = useGetCakeBalance()\n  const hasMinimumCakeRequired = fetchStatus === FetchStatus.SUCCESS && cakeBalance.gte(minimumCakeRequired)\n  const { t } = useTranslation()\n  const { account } = useWeb3React()\n  const cakeContract = useCake()\n  const cost = profile.isActive ? numberCakeToUpdate : numberCakeToReactivate\n\n  /**\n   * Check if the wallet has the required CAKE allowance to change their profile pic or reactivate\n   * If they don't, we send them to the approval screen first\n   */\n  useEffect(() => {\n    const checkApprovalStatus = async () => {\n      const response = await cakeContract.allowance(account, getPancakeProfileAddress())\n      setNeedsApproval(response.lt(cost))\n    }\n\n    if (account) {\n      checkApprovalStatus()\n    }\n  }, [account, cost, setNeedsApproval, cakeContract])\n\n  if (!profile) {\n    return null\n  }\n\n  return (\n    <Flex alignItems=\"center\" justifyContent=\"center\" flexDirection=\"column\">\n      <AvatarWrapper>\n        <ProfileAvatarWithTeam profile={profile} />\n      </AvatarWrapper>\n      <Flex alignItems=\"center\" style={{ height: '48px' }} justifyContent=\"center\">\n        <Text as=\"p\" color=\"failure\">\n          {!hasMinimumCakeRequired &&\n            t('%minimum% CAKE required to change profile pic', { minimum: formatBigNumber(minimumCakeRequired) })}\n        </Text>\n      </Flex>\n      {profile.isActive ? (\n        <>\n          <Button\n            width=\"100%\"\n            mb=\"8px\"\n            onClick={needsApproval === true ? goToApprove : goToChange}\n            disabled={!hasMinimumCakeRequired || needsApproval === null}\n          >\n            {t('Change Profile Pic')}\n          </Button>\n          <DangerOutline width=\"100%\" onClick={goToRemove}>\n            {t('Remove Profile Pic')}\n          </DangerOutline>\n        </>\n      ) : (\n        <Button\n          width=\"100%\"\n          mb=\"8px\"\n          onClick={needsApproval === true ? goToApprove : goToChange}\n          disabled={!hasMinimumCakeRequired || needsApproval === null}\n        >\n          {t('Reactivate Profile')}\n        </Button>\n      )}\n      <Button variant=\"text\" width=\"100%\" onClick={onDismiss}>\n        {t('Close Window')}\n      </Button>\n    </Flex>\n  )\n}\n\nexport default StartPage\n"]},"metadata":{},"sourceType":"module"}